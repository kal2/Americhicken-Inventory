************  
* Program.: PRT_2FRT.PRG
* Author..: Grace Keller
* Date....: 01/21/97
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: PRINT FREIGHT COPY OF ORDER
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT1
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

SELECT B
? SPACE(3)
*** SET DOUBLE WIDE, DOUBLE HIGH
?? CHR(14)        
?? CHR(27) + 'w' + '1'
?? REPLICATE('**FREIGHT COPY',3)                       
?? '**'
?
?
?
?
?? SPACE(60) 
?? 'ORDER #: '
?? MSALESMAN + '-' 
?? MPO_NBR     
IF MPO_SUFFIX <> ' '
   ?? '-' + MPO_SUFFIX
ENDIF
**** TURN OFF DOUBLE HIGH 
?? CHR(27) + 'w' + '0'
?
? SPACE(3) + 'PRINT DATE ' + DTOC(DATE()) + SPACE(15)
?
MSAL_NAME = TRIM(MSAL_NAME)
? SPACE(3) + 'SALESPERSON: ' + MSAL_NAME

?
?

? SPACE(3) + 'ORDER DATE: ' + DTOC(ORD_DATE) + SPACE(3)
?? 'SHIP DATE: ' + DTOC(SHIP_DATE) + SPACE(3)
?? 'DELIV DATE: ' + DTOC(DEL_REQD) 
?? SPACE(5) + 'CUST PO#: ' + BUYER_PO              
?
?
?
IF MFRT_NAME <> SPACE(32) .AND. MFRT_NAME <> 'NONE'
   ************************************
   **** NOW DO FREIGHT INFORMATION ****
   ************************************
   *** SET DOUBLE WIDE, DOUBLE HIGH
   ?? CHR(14)        
   ?? CHR(27) + 'w' + '1'
   ? SPACE(3) + 'FREIGHT CARRIER:   '  + MFRT_NAME
   ?
   ? SPACE(3) + 'FREIGHT AMOUNT:    ' + SPACE(5) + TRANSFORM(MFRT_AMT, '9999999.99')
   **** TURN OFF DOUBLE HIGH 
   ?? CHR(27) + 'w' + '0'
ENDIF

?
?
?
? SPACE(3) 
*** TURN ON UNDERLINE
*?? CHR(27) + '-' + '1'
?? 'SHIPPED FROM SUPPLIER:'+ SPACE(10)   + space(10)         
IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MSALESMAN = '11'
   ?? 'PICKUP LOCATION'
ENDIF
*** TURN OFF UNDERLINE
*?? CHR(27) + '-' + '0'

? SPACE(3) + MSUP_NAME 
IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MSALESMAN = '11'
   ?? B->PU_LOC
ENDIF
? SPACE(3) + MSUP_STRT
? SPACE(3) + MSUP_CITYST
?

?
? SPACE(3)
*?? CHR(27) + '-' + '1'
?? 'SHIPPED TO CUSTOMER:' + SPACE(12)          
*?? CHR(27) + '-' + '0'

? SPACE(3) + MCUS_NAME 
? SPACE(3) + MCUS_STRT 
? SPACE(3) + MCUS_CITYST
?
?

?      
SELECT F
USE NOTES INDEX NOTES
STORE SPACE(78) TO MNOTE1, MNOTE2, MNOTE3, MNOTE4, MNOTE5, MNOTE6
SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX 

DO WHILE .NOT. EOF() .AND. SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX
   STORE SEQ TO MSEQ
   STORE NOTE TO MNOTE&MSEQ
   SKIP
ENDDO

I = 1
DO WHILE I<= 6
  MI = STR(I,1)
  IF MNOTE&MI <> SPACE(78)
     ? SPACE(3) + MNOTE&MI
  ENDIF
  I = I + 1
ENDDO

USE
SELECT B

? SPACE(3)
*** SET DOUBLE WIDE, DOUBLE HIGH
?? CHR(14)        
?? CHR(27) + 'w' + '1'
?? REPLICATE('**FREIGHT COPY',3)                       
?? '**'
**** TURN OFF DOUBLE HIGH 
?? CHR(27) + 'w' + '0'
?

EJECT
**** ALL DONE PRINTING NOW
**** PRINT SOME TOTALS HERE FOR CHECKING

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER <> 'DONOTPRINT'
   RUN &MPRINTIT
ENDIF

SELECT E
USE
SELECT F
USE
RETURN
*Formatted by: ToolBox Ver. 1.2  on 7/28/97 at 5:53 AM.
