*************
* Program.: SUP_EDIT.PRG
* Author..: Grace Keller
* Date....: 10/12/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: SUPPLIER EDIT/DELETE
*
* ---OPEN FILES
MMORE_PP = .T.  
MTITLE = ' - VIEW/CHANGE/DELETE SHIPPED FROM SUPPLIER INFORMATION' 
**** PUT UP THE SCREEN
DO TEXTSUPP
DO STORSUPP
STORE RECNO() TO MRECNO
DO FOX_USE WITH "&MDBFLOC.REM_SUP INDEX &MDBFLOC.RSUPCODE, &MDBFLOC.RSUPNAME", .F.
SEEK MRSUPCODE
IF .NOT. EOF()
   STORE NAME TO MREM_NAME
   STORE NAME TO MSV_NAME
   STORE STREET TO MREM_STRT
   STORE CITY TO MREM_CITY
   STORE STATE TO MREM_STATE
   IF ZIP4 = SPACE(4)
      STORE ZIP  TO MREM_ZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MREM_ZIP
   ENDIF
ELSE
   STORE SPACE(32) TO MREM_NAME
   STORE MREM_NAME TO MSV_NAME
   STORE SPACE(28) TO MREM_STRT
   STORE SPACE(20) TO MREM_CITY
   STORE SPACE(2) TO MREM_STATE
   STORE SPACE(5) TO MREM_ZIP
ENDIF
DO FOX_USE WITH "&MDBFLOC.SUPPLIER INDEX &MDBFLOC.SUP_NAME, &MDBFLOC.SUP_CODE", .F.
GOTO MRECNO
MNOT_DONE = .T.
DO WHILE MNOT_DONE
   DO GETSUPP
   @ 20,26 SAY MREM_STRT
   @ 21,26 SAY TRIM(MREM_CITY) + ', ' + MREM_STATE + '  ' + MREM_ZIP
   STORE 1 TO MACTION
   @ 24,0 CLEAR
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1.Save Updates    2.Edit Screen    3.Delete Supplier   4.Cancel'
   READ
   @24,09 GET MACTION PICTURE '9' RANGE 1,4
   READ               
   DO CASE
   CASE MACTION = 4
      MNOT_DONE = .F.
      LOOP
      
   CASE MACTION = 2
      LOOP
      
   CASE MACTION = 1
      
      STORE MNAME TO MSUP_NAME
      STORE MSTREET TO MSUP_STRT
      STORE MCITY TO MSUP_CITY
      STORE MSTATE TO MSUP_STATE
      STORE MZIP TO MSUP_ZIP
      STORE MZIP4 TO MSUP_ZIP4
      STORE MNOTE TO MSUP_NOTE
      STORE MAREA_CODE TO MSUP_AREA
      STORE MPHONE TO MSUP_PHONE
      
      IF MREM_NAME <> MSV_NAME
         
         IF MREM_NAME <> 'SAME'
            STORE MREM_NAME TO MNAME
         ENDIF
         SELECT A
         DO FOX_USE WITH "&MDBFLOC.REM_SUP INDEX &MDBFLOC.RSUPNAME, &MDBFLOC.RSUPCODE" ,.F.
         MNAME_FD = .F.
         
         DO RSUPSEL2
         
         STORE MSUP_NAME TO MNAME
         STORE MSUP_STRT TO MSTREET
         STORE MSUP_CITY TO MCITY
         STORE MSUP_STATE TO MSTATE
         STORE MSUP_ZIP TO MZIP
         STORE MSUP_ZIP4 TO MZIP4
         STORE MSUP_NOTE TO MNOTE
         STORE MSUP_AREA TO MAREA_CODE
         STORE MSUP_PHONE TO MPHONE 
         
         
         IF .NOT. MNAME_FD
            @ 24,0 CLEAR
            STORE ' ' TO MWAIT
            @ 24,1 SAY 'REMIT TO MUST BE ON FILE - PLEASE HIT ANY KEY TO REENTER'
            @ 24,78  GET MWAIT
            READ
            @ 24,0 CLEAR
            DO FOX_USE WITH "&MDBFLOC.SUPPLIER INDEX &MDBFLOC.SUP_NAME, &MDBFLOC.SUP_CODE" ,.F.
            GOTO MRECNO
            LOOP
         ENDIF
         
         STORE RSUPCODE TO MRSUPCODE
         @ 19,26 SAY NAME
         @ 20,26 SAY STREET
         IF ZIP4 = SPACE(4)
            STORE ZIP + SPACE(5) TO MZIP
         ELSE
            STORE ZIP + '-' + ZIP4 TO MZIP
         ENDIF
         @ 21,26 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
         SELECT A
         DO FOX_USE WITH "&MDBFLOC.SUPPLIER INDEX &MDBFLOC.SUP_NAME, &MDBFLOC.SUP_CODE", .F.
         GOTO MRECNO
         STORE 1 TO MACTION
         @ 24,0 CLEAR
         @ 24,01 SAY 'Action: ' + STR(MACTION,1)
         @ 24,13 SAY '1. Save      2. Edit       3. Cancel'
         @24,09 GET MACTION PICTURE '9' RANGE 1,3
         READ               
         IF MACTION = 2
            LOOP
         ENDIF
         
         IF MACTION = 3
            MNOT_DONE = .F.
            LOOP
         ENDIF
      ENDIF

      DO REPLSUPP

      MNOT_DONE = .F.
      
   CASE MACTION = 3
      @ 24,0 CLEAR
      STORE 'N' TO MYES_NO
      STORE 'Are You Sure You Want to DELETE this Supplier (Y/N)? ' TO MWAIT
      @ 24,10 SAY MWAIT
      CLEAR GETS    
      @ 24,65 GET MYES_NO PICTURE '@!'
      READ
      IF MYES_NO = 'Y'
         DELETE
      ENDIF 
      MNOT_DONE = .F.
   ENDCASE
   
ENDDO
RETURN
* EOF: SUP_EDIT.PRG
*Formatted by: dANALYST Ver. 7.3a on November 24, 1987 at 3:01 PM.
