*************
* Program.: BUY_EDIT.PRG
* Author..: Grace Keller
* Date....: 10/12/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: CUSTOMER EDIT/DELETE
*
* ---OPEN FILES
MTITLE = ' - VIEW/CHANGE/DELETE SHIP TO CUSTOMER INFORMATION' 
**** PUT UP THE SCREEN
STORE SPACE(10) TO MCONT_FAX
DO TEXTBUY
DO STORBUY 
STORE RECNO() TO MRECNO
DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYCODE, &MDBFLOC.BBUYNAME", .F.
SEEK MBBUYCODE
IF .NOT. EOF()
   STORE NAME TO MBIL_NAME
   STORE NAME TO MSV_NAME
   STORE STREET TO MBIL_STRT
   STORE CITY TO MBIL_CITY
   STORE STATE TO MBIL_STATE
   IF ZIP4 = SPACE(4)
      STORE ZIP  TO MBIL_ZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MBIL_ZIP
   ENDIF
ELSE
   STORE SPACE(32) TO MBIL_NAME
   STORE MBIL_NAME TO MSV_NAME
   STORE SPACE(28) TO MBIL_STRT
   STORE SPACE(20) TO MBIL_CITY
   STORE SPACE(2) TO MBIL_STATE
   STORE SPACE(5) TO MBIL_ZIP
ENDIF
DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME, &MDBFLOC.BUY_CODE", .F.
GOTO MRECNO
MNOT_DONE = .T.
DO WHILE MNOT_DONE
   DO GETBUY 
   @ 20,26 SAY MBIL_STRT
   @ 21,26 SAY TRIM(MBIL_CITY) + ', ' + MBIL_STATE + '  ' + MBIL_ZIP
   STORE 1 TO MACTION
   @ 24,0 CLEAR
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1.Save Updates    2.Edit Screen    3.Delete Customer   4.Cancel'
   READ
   @24,09 GET MACTION PICTURE '9' RANGE 1,4
   READ               
   DO CASE
   CASE MACTION = 4
      MNOT_DONE = .F.
      LOOP
      
   CASE MACTION = 2
      LOOP
      
   CASE MACTION = 1
      
      STORE MNAME TO MBUY_NAME
      STORE MSTREET TO MBUY_STRT
      STORE MCITY TO MBUY_CITY
      STORE MSTATE TO MBUY_STATE
      STORE MZIP TO MBUY_ZIP
      STORE MZIP4 TO MBUY_ZIP4
      STORE MNOTE TO MBUY_NOTE
      STORE MAREA_CODE TO MBUY_AREA
      STORE MPHONE TO MBUY_PHONE
      
      IF MBIL_NAME <> MSV_NAME
         
         IF MBIL_NAME <> 'SAME'
            STORE MBIL_NAME TO MNAME
         ENDIF
         SELECT A
         DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYNAME, &MDBFLOC.BBUYCODE" ,.F.
         MNAME_FD = .F.
         
         DO BBUYSEL2
         
         STORE MBUY_NAME TO MNAME
         STORE MBUY_STRT TO MSTREET
         STORE MBUY_CITY TO MCITY
         STORE MBUY_STATE TO MSTATE
         STORE MBUY_ZIP TO MZIP
         STORE MBUY_ZIP4 TO MZIP4
         STORE MBUY_NOTE TO MNOTE
         STORE MBUY_AREA TO MAREA_CODE
         STORE MBUY_PHONE TO MPHONE 
         
         
         IF .NOT. MNAME_FD
            @ 24,0 CLEAR
            STORE ' ' TO MWAIT
            @ 24,1 SAY 'BILL TO MUST BE ON FILE - PLEASE HIT ANY KEY TO REENTER'
            @ 24,78  GET MWAIT
            READ
            @ 24,0 CLEAR
            DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME, &MDBFLOC.BUY_CODE" ,.F.
            GOTO MRECNO
            LOOP
         ENDIF
         
         STORE BBUYCODE TO MBBUYCODE
         @ 19,26 SAY NAME
         @ 20,26 SAY STREET
         IF ZIP4 = SPACE(4)
            STORE ZIP + SPACE(5) TO MZIP
         ELSE
            STORE ZIP + '-' + ZIP4 TO MZIP
         ENDIF
         @ 21,26 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
         SELECT A
         DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME, &MDBFLOC.BUY_CODE", .F.
         GOTO MRECNO
         STORE 1 TO MACTION
         @ 24,0 CLEAR
         @ 24,01 SAY 'Action: ' + STR(MACTION,1)
         @ 24,13 SAY '1. Save      2. Edit       3. Cancel'
         @24,09 GET MACTION PICTURE '9' RANGE 1,3
         READ               
         IF MACTION = 2
            LOOP
         ENDIF
         
         IF MACTION = 3
            MNOT_DONE = .F.
            LOOP
         ENDIF
      ENDIF
      
      DO REPLBUY 
      
      MNOT_DONE = .F.
      
   CASE MACTION = 3
      @ 24,0 CLEAR
      STORE 'N' TO MYES_NO
      STORE 'Are You Sure You Want to DELETE this Customer (Y/N)? ' TO MWAIT
      @ 24,10 SAY MWAIT
      CLEAR GETS    
      @ 24,65 GET MYES_NO PICTURE '@!'
      READ
      IF MYES_NO = 'Y'
         DELETE
      ENDIF 
      MNOT_DONE = .F.
   ENDCASE
   
ENDDO
RETURN
* EOF: BUY_EDIT.PRG
*Formatted by: dANALYST Ver. 7.3a on November 24, 1987 at 3:30 PM.
