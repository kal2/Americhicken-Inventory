**********
* Program.: BBUYNOTE.PRG
* Author..: Grace Keller
* Date....: 03/20/94
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: UPDATE BILL TO CUSTOMER NOTES
*
CLEAR
@ 1,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@ 02,00 SAY MPROGRAM + ' - UPDATE BILL TO CUSTOMER NOTES'
@ 03,00 TO 24,79 
SELECT F
USE BBUYNOTE INDEX BBUYNOTE
STORE SPACE(78) TO MNOTE01, MNOTE02, MNOTE03, MNOTE04, MNOTE05        
STORE SPACE(78) TO MNOTE06, MNOTE07, MNOTE08, MNOTE09, MNOTE10        
STORE SPACE(78) TO MNOTE11, MNOTE12, MNOTE13, MNOTE14, MNOTE15        

SEEK MBBUYCODE
DO WHILE .NOT. EOF() .AND. BBUYCODE = MBBUYCODE
   STORE SEQ TO MSEQ
   STORE NOTE TO MNOTE&MSEQ
   SKIP
ENDDO
@ 4,1 SAY 'NOTES FOR CUSTOMER: ' + A->NAME
STORE 2 TO MACTION
DO WHILE MACTION = 2
   MSEQ = 1
   DO WHILE MSEQ <= 15
      MI = SUBSTR(STR(MSEQ+100,3),2)
      @ MSEQ+5,1 GET MNOTE&MI
      MSEQ = MSEQ + 1
   ENDDO
   STORE 1 TO MACTION
   @ 24,00 CLEAR
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1. Continue    2.  Edit    3. Cancel Updates'
   
   READ
   
   @24,09 GET MACTION PICTURE '9' RANGE 1,3
   READ               
   
ENDDO
IF MACTION = 3
   RETURN
ENDIF
MONE = .F.
MSEQ = 1
DO WHILE MSEQ <= 15
   MI = SUBSTR(STR(MSEQ+100,3),2)
   SEEK MBBUYCODE + MI
   IF EOF() 
      IF MNOTE&MI <> SPACE(78)
         DO FILELOCK
         APPEND BLANK
         REPLACE BBUYCODE WITH MBBUYCODE 
         REPLACE NOTE WITH MNOTE&MI
         REPLACE SEQ WITH MI
         UNLOCK
         MONE = .T.
      ENDIF
   ELSE
      IF MNOTE&MI = SPACE(78)
         DO FILELOCK
         DELETE
         UNLOCK
      ELSE  
         DO RECLOCK
         REPLACE NOTE WITH MNOTE&MI
         UNLOCK
         MONE = .T.
      ENDIF
   ENDIF
   MSEQ = MSEQ + 1
ENDDO
USE
RETURN
* EOF: UPDNOTES.PRG
*Formatted by: ToolBox Ver. 1.2  on 3/21/94 at 3:41 PM.
