**********
* Program.: NEXT_PG.PRG
* Author..: Grace Keller
* Date....: 10/14/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: PURCHASE ORDER ADD - MULTIPLE PAGES
*
* ---OPEN FILES
RELEASE MQTY
RELEASE MFR_FZ
RELEASE MGRADE
RELEASE MPAK  
RELEASE MCLASS
RELEASE MPROD
RELEASE MSIZE
RELEASE MPACKSPEC
RELEASE MLBS
RELEASE MPURC_PRI
RELEASE MSELL_PRI
RELEASE MPURC_TOT
RELEASE MSELL_TOT
RELEASE MSHRT_BOX
RELEASE MSHRT_LBS
RELEASE MBILL_PRI
RELEASE MPAK1  
RELEASE MPAK2  
RELEASE MBOX_SZ
RELEASE MOLD_LOT
RELEASE MOLD_LBS
RELEASE MOLD_QTY
RELEASE MOLD_PROD
RELEASE MIN_LOT
RELEASE MOUT_LOT
RELEASE MOLD_IN
RELEASE MOLD_OUT
RELEASE MSTOR_ITEM
RELEASE MPAK_YR
RELEASE MPAK_DAY
RELEASE Mout_YR
RELEASE Mout_DAY

DIMENSION MQTY(7)
DIMENSION MFR_FZ(7)
DIMENSION MGRADE(7)
DIMENSION MPAK(7)  
DIMENSION MCLASS(7)
DIMENSION MPROD(7)
DIMENSION MSIZE(7)
DIMENSION MPACKSPEC(7)
DIMENSION MLBS(7)
DIMENSION MPURC_PRI(7)
DIMENSION MSELL_PRI(7)
DIMENSION MPURC_TOT(7)
DIMENSION MSELL_TOT(7)
DIMENSION MSHRT_BOX(7)
DIMENSION MSHRT_LBS(7)
DIMENSION MBILL_PRI(7)
DIMENSION MPAK1(7)  
DIMENSION MPAK2(7)  
DIMENSION MBOX_SZ(7)
DIMENSION MOLD_LOT(7)
DIMENSION MOLD_LBS(7)
DIMENSION MOLD_QTY(7)
DIMENSION MOLD_PROD(7)
DIMENSION MIN_LOT(7)
DIMENSION MOUT_LOT(7)
DIMENSION MOLD_IN(7)
DIMENSION MOLD_OUT(7)
DIMENSION MSTOR_ITEM(7)
DIMENSION MPAK_YR(7)
DIMENSION MPAK_DAY(7)
DIMENSION Mout_YR(7)
DIMENSION Mout_DAY(7)

MMORE_ITM = .T.
MPAGE = 1
CLEAR
@  1, 0 SAY MCOMPANY
@  1,68 SAY DATE()
MTITLE = ' - ADD PO'
@  2, 0 SAY MPROGRAM + MTITLE
@  2,41 SAY 'P.O. #:'
@ 2,50 SAY MSALESMAN
@ 2,52 SAY '-'
@ 2,53 SAY MPO_NBR
IF MPO_SUFFIX <> ' '
   @ 2,57 SAY '-'
   @ 2,58 SAY MPO_SUFFIX
ENDIF
@ 2,65 SAY 'BROKER:'
@ 2,73 SAY MBROK_NAME
DO TEXT2ND
@ 3,65 SAY 'ITEMS: PAGE '

MMAX_ITM = 0
DO WHILE MMORE_ITM
   @ 3,77 SAY STR(MPAGE,2)
   MLINE = 08 
   MNEXT_ITM = .T.
   MNBR_ITM = 1
   DO WHILE MLINE <= 22 .AND. MNEXT_ITM
      IF MNBR_ITM > MMAX_ITM
         STORE 0 TO MQTY(MNBR_ITM), MLBS(MNBR_ITM), MPURC_PRI(MNBR_ITM), MSELL_PRI(MNBR_ITM)
         STORE 0 TO MSHRT_BOX(MNBR_ITM), MSHRT_LBS(MNBR_ITM)
         STORE SPACE(2) TO MFR_FZ(MNBR_ITM)
         STORE SPACE(1) TO MGRADE(MNBR_ITM), MCLASS(MNBR_ITM)
         STORE SPACE(2) TO MPAK(MNBR_ITM)
         STORE SPACE(06) TO MPROD(MNBR_ITM)
         STORE SPACE(5) TO MSIZE(MNBR_ITM)
         STORE SPACE(4) TO MPACKSPEC(MNBR_ITM)
      ENDIF
      
      DO GETITM
      IF MPROD(MNBR_ITM) <> SPACE(4) .AND. MSELL_PRI(MNBR_ITM) = 0
         @ 24,0 CLEAR
         MOK = SPACE(4)
         DO WHILE MOK <> 'OK  ' .AND. MOK <> 'EDIT'
            @ 24,1 SAY "SELL PRICE IS ZERO-ENTER 'OK' TO CONT- OR 'EDIT' TO CHANGE" GET MOK PICTURE '@!'
            READ
            IF MOK <> 'OK' .AND. MOK <> 'EDIT'
               STORE 'Invalid Input' to minv_err
               @ 24,66 GET MINV_ERR
               READ
            ENDIF
         ENDDO
         IF MOK = 'EDIT'
            @ 24,1 SAY SPACE(78)
            LOOP
         ENDIF
         @ 24,1 SAY SPACE(78)
      ENDIF
      IF .NOT. MNEXT_ITM
         LOOP
      ENDIF
      MLINE = MLINE + 1
      IF MNBR_ITM > MMAX_ITM
         STORE MNBR_ITM TO MMAX_ITM
      ENDIF
      IF MLINE <= 22
         MNBR_ITM = MNBR_ITM + 1
      ENDIF
   ENDDO
   STORE 1 TO MACTION
   @ 24,0 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1. Continue     2. Edit    3. Next Item Pg.   4. Cancel Page'
   @ 24,8 GET MACTION PICTURE '#' RANGE 1,4
   
   READ
   
   DO CASE      
   CASE MACTION = 1
      ****  WRITE BACK THIS PAGE OF DATA
      I = ((MPAGE - 1) * 15) + 1
      MMAX = ((MPAGE - 1) * 15) + MMAX_ITM
      MAPPEND = .T.
      DO REPLITM
      **** DO CREDIT LIMITS HERE
      **** FINISH UP
      IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MSALESMAN = '11'
         MVIEW = .F.
         RELEASE MQTY
         RELEASE MFR_FZ
         RELEASE MGRADE
         RELEASE MPAK  
         RELEASE MCLASS
         RELEASE MPROD
         RELEASE MSIZE
         RELEASE MPACKSPEC
         RELEASE MLBS
         RELEASE MPURC_PRI
         RELEASE MSELL_PRI
         RELEASE MPURC_TOT
         RELEASE MSELL_TOT
         RELEASE MSHRT_BOX
         RELEASE MSHRT_LBS
         RELEASE MBILL_PRI
         RELEASE MPAK1  
         RELEASE MPAK2  
         RELEASE MBOX_SZ
         RELEASE MOLD_LOT
         RELEASE MOLD_LBS
         RELEASE MOLD_QTY
         RELEASE MOLD_PROD
         RELEASE MIN_LOT
         RELEASE MOUT_LOT
         RELEASE MOLD_IN
         RELEASE MOLD_OUT
         RELEASE MSTOR_ITEM
         RELEASE MPAK_YR
         RELEASE MPAK_DAY
         RELEASE Mout_YR
         RELEASE Mout_DAY
         
         STORE SPACE(25) TO MCOM_NAME, MCOM_NAME2, MCOM_NAME3
         STORE SPACE(2)  TO  MCOM_CODE, MCOM_CODE2, MCOM_CODE3
         MPO_ADD = .F.
         DO COM_PG
      ENDIF
      DO MISC_ADD
      DO NEW_FRT
      MMORE_ITM = .F.
   CASE MACTION = 3
      ****  WRITE BACK THIS PAGE OF DATA
      I = ((MPAGE - 1) * 15) + 1
      MMAX = ((MPAGE - 1) * 15) + MMAX_ITM
      MAPPEND = .T.
      DO REPLITM
      @ 8,0 CLEAR TO 22,79 
      MPAGE = MPAGE + 1
      MNBR_ITM = 1            
      MMAX_ITM = 0
      LOOP      
   CASE MACTION = 2
      LOOP        
   CASE MACTION = 4
      **** DO CREDIT LIMITS HERE
      **** FINISH UP
      IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MSALESMAN = '11'
         MVIEW = .F.
         DO COM_PG
      ENDIF
      DO MISC_ADD
      DO NEW_FRT
      MMORE_ITM = .F.
   ENDCASE 
ENDDO 

RETURN
* EOF: NEXT_PG.PRG
*Formatted by: ToolBox Ver. 1.2  on 12/7/16 at 5:01 PM.
