**********
* Program.: MAN_DISB.PRG
* Author..: GRACE KELLER
* Date....: 03/11/88
* Notice..: Copyright 1988, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: MISCELLANEOUS MANUAL DISBURSEMENTS
*
* ---PROCESSING LOOP
CLEAR
@ 1,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@ 02,00 SAY MPROGRAM + ' - RECORD MISCELLANEOUS MANUAL DISBURSEMENTS'
@ 03,00 TO 22,79 

MCHOICE = 'CHK'
*STORE 2 TO MACTION
*DO WHILE MACTION = 2
*   @ 8,5 SAY 'Record Check (CHK) -or- ACH Advisement (ACH): '
*   @ 8,50 GET MCHOICE PICTURE '@!' VALID(MCHOICE = 'CHK' .OR. MCHOICE = 'ACH')
*   MACTION = 1
*   @ 24,1 say 'Action: ' + str(maction,1)
*   @ 24,13 say '1. Continue      2. Edit      3. Cancel'
*   READ
*   @ 24,9 get maction PICTURE '9' range 1,3
*   READ
*ENDDO
*IF MACTION = 3
*   RETURN
*ENDIF
*@ 8,5 SAY SPACE(70)

SELECT A
DO FOX_USE WITH "DISBJRN INDEX DISBJRN, DISB_PO, DISBINV, DISBSTR, DISBINQ", .F.
SELECT B
DO FOX_USE WITH "CK_REG INDEX CK_REG, CK_DATE", .F.

@ 4,6 SAY ' PAYEE: ' 
@ 5,6 SAY 'STREET: '
@ 6,6 SAY '  CITY: ' 
@ 6,45 SAY 'STATE: ' 
@ 6,58 SAY 'ZIP: '
@ 8,1 SAY ' CHECK DATE: '
IF MCHOICE = 'CHK'
   @ 9,1 SAY '  CHECK NBR: '
ELSE
   @ 9,1 SAY '    ACH NBR: '
ENDIF
@ 10,1 SAY ' INVOICE NO: '
@ 11,1 SAY 'DESCRIPTION: '
*IF MPROG_CODE = 2
@ 12,1 SAY 'SALESPERSON:'
*ENDIF
@ 13,1 SAY '1. AMOUNT:              ACCOUNT:'
@ 15,1 SAY '2. AMOUNT:              ACCOUNT:'
@ 17,1 SAY '3. AMOUNT:              ACCOUNT:'
@ 19,1 SAY '4. AMOUNT:              ACCOUNT:'
STORE 1 TO MACTION
@ 24,01 SAY 'Action: ' + STR(MACTION,1)
@ 24,13 SAY '1. Save/Add Another    2. Edit   3. Save/Finished    4. Cancel'

MMORE = .T.
DO WHILE MMORE
   STORE SPACE(32) TO MNAME
   STORE CTOD(' ') TO MCK_DATE
   STORE SPACE(25) TO MSTREET 
   STORE SPACE(20) TO MCITY
   STORE SPACE(2) TO MSTATE, MSALESMAN
   STORE SPACE(5) TO MZIP
   IF MCHOICE = 'ACH'
      SELECT C
      DO FOX_USE WITH "&MMASTDBF.CONTROL", .F.
      STORE STR(ACH_NBR,1,6) TO MACH_NBR
      USE
   ELSE
      STORE SPACE(6) TO MCK_NBR
   ENDIF
   
   STORE 0 TO MAMOUNT1, MAMOUNT2, MAMOUNT3, MAMOUNT4
   STORE SPACE(4) TO MACCOUNT1, MACCOUNT2, MACCOUNT3, MACCOUNT4
   STORE SPACE(20) TO MDESCRIP
   STORE SPACE(12) TO MSUP_INV
   STORE 2 TO MACTION
   DO WHILE MACTION = 2
      @ 19,1 CLEAR TO 19,78
      @ 4,14 GET MNAME PICTURE '@!'
      @ 5,14 GET MSTREET PICTURE '@!'
      @ 6,14 GET MCITY PICTURE '@!'
      @ 6,52 GET MSTATE PICTURE '@!'
      @ 6,63 GET MZIP PICTURE '#####'
      
      @ 8,14 GET MCK_DATE
      IF MCHOICE = 'CHK'
         @ 9,14 GET MCK_NBR PICTURE '@!'
      ELSE
         @ 9,14 SAY MACH_NBR PICTURE '@!'
      ENDIF
      @ 10,14 GET MSUP_INV PICTURE '@!'
      @ 11,14 GET MDESCRIP PICTURE '@!'
      @ 12,14 GET MSALESMAN PICTURE '##'

      @ 13,12 GET MAMOUNT1 PICTURE '###,###.##'
      @ 13,35 GET MACCOUNT1 PICTURE '####'
      
      @ 15,12 GET MAMOUNT2 PICTURE '###,###.##'
      @ 15,35 GET MACCOUNT2 PICTURE '####'
      
      @ 17,12 GET MAMOUNT3 PICTURE '###,###.##'
      @ 17,35 GET MACCOUNT3 PICTURE '####'
      
      @ 19,12 GET MAMOUNT4 PICTURE '###,###.##'
      @ 19,35 GET MACCOUNT4 PICTURE '####'
      READ
      IF MNAME = SPACE(32)
         MACTION = 4
         LOOP
      ENDIF
      
      STORE 1 TO MACTION
      @ 24,01 SAY 'Action: ' + STR(MACTION,1)
      @ 24,13 SAY '1. Save/Add Another    2. Edit   3. Save/Finished    4. Cancel'
      MTOT = MAMOUNT1 + MAMOUNT2 + MAMOUNT3 + MAMOUNT4

      @ 20,1 SAY 'TOTAL:'
      @ 20,12 SAY MTOT PICTURE '###,###.##'
      
      @ 24,9 GET MACTION PICTURE '#' RANGE 1,4
      READ
      IF MACTION = 1 .OR. MACTION = 3
         IF MSALESMAN = SPACE(2)
            @ 24,0 CLEAR
            STORE '  ' TO MOK
            @ 24,0 SAY 'WARNING !!!  NO SALESPERSON CODE ENTERED - ENTER "OK" IF THAT IS CORRECT ' GET MOK PICTURE '@!'
            READ
            @ 24,0 CLEAR
            IF MOK <> 'OK'
               MACTION = 2
               LOOP
            ENDIF
         ENDIF
         IF MCK_DATE = CTOD(' ')
            @ 24,0 CLEAR
            MOK = ' '
            @ 24,0 SAY 'ERROR: MUST ENTER A DATE - PRESS RETURN TO REENTER ' GET MOK PICTURE '@!'
            READ
            @ 24,0 CLEAR
            MACTION = 2
            LOOP
         ENDIF
      ENDIF
   ENDDO
   IF MACTION = 4
      MMORE = .F.
   ENDIF
   
   IF MNAME = SPACE(32)
      MMORE = .F.
      LOOP
   ENDIF
   *IF MTOT = 0
   *   LOOP
   *ENDIF
   
   STORE DTOC(MCK_DATE) TO MDATE
   STORE SUBSTR(MDATE,1,2) TO MMONTH
   STORE SUBSTR(MDATE,4,2) TO MDAY
   STORE SUBSTR(MDATE,7) TO MYEAR
   IF MCHOICE = 'CHK'
      STORE VAL(MCK_NBR) TO MNBR
   ELSE
      STORE VAL(MACH_NBR) TO MNBR
   ENDIF
   
   IF MNBR > 0 .AND. MNBR <= 999999
      IF MCHOICE = 'CHK'
         MCK_NBR = STR(MNBR,6)
      ELSE
         MACH_NBR = STR(MNBR,6)
      ENDIF
   ENDIF
   
   I = 1
   SELECT A
   DO WHILE I <= 4
      MI = STR(I,1)
      IF MAMOUNT&MI <> 0
         DO FILELOCK
         APPEND BLANK
         REPLACE JRNL_MO WITH MMONTH
         REPLACE JRNL_YR WITH MYEAR
         REPLACE JRNL_DAY WITH MDAY
         IF MCHOICE = 'CHK'
            REPLACE CK_NBR WITH MCK_NBR
         ELSE
            REPLACE CK_NBR WITH 'A' + LTRIM(MACH_NBR)
         ENDIF
         REPLACE SYS_DATE WITH MCK_DATE
         REPLACE AMOUNT1 WITH MAMOUNT&MI 
         REPLACE CATEGORY1 WITH MACCOUNT&MI
         REPLACE ACCT_NAME WITH MNAME
         REPLACE BILL_INV WITH MSUP_INV
         REPLACE ACCT_TYPE WITH 'O'
         REPLACE SALESMAN WITH MSALESMAN
         UNLOCK
      ENDIF
      I = I + 1
   ENDDO
   
   SELECT B
   DO FILELOCK
   APPEND BLANK
   REPLACE PAY_NAME WITH MNAME        
   IF MCHOICE = 'CHK'
      REPLACE CK_NBR WITH MCK_NBR
   ELSE
      REPLACE CK_NBR WITH 'A' + LTRIM(MACH_NBR)
   ENDIF
   REPLACE CK_DATE WITH MCK_DATE
   REPLACE SYS_DATE WITH MCK_DATE
   REPLACE AMOUNT WITH MTOT
   REPLACE PAY_TYPE WITH 'O' 
   REPLACE DESCRIP WITH MDESCRIP
   REPLACE CLEAR_FLG WITH 'Y'
   UNLOCK
   IF MCHOICE = 'ACH'
      SELECT C
      DO FOX_USE WITH "&MMASTDBF.CONTROL", .F.
      DO RECLOCK
      REPLACE ACH_NBR WITH VAL(MACH_NBR) + 1
      USE
   ENDIF
ENDDO

CLOSE DATA
RETURN
* EOF: MAN_OTH.PRG
*Formatted by: ToolBox Ver. 1.2  on 12/11/8 at 11:18 AM.
