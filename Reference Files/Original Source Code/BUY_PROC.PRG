*************************
*  FILE NAME: BUY_PROC.PRG
*  BY: 
*  DATE: October 12, 1987
*  DESC:
*  CALLED BY:
*  DATA FILES:
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     

PROCEDURE TEXTBUY 
CLEAR 
@  1, 0 SAY MCOMPANY
@  1,68 SAY DATE()
@  2, 0 SAY MPROGRAM + MTITLE
@ 3,0 to 24,80
@ 5,08  SAY 'CUSTOMER SHIP TO:'
@ 6,12 SAY 'PHONE NUMBER:'
@ 6,45 SAY 'FAX NUMBER:'
@ 8,10 SAY 'CONTACT NAME 1:'
@ 9,10 SAY '             2:'
@ 10,10 SAY ' CONTACT PHONE:'
@ 10,52 SAY 'CONTACT FAX:'
@ 11,10 SAY 'FRT CONT PHONE:'
@ 11,48 SAY 'DELV/APPT PHONE: '
@ 12,01 SAY 'DELV/APPT EMAIL: '
@ 12,50 SAY 'RECV HRS/TIME: '
*                      10        20        30       40         50        60        70
*             123456789012345678901234567890123456789012345678901234567890123456789012
@ 13,01 SAY 'Recvg  Mon:                  Tue:                  Wed:'
@ 14,01 SAY 'Hours  Thu:                  Fri:                  Sat:'
@ 15,01 SAY '       Sun:'
@ 16,1  SAY 'SHIP TO ADDR->'
@ 16,18 SAY 'STREET:'
@ 17,1  SAY '------------->'
@ 17,20 SAY 'CITY:'
@ 17,50 SAY 'STATE:'
@ 17,62 SAY 'ZIP:'
@ 17,72 SAY '-'

@ 18,3 SAY '   NOTE:'
@ 19,3 SAY 'MONTHLY REPORT GROUP CUSTOMER CODE: ' 
@ 19,46 SAY 'DESCRIP:'
@ 20,2 SAY 'PRINCIPAL BILL TO NAME:'
RETURN


PROCEDURE INITBUY
IF MINIT_NM
   mname       = SPACE(32)
ENDIF
MSTREET     = SPACE(28)
MCITY       = SPACE(20)
MSTATE      = SPACE(2)
MZIP        = SPACE(5)
MZIP4       = SPACE(4)
MNOTE       = SPACE(60)
MBUY_CODE   = SPACE(4)
MAREA_CODE  = SPACE(3)
MPHONE      = SPACE(7)
MFAX        = SPACE(10)
MCONT_FAX   = SPACE(10)
MCONT_NAME  = SPACE(42)
MCONT_NAM2  = SPACE(42)
MCONT_PH    = SPACE(10)
MFRT_PH     = SPACE(10)
MBIL_NAME   = SPACE(32)
MBBUYCODE   = SPACE(4)
MDEL_PH     = SPACE(10)
MDEL_MAIL   = SPACE(28)
MDEL_TIME   = SPACE(12)
MGRP_CODE   = SPACE(4)
MGRP_DESC   = SPACE(20)
MMON_RECV   = SPACE(15)
MTUE_RECV   = SPACE(15)
MWED_RECV   = SPACE(15)
MTHU_RECV   = SPACE(15)
MFRI_RECV   = SPACE(15)
MSAT_RECV   = SPACE(15)
MSUN_RECV   = SPACE(15)
RETURN

PROCEDURE GETBUY 
@ 05,26 GET mname PICTURE '@!'
@ 06,26 GET MAREA_CODE PICTURE '###'
@ 06,29 GET MPHONE PICTURE '@R -###-####'
@ 6,57  GET MFAX PICTURE '@R ###-###-####'
@ 8,26  GET MCONT_NAME PICTURE '@!'
@ 9,26  GET MCONT_NAM2 PICTURE '@!'
@ 10,26 GET MCONT_PH   PICTURE '@R ###-###-####'
@ 10,65  GET MCONT_FAX PICTURE '@R ###-###-####'
@ 11,26 GET MFRT_PH PICTURE '@R ###-###-####'
@ 11,65 GET MDEL_PH PICTURE '@R ###-###-####'
@ 12,18 GET MDEL_MAIL  
@ 12,65 GET MDEL_TIME PICTURE '@!'
@ 13,12 GET MMON_RECV PICTURE '@!'
@ 13,34 GET MTUE_RECV PICTURE '@!'
@ 13,56 GET MWED_RECV PICTURE '@!'
@ 14,12 GET MTHU_RECV PICTURE '@!'
@ 14,34 GET MFRI_RECV PICTURE '@!'
@ 14,56 GET MSAT_RECV PICTURE '@!'
@ 15,12 GET MSUN_RECV PICTURE '@!'

@ 16,26 GET mstreet PICTURE '@!'
@ 17,26 GET mcity PICTURE '@!'
@ 17,57 GET mstate PICTURE '@!'
@ 17,67 GET mzip PICTURE '#####'
@ 17,73 GET mzip4 PICTURE '####'

@ 18,12 GET mnote PICTURE '@!'
@ 19,39 GET MGRP_CODE PICTURE '@!'
@ 19,55 GET MGRP_DESC PICTURE '@!'
@ 20,26 GET MBIL_NAME PICTURE '@!'
RETURN

PROCEDURE STORBUY 
STORE NAME       TO MNAME      
STORE STREET     TO MSTREET    
STORE CITY       TO MCITY      
STORE STATE      TO MSTATE     
STORE ZIP        TO MZIP       
STORE ZIP4       TO MZIP4      
STORE NOTE       TO MNOTE      
STORE BUY_CODE   TO MBUY_CODE
STORE AREA_CODE  TO MAREA_CODE
STORE PHONE      TO MPHONE
STORE FAX        TO MFAX
STORE CONT_FAX   TO MCONT_FAX
STORE CONT_NAME  TO MCONT_NAME
STORE CONT_NAM2  TO MCONT_NAM2
STORE CONT_PH    TO MCONT_PH
STORE FRT_PH     TO MFRT_PH
STORE DEL_PH     TO MDEL_PH
STORE DEL_MAIL   TO MDEL_MAIL
STORE DEL_TIME   TO MDEL_TIME
STORE BBUYCODE   TO MBBUYCODE
STORE GRP_CODE   TO MGRP_CODE
STORE GRP_DESC   TO MGRP_DESC
STORE MON_RECV   TO MMON_RECV
STORE TUE_RECV   TO MTUE_RECV
STORE WED_RECV   TO MWED_RECV
STORE THU_RECV   TO MTHU_RECV
STORE FRI_RECV   TO MFRI_RECV
STORE SAT_RECV   TO MSAT_RECV
STORE SUN_RECV   TO MSUN_RECV
RETURN

PROCEDURE REPLBUY 
IF NAME <> MNAME .OR. BUY_CODE <> MBUY_CODE
   DO FILELOCK
   REPLACE NAME       WITH MNAME      
   REPLACE BUY_CODE   WITH MBUY_CODE
ELSE
   DO RECLOCK
ENDIF
REPLACE street     WITH mstreet    
REPLACE city       WITH mcity      
REPLACE state      WITH mstate     
REPLACE zip        WITH mzip       
REPLACE zip4       WITH mzip4      
REPLACE note       WITH mnote      
REPLACE AREA_CODE  WITH MAREA_CODE
REPLACE PHONE      WITH MPHONE
REPLACE FAX        WITH MFAX
REPLACE CONT_FAX   WITH MCONT_FAX
REPLACE CONT_NAME  WITH MCONT_NAME
REPLACE CONT_NAM2  WITH MCONT_NAM2
REPLACE CONT_PH    WITH MCONT_PH
REPLACE FRT_PH     WITH MFRT_PH
REPLACE DEL_PH     WITH MDEL_PH
REPLACE DEL_MAIL   WITH MDEL_MAIL
REPLACE DEL_TIME   WITH MDEL_TIME
REPLACE BBUYCODE   WITH MBBUYCODE
REPLACE GRP_CODE   WITH MGRP_CODE
REPLACE GRP_DESC   WITH MGRP_DESC
REPLACE MON_RECV   WITH MMON_RECV
REPLACE TUE_RECV   WITH MTUE_RECV
REPLACE WED_RECV   WITH MWED_RECV
REPLACE THU_RECV   WITH MTHU_RECV
REPLACE FRI_RECV   WITH MFRI_RECV
REPLACE SAT_RECV   WITH MSAT_RECV
REPLACE SUN_RECV   WITH MSUN_RECV
UNLOCK
RETURN

PROCEDURE PUBLBUY 
PUBLIC mname, mstreet, mcity, mstate, mzip
PUBLIC MZIP4, MBUY_CODE
PUBLIC MPHONE, MAREA_CODE, MBIL_NAME, MBBUYCODE
PUBLIC MNOTE
RETURN

*********************************
***** BILL TO CUSTOMER INFO *****
*********************************
PROCEDURE TEXTBBUY
CLEAR 
@  0, 0 SAY MCOMPANY
@  1, 0 SAY MPROGRAM + MTITLE
@  1,68 SAY DATE()
@ 2,0 TO 23,80

@ 3,1  SAY 'BILL NAME (DBA):'        
@ 3,54 SAY 'ACTIVE/INACTIVE (Y/N):'
@ 4,1  SAY 'REGISTER/CORP NM'
@ 4,51 SAY 'INTERNATIONAL CUST (Y/N): '
@ 5,1 SAY '   PHONE NUMBER:              X:        FAX NBR: '
@ 6,9 SAY 'UNITED STATES ADDRESS'
@ 6,38 SAY 'OR'
@ 6,50 SAY 'INTERNATIONAL ADDRESS'
@ 7,1 SAY 'STREET:'
@ 7,38 SAY 'ADR1:'
@ 8,38 SAY 'ADR2:'
@ 9,3 SAY 'CITY:'
@ 9,38 SAY 'ADR3:'
@ 10,2 SAY 'STATE:'
@ 10,14 SAY 'ZIP:'
@ 10,24 SAY '-'
IF MCOMPANY = 'MIDWEST FOOD -DIV 11 INVENTORY' .OR. MCOMPANY = 'AMERICHICKEN, INC'
   @ 10,38 SAY 'INCENTIVE SALES:'
ENDIF
@ 11,1 TO 11,78
@ 11,40 SAY 'FILE DOCUMENTS: Y,N,R  DATE'
@ 12,1 SAY 'CREDIT LIMIT:            TERM DAYS:'
@ 12,40 SAY '    CREDIT APP:'          
@ 13,1 SAY 'SALES: 1ST             LAST'
@ 13,40 SAY 'FINANCIAL STMT:' 
@ 14,1 SAY 'DATE REVIEWED:'
@ 14,40 SAY '  D & B REPORT:'
IF MPROG_CODE = 1 
   @ 15,1 SAY 'CREDIT REQUESTED BY:'
ELSE
   @ 15,1 SAY 'REGION:'
ENDIF
@ 15,40 SAY 'LETTER OF CRED:'
@ 16,40 SAY 'PERS GUARANTOR:'
@ 17,1  SAY 'FEDERATED CUSTOMER (Y/N):'
@ 17,38 TO 17,78
@ 17,48 SAY 'BALANCES'
@ 17,66 SAY 'AVG PAY DAYS'
@ 18,1 SAY "PRINT S/W'S ON INVOICES (Y/N): "
@ 18,41 SAY 'HIGH:'
IF MPROG_CODE = 1
   @ 18,61 SAY 'PREV 6 MO:'
ELSE
   @ 18,61 SAY 'PREV 2 YR:'
ENDIF
@ 19,1 SAY 'PO MSG:'
@ 19,38 SAY 'CURRENT:'
IF MPROG_CODE = 1
   @ 19,58 SAY 'PREV 25 DAYS:'
ELSE
   @ 19,61 SAY 'PREV 1 YR:'
ENDIF
@ 20,2 SAY 'NOTES:'
RETURN

PROCEDURE INITBBUY
IF MINIT_NM
   mname       = SPACE(32)
ENDIF
MREG_NAME   = SPACE(32)
mstreet     = SPACE(28)
mcity       = SPACE(20)
mstate      = SPACE(2)
mzip        = SPACE(5)
mzip4       = SPACE(4)
MBBUYCODE   = SPACE(4)
RETURN


PROCEDURE GETBBUY
@ 03,18 GET MNAME PICTURE '@!'
@ 04,18 GET MREG_NAME PICTURE '@!'
@ 05,18 GET MAREA_CODE PICTURE '@R ###'
@ 05,21 GET MPHONE PICTURE '@R -###-####'
@ 05,33 GET MEXTENSION  PICTURE '#####'
@ 05,50 GET MFAX PICTURE '@R ###-###-####'
@ 03,77 GET MACTIVE PICTURE '@!'
@ 04,77 GET MINTERNAT PICTURE '@!'

@ 07,9 GET MSTREET PICTURE '@!'
*@ 07,9 GET MSTREET2 PICTURE '@!'
@ 09,9 GET MCITY PICTURE '@!'
@ 10,9 GET MSTATE PICTURE '@!'
@ 10,19 GET mzip PICTURE '#####'
@ 10,25 GET mzip4 PICTURE '####'
@ 07,44 GET MILINE1 PICTURE '@!'
@ 08,44 GET MILINE2 PICTURE '@!'
@ 09,44 GET MILINE3 PICTURE '@!'

IF MCOMPANY = 'MIDWEST FOOD -DIV 11 INVENTORY' .OR. MCOMPANY = 'AMERICHICKEN, INC'
   @ 10,55 GET MINCEN_NM PICTURE '@!'
ENDIF
@ 12,15 GET MCRED_LIM   PICTURE '########'
IF MTERM_DAYS = 0
   ***MTERM_DAYS = 10
   ** EFFECTIVE 04/25/2012 - NEW TERM OF 15 DAYS
   MTERM_DAYS = 15
ENDIF
@ 12,37 SAY MTERM_DAYS  PICTURE '##'
@ 13,12 SAY MFST_SALE
@ 13,29 SAY MLAST_SALE
@ 14,16 GET MDATE_RVWD
IF MPROG_CODE = 1
   @ 16,1  GET MCRED_RQST PICTURE '@!'
ELSE
   @ 16,1  GET MREGION PICTURE '@!'
ENDIF
@ 17,27 GET MFED_CUST PICTURE '@!' VALID(MFED_CUST = 'Y' .OR. MFED_CUST = 'N')
@ 12,58 GET MCREDIT_AP  PICTURE '@!' VALID (MCREDIT_AP = 'Y' .OR. MCREDIT_AP = 'N')
@ 12,61 GET MCREDAP_DT          
@ 13,58 GET MFIN_PROV PICTURE '@!' VALID (MFIN_PROV = 'Y' .OR. MFIN_PROV = 'N' .OR. MFIN_PROV = 'R')
@ 13,61 GET MDATE_FIN
@ 14,58 GET MDB_RPT PICTURE '@!' VALID(MDB_RPT = 'Y' .OR. MDB_RPT = 'N')
@ 14,61 GET MDB_DT    
@ 15,58 GET MLETTER_C PICTURE '@!' VALID(MLETTER_C = 'Y' .OR. MLETTER_C = 'N')
@ 15,61 GET MBEG_DATE

@ 18,32 GET MCUST_SW PICTURE '@!'
@ 19,09 GET MPO_WARN PICTURE '@!'
@ 18,47 SAY MHIGH_BAL PICTURE '9,999,999'
@ 19,47 SAY MCUR_BAL PICTURE '9,999,999'
@ 18,73 SAY MPREV_6MO PICTURE '99.99'
@ 19,73 SAY MPREV_25DY PICTURE '99.99'
@ 20,09 GET MNOTE PICTURE '@!'
@ 21,09 GET MNOTE2 PICTURE '@!'
RETURN


PROCEDURE SAYBBUY
@ 03,18 SAY MNAME PICTURE '@!'
@ 04,18 SAY MREG_NAME PICTURE '@!'
@ 05,18 SAY MAREA_CODE PICTURE '@R ###'
@ 05,21 SAY MPHONE PICTURE '@R -###-####'
@ 05,33 SAY MEXTENSION  PICTURE '#####'
@ 05,50 SAY MFAX PICTURE '@R ###-###-####'
@ 03,77 SAY MACTIVE PICTURE '@!'
@ 04,77 SAY MINTERNAT PICTURE '@!'

@ 07,9 SAY MSTREET PICTURE '@!'
@ 09,9 SAY MCITY PICTURE '@!'
@ 10,9 SAY MSTATE PICTURE '@!'
@ 10,19 SAY mzip PICTURE '#####'
@ 10,25 SAY mzip4 PICTURE '####'
@ 07,44 SAY MILINE1 PICTURE '@!'
@ 08,44 SAY MILINE2 PICTURE '@!'
@ 09,44 SAY MILINE3 PICTURE '@!'

IF MCOMPANY = 'MIDWEST FOOD -DIV 11 INVENTORY' .OR. MCOMPANY = 'AMERICHICKEN, INC'
   @ 10,55 SAY MINCEN_NM PICTURE '@!'
ENDIF
@ 12,15 SAY MCRED_LIM   PICTURE '########'
IF MTERM_DAYS = 0
   ***MTERM_DAYS = 10
   ** EFFECTIVE 04/25/2012 - NEW TERM OF 15 DAYS
   MTERM_DAYS = 15
ENDIF
@ 12,37 SAY MTERM_DAYS  PICTURE '##'
@ 13,12 SAY MFST_SALE
@ 13,29 SAY MLAST_SALE
@ 14,16 SAY MDATE_RVWD
IF MPROG_CODE = 1
   @ 16,1  SAY MCRED_RQST PICTURE '@!'
ELSE
   @ 16,1  SAY MREGION PICTURE '@!'
ENDIF
@ 17,27 SAY MFED_CUST PICTURE '@!'
@ 12,58 SAY MCREDIT_AP  PICTURE '@!'
@ 12,61 SAY MCREDAP_DT          
@ 13,58 SAY MFIN_PROV PICTURE '@!'
@ 13,61 SAY MDATE_FIN
@ 14,58 SAY MDB_RPT PICTURE '@!'
@ 14,61 SAY MDB_DT    
@ 15,58 SAY MLETTER_C PICTURE '@!'
@ 15,61 SAY MBEG_DATE
@ 18,32 SAY MCUST_SW PICTURE '@!'
@ 19,09 SAY MPO_WARN PICTURE '@!'
@ 18,47 SAY MHIGH_BAL PICTURE '9,999,999'
@ 19,47 SAY MCUR_BAL PICTURE '9,999,999'
@ 18,73 SAY MPREV_6MO PICTURE '99.99'
@ 19,73 SAY MPREV_25DY PICTURE '99.99'
@ 20,09 SAY MNOTE PICTURE '@!'
@ 21,09 SAY MNOTE2 PICTURE '@!'
RETURN

PROCEDURE STORBBUY 
STORE NAME       TO MNAME      
STORE REG_NAME   TO MREG_NAME
STORE street     TO mstreet    
STORE city       TO mcity      
STORE state      TO mstate     
STORE zip        TO mzip       
STORE zip4       TO mzip4      
STORE cred_lim   TO mcred_lim  
STORE TERM_DAYS  TO MTERM_DAYS
STORE note       TO mnote
STORE BBUYCODE   TO MBBUYCODE
STORE AREA_CODE  TO MAREA_CODE
STORE PHONE      TO MPHONE
STORE EXTENSION  TO MEXTENSION
STORE FAX        TO MFAX
STORE FST_SALE   TO MFST_SALE
STORE BEG_DATE   TO MBEG_DATE
STORE END_DATE   TO MEND_DATE
STORE DATE_FIN   TO MDATE_FIN
STORE DATE_RVWD  TO MDATE_RVWD
STORE LET_CRD    TO MLET_CRD
STORE GUARAN     TO MGUARAN
STORE CUST_SW    TO MCUST_SW
STORE FED_CUST   TO MFED_CUST
IF MCUST_SW = SPACE(1)
   STORE 'N' TO MCUST_SW
ENDIF
STORE ACTIVE TO MACTIVE
IF MACTIVE <> 'I'
   STORE 'A' TO MACTIVE
ENDIF
STORE PO_WARN TO MPO_WARN
STORE REGION    TO MREGION
STORE INTERNAT TO MINTERNAT
STORE STREET2 TO MSTREET2
STORE ISTREET TO MISTREET
STORE ISTREET2 TO MISTREET2
STORE ICITY    TO MICITY
STORE COUNTRY TO MCOUNTRY
STORE INT_ZIP TO MINT_ZIP
STORE ILINE1  TO MILINE1
STORE ILINE2  TO MILINE2
STORE ILINE3  TO MILINE3

STORE NOTE2    TO MNOTE2
STORE CRED_RQST TO MCRED_RQST
STORE HIGH_BAL  TO MHIGH_BAL

STORE CREDAP_DT  TO MCREDAP_DT
STORE DB_DT      TO MDB_DT
IF FIN_PROV = SPACE(1)
   STORE 'N' TO MFIN_PROV
ELSE
   STORE FIN_PROV TO MFIN_PROV
ENDIF
IF CREDIT_AP = SPACE(1)
   STORE 'N' TO MCREDIT_AP
ELSE
   STORE CREDIT_AP TO MCREDIT_AP
ENDIF
IF DB_RPT = SPACE(1)
   STORE 'N' TO MDB_RPT
ELSE
   STORE DB_RPT TO MDB_RPT
ENDIF
IF LETTER_C = SPACE(1)
   STORE 'N' TO MLETTER_C
ELSE
   STORE LETTER_C TO MLETTER_C
ENDIF


SELECT D
DO FOX_USE WITH "PO_HEAD INDEX TMP_BUY", .F.
SEEK MBBUYCODE
DO WHILE .NOT. EOF() .AND. BBUYCODE = MBBUYCODE
   MFST_SALE = SHIP_DATE
   SKIP
ENDDO
USE

MCUR_BAL = 0
SELECT D
DO FOX_USE WITH "INV_ADJ INDEX INV_ADJ", .F.

SELECT B
DO FOX_USE WITH "CUS_INV INDEX CUS_INV, CUS_DATE, CUSIVNBR", .F.

SEEK MBBUYCODE + ' '
MBALANCE = 0
MLAST_SALE = CTOD('')
DO WHILE .NOT. EOF() .AND. BBUYCODE = MBBUYCODE .AND. PAID_FLG = ' '
   STORE INV_NBR TO MINV_NBR
   STORE SALESMAN TO MSALESMAN
   STORE PO_NBR TO MPO_NBR
   STORE PO_SUFFIX TO MPO_SUFFIX
   MCUR_BAL = MCUR_BAL + TOT_SELL + CUS_PALL - AMT_PAID
   IF DEB_CRD = ' ' .AND. SUBSTR(INV_NBR,1,1) <> 'A'
      SELECT D
      SEEK MINV_NBR
      DO WHILE .NOT. EOF() .AND. INV_NBR = MINV_NBR
         MCUR_BAL = MCUR_BAL + ADJ_AMT
         SKIP
      ENDDO
   ENDIF
   SELECT B
   SKIP
ENDDO
SELECT B
USE
SELECT D
DO FOX_USE WITH "PO_HEAD INDEX TMP_BUY", .F.
SEEK MBBUYCODE
MLAST_SALE = SHIP_DATE
USE

IF MCOMPANY = 'MIDWEST FOOD -DIV 11 INVENTORY' .OR. MCOMPANY = 'AMERICHICKEN, INC'
   SELECT D
   DO FOX_USE WITH "SALESMAN INDEX SAL_CODE", .F.
   SEEK A->INCEN_CD
   IF EOF()
      IF A->NO_INCEN = 'Y' .OR. A->NO_INCEN = ' '
         STORE 'INCEN NOT ASSIGNED' + SPACE(2) TO MINCEN_NM
      ELSE
         STORE 'INCEN NOT ON FILE' + SPACE(3) TO MINCEN_NM
      ENDIF
   ELSE
      STORE SUBSTR(NAME,1,20) TO MINCEN_NM
   ENDIF
   USE
ENDIF

SELECT A
IF SHIPS_25 <> 0 .AND. DAYS_25 <> 0
   MPREV_25DY = DAYS_25/SHIPS_25
ELSE
   MPREV_25DY = 0
ENDIF

IF SHIPS_180 <> 0 .AND. DAYS_180 <> 0
   MPREV_6MO = DAYS_180/SHIPS_180
ELSE
   MPREV_6MO = 0
ENDIF

RETURN

PROCEDURE REPLBBUY
IF NAME <> MNAME .OR. BBUYCODE <> MBBUYCODE
   DO FILELOCK
   REPLACE NAME       WITH MNAME      
   REPLACE BBUYCODE   WITH MBBUYCODE
ELSE
   DO RECLOCK
ENDIF
REPLACE REG_NAME WITH MREG_NAME
REPLACE street     WITH mstreet    
REPLACE city       WITH mcity      
REPLACE state      WITH mstate     
REPLACE zip        WITH mzip       
REPLACE zip4       WITH mzip4      
REPLACE cred_lim   WITH mcred_lim  
REPLACE TERM_DAYS  WITH MTERM_DAYS
REPLACE note       WITH mnote
REPLACE AREA_CODE  WITH MAREA_CODE
REPLACE PHONE      WITH MPHONE
REPLACE EXTENSION  WITH MEXTENSION
REPLACE FAX        WITH MFAX
REPLACE FST_SALE WITH MFST_SALE
REPLACE BEG_DATE   WITH MBEG_DATE
REPLACE END_DATE   WITH MEND_DATE
REPLACE DATE_FIN   WITH MDATE_FIN
REPLACE DATE_RVWD  WITH MDATE_RVWD
REPLACE LET_CRD    WITH MLET_CRD
REPLACE GUARAN     WITH MGUARAN
REPLACE FED_CUST   WITH MFED_CUST
IF MCUST_SW = 'Y'
   REPLACE CUST_SW WITH MCUST_SW
ELSE
   REPLACE CUST_SW WITH 'N'
ENDIF
IF MACTIVE <> 'I'
   MACTIVE = ' '
ENDIF
IF MFIN_PROV = ' '
   REPLACE FIN_PROV WITH 'N'
ELSE
   REPLACE FIN_PROV WITH MFIN_PROV
ENDIF
IF MCREDIT_AP = ' '
   REPLACE CREDIT_AP WITH 'N'
ELSE
   REPLACE CREDIT_AP WITH MCREDIT_AP
ENDIF
IF MDB_RPT = ' '
   REPLACE DB_RPT WITH 'N'
ELSE
   REPLACE DB_RPT WITH MDB_RPT     
ENDIF
IF MLETTER_C = ' '
   REPLACE LETTER_C WITH 'N'
ELSE
   REPLACE LETTER_C WITH MLETTER_C   
ENDIF

REPLACE CREDAP_DT WITH MCREDAP_DT
REPLACE DB_DT WITH MDB_DT

REPLACE ACTIVE WITH MACTIVE
REPLACE PO_WARN    WITH MPO_WARN
REPLACE REGION      WITH MREGION
REPLACE INTERNAT    WITH MINTERNAT
REPLACE STREET2     WITH MSTREET2
REPLACE ISTREET     WITH MISTREET
REPLACE ISTREET2    WITH MISTREET2
REPLACE ICITY       WITH MICITY
REPLACE COUNTRY     WITH MCOUNTRY
REPLACE INT_ZIP     WITH MINT_ZIP
REPLACE ILINE1      WITH MILINE1
REPLACE ILINE2      WITH MILINE2
REPLACE ILINE3      WITH MILINE3
REPLACE NOTE2       WITH MNOTE2  
REPLACE CRED_RQST   WITH MCRED_RQST
IF MCOMPANY = 'MIDWEST FOOD -DIV 11 INVENTORY' .OR. MCOMPANY = 'AMERICHICKEN, INC'
   SELECT D
   DO FOX_USE WITH "SALESMAN INDEX SAL_NAME", .F.
   
   SEEK MINCEN_NM
   IF EOF()
      STORE SPACE(2) TO MINCEN_CD
   ELSE
      STORE SALE_CODE TO MINCEN_CD
   ENDIF
   
   USE
   SELECT A
   
   REPLACE INCEN_CD WITH MINCEN_CD
ENDIF
UNLOCK
RETURN

PROCEDURE PUBLBBUY
PUBLIC MNAME, MSTREET, MCITY, MSTATE, MZIP, MZIP4, MBBUYCODE
RETURN

PROCEDURE PUBLBBY2
***** DO I REALLY NEED THIS????
*PUBLIC mcred_lim, mnote            
*PUBLIC MAREA_CODE, MPHONE, MFST_SALE, MBEG_DATE, MEND_DATE
*PUBLIC MLET_CRD, MGUARAN, MDATE_FIN, MDATE_RVWD, MCUST_SW, MPO_WARN, MACTIVE
*PUBLIC MINTERNAT, MSTREET2, MCOUNTRY, MINT_ZIP, MFIN_PROV
*PUBLIC MNOTE2, MISTREET, MISTREET2, MICITY, MCREDIT_AP, MCREDAP_DT, MDB_RPT
*PUBLIC MDB_DT, MLETTER_C
RETURN

PROCEDURE RELEBBY2
*RELEASE mcred_lim, mnote            
*RELEASE MAREA_CODE, MPHONE, MFST_SALE, MBEG_DATE, MEND_DATE
*RELEASE MLET_CRD, MGUARAN, MDATE_FIN, MDATE_RVWD, MCUST_SW, MPO_WARN, MACTIVE
*RELEASE MINTERNAT, MSTREET2, MCOUNTRY, MINT_ZIP, MFIN_PROV
*RELEASE MNOTE2, MISTREET, MISTREET2, MICITY, MCREDIT_AP, MCREDAP_DT, MDB_RPT
*RELEASE MDB_DT, MLETTER_C
RETURN

PROCEDURE BBUY_SEL
* Notes...: BUYER SELECT
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
SELECT A
DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYNAME, &MDBFLOC.BBUYCODE", .F.
STORE 0 TO MHIGH_BAL, MCUR_BAL, MPREV_25DY, MPREV_6MO

STORE SPACE(32)    TO MNAME 
MNAME_FD = .F.
STORE 1 TO MACTION
MBUY_SEL = .T.
DO WHILE MBUY_SEL
   
   CLEAR 
   @  1, 0 SAY MCOMPANY
   @  1,68 SAY DATE()
   MTITLE = ' - SELECT BILL TO CUSTOMER'
   @  2, 0 SAY MPROGRAM + MTITLE
   @ 3,0 TO 22,79
   @  5, 5 SAY 'Enter Search Field:'
   @  8, 5 SAY 'Name'
   @ 10, 5 GET Mname PICTURE '@!'
   
   STORE 1 TO MACTION
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)  
   @ 24,13 SAY '1. Continue    2. Edit     3. Finished'                                     
   
   READ
   
   @24,09 GET MACTION PICTURE '9' RANGE 1,3
   READ               
   
   DO CASE
      
   CASE MACTION = 1
      
      IF MNAME <> SPACE(32)
         STORE TRIM(MNAME) TO SRCH_ARG
         SEEK SRCH_ARG
         IF EOF() .OR. DELETED()
            @ 23,0 CLEAR
            STORE 'Y' TO MYES_NO
            @ 24,05 SAY 'NAME NOT FOUND - DO YOU WANT TO ADD (Y/N)? ' get MYES_NO PICTURE '@!'
            READ
            IF MYES_NO = 'Y'
               MINIT_NM = .F.
               DO BBUY_ADD
               STORE SPACE(32) TO MNAME
            ELSE 
               STORE SPACE(32) TO MNAME
            ENDIF
            LOOP
         ELSE               
            STORE RECNO() TO MFST_REC
            MADD = .F.
            DO MUL1BBUY 
            IF MACTION = 5
               LOOP
            ENDIF
            IF MADD
               MNAME = SPACE(32)
               LOOP
            ENDIF
            DO BBUYEDIT
            MNAME = SPACE(32)
            LOOP
         ENDIF
      ENDIF     
      
      MBUY_SEL = .F.
      LOOP
   CASE MACTION = 2
      LOOP
      
   CASE MACTION = 3
      MBUY_SEL = .F.
      
   ENDCASE
   
ENDDO

RETURN


PROCEDURE BUY_SEL
* Notes...: BUYER SELECT
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
SELECT A
DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME, &MDBFLOC.BUY_CODE", .F.
STORE SPACE(32)    TO MNAME 
STORE SPACE(4) TO MGRP_CODE
STORE SPACE(20) TO MGRP_DESC
MNAME_FD = .F.
STORE 1 TO MACTION
MBUY_SEL = .T.
DO WHILE MBUY_SEL
   
   CLEAR 
   @  1, 0 SAY MCOMPANY
   @  1,68 SAY DATE()
   MTITLE = ' - SELECT CUSTOMER'
   @  2, 0 SAY MPROGRAM + MTITLE
   @ 3,0 TO 22,79
   @  5, 5 SAY 'Enter Customer Search Field:'
   @  8, 5 SAY 'Name'
   @ 10, 5 GET Mname PICTURE '@!'
   
   STORE 1 TO MACTION
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)  
   @ 24,13 SAY '1. Continue    2. Edit     3. Finished'                                     
   
   READ
   
   @24,09 GET MACTION PICTURE '9' RANGE 1,3
   READ               
   
   DO CASE
      
   CASE MACTION = 1
      
      IF MNAME <> SPACE(32)
         STORE TRIM(MNAME) TO SRCH_ARG
         SEEK SRCH_ARG
         IF EOF() .OR. DELETED()
            @ 24,0 CLEAR
            STORE 'Y' TO MYES_NO
            @ 24,05 SAY 'NAME NOT FOUND - DO YOU WANT TO ADD (Y/N)? ' get MYES_NO PICTURE '@!'
            READ
            IF MYES_NO = 'Y'
               MINIT_NM = .F.
               DO BUY_ADD
               STORE SPACE(32) TO MNAME
            ELSE 
               STORE SPACE(32) TO MNAME
            ENDIF
            LOOP
         ELSE               
            STORE RECNO() TO MFST_REC
            *            SKIP
            *            IF NAME = SRCH_ARG
            MADD = .F.
            DO MUL1BUY
            IF MACTION = 5
               LOOP
            ENDIF
            IF MADD
               MNAME = SPACE(32)
               LOOP
            ENDIF
            DO BUY_EDIT
            MNAME = SPACE(32)
            LOOP
         ENDIF
      ENDIF     
      
      MBUY_SEL = .F.
      LOOP
   CASE MACTION = 2
      LOOP
      
   CASE MACTION = 3
      MBUY_SEL = .F.
      
   ENDCASE
   
ENDDO

RETURN
* EOF: BUY_SEL.PRG

PROCEDURE BBUY_ADD
* Notes...: CUSTOMER ADD
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MMORE_BBUY = .T.  
MTITLE = ' - ADD BILL TO CUSTOMER INFORMATION' 
**** PUT UP THE SCREEN
DO TEXTBBUY
DO WHILE MMORE_BBUY
   DO INITBBUY
   MREG_NAME   = SPACE(32)
   mcred_lim   = 0
   MTERM_DAYS  = 0
   mnote       = SPACE(60)
   MFST_SALE   = CTOD(' ')
   MLAST_SALE  = CTOD('')
   MBBUYCODE   = SPACE(4)
   MAREA_CODE   = SPACE(3)
   MPHONE       = SPACE(7)
   MEXTENSION   = SPACE(5)
   MFAX         = SPACE(10)
   MNET_DAYS    = 0
   MBEG_DATE    = CTOD(' ')
   MEND_DATE    = CTOD(' ')
   MDATE_RVWD   = CTOD(' ')
   MDATE_FIN    = CTOD(' ')
   MLET_CRD     = 0
   MGUARAN      = SPACE(20)
   MCUST_SW     = 'N'
   MPO_WARN     = SPACE(20)
   MREGION      = SPACE(30)
   MACTIVE      = 'A'
   MINTERNAT    = 'N'
   MSTREET2     = SPACE(28)
   MCOUNTRY     = SPACE(28)
   MINT_ZIP     = SPACE(8)
   MILINE1      = SPACE(35)
   MILINE2      = SPACE(35)
   MILINE3      = SPACE(35)
   MNOTE2       = SPACE(60)
   MFIN_PROV    = 'N'
   MISTREET     = SPACE(28)
   MISTREET2    = SPACE(28)
   MICITY       = SPACE(20)
   MCRED_RQST   = SPACE(32)
   MHIGH_BAL    = 0
   MCUR_BAL     = 0
   MPREV_6MO    = 0
   MPREV_25DY   = 0
   MCREDIT_AP   = 'N'
   MCREDAP_DT   = CTOD(' ')
   MDB_RPT      = 'N'
   MDB_DT       = CTOD(' ')
   MLETTER_C    = 'N'
   MFED_CUST    = 'N'
   MINCEN_NM    = SPACE(20)
   MNOT_DONE = .T.
   DO WHILE MNOT_DONE
      DO GETBBUY
      STORE 1 TO MACTION
      @ 23,0 CLEAR
      @ 23,01 SAY 'Action: ' + STR(MACTION,1)
      @ 23,13 SAY '1. Save        2. Edit        3. Cancel'
      @ 24,13 SAY '4. Credit App  5. Fin. Stmt   6. D&B      7. Letter of Credit'
      READ
      @23,09 GET MACTION PICTURE '9' RANGE 1,7
      READ               
      DO CASE
      CASE MACTION = 3
         MNOT_DONE = .F.
         MMORE_BBUY = .F.
         LOOP
         
      CASE MACTION = 2
         LOOP
         
      CASE MACTION = 1
         IF MNAME = SPACE(32)    
            MNOT_DONE = .F.
            MMORE_BBUY = .F.
            LOOP
         ENDIF
         SEEK MNAME
         IF .NOT. EOF()
            @ 23,0 CLEAR
            STORE 'N' TO MYES_NO 
            @ 23,1 SAY 'BILL TO NAME ALREADY ON FILE -DO YOU WANT TO CONTINUE WITH ADD (Y/N)? ' GET MYES_NO PICTURE '@!'
            READ
            IF MYES_NO <> 'Y'
               MINIT_NM = .T.
               MNOT_DONE = .F.
               LOOP
            ENDIF
         ENDIF
         
         IF MCOMPANY = 'MIDWEST FOOD -DIV 11 INVENTORY' .OR. MCOMPANY = 'AMERICHICKEN, INC'
            SELECT D
            DO FOX_USE WITH "SALESMAN INDEX SAL_NAME", .F.
            IF MINCEN_NM = SPACE(10)
               SEEK MINCEN_NM
            ELSE
               SEEK TRIM(MINCEN_NM)
            ENDIF
            IF EOF()
               @ 23,0 CLEAR
               STORE ' ' TO MYES_NO 
               @ 23,1 SAY 'INCENTIVE SALESPSERSON ON FILE - MUST BE ON FILE - PRESS RETURN' GET MYES_NO PICTURE '@!'
               READ
               MINIT_NM = .F.
               USE
               SELECT A
               LOOP
            ELSE
               STORE SUBSTR(NAME,1,20) TO MINCEN_NM
            ENDIF  
            
            USE
         ENDIF
         
         IF MMASTDBF <> MDBFLOC
            SELECT E
            DO FOX_USE WITH "&MDBFLOC.CONTROL", .F.
         ELSE
            SELECT E
            DO FOX_USE WITH "&MMASTDBF.CONTROL", .F.
         ENDIF
         STORE STR(BBUYCODE+1,4) TO MBBUYCODE
         DO RECLOCK
         REPLACE BBUYCODE WITH BBUYCODE + 1
         UNLOCK
         USE
         SELECT A
         DO FILELOCK
         APPEND BLANK
         UNLOCK
         DO REPLBBUY
         MINIT_NM = .T.
         MADD = .T.
         MMORE_BBUY = .F.
         MNOT_DONE = .F.
      ENDCASE
   ENDDO
ENDDO
RETURN
* EOF: BBUY_ADD.PRG

PROCEDURE BUY_ADD
* Notes...: CUSTOMER ADD
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
STORE SPACE(10) TO MCONT_FAX
STORE SPACE(42) TO MCONT_NAME, MCONT_NAM2
STORE SPACE(10) TO MCONT_PH, MFRT_PH, MDEL_PH
STORE SPACE(35) TO MDEL_MAIL
STORE SPACE(12) TO MDEL_TIME
MMON_RECV   = SPACE(15)
MTUE_RECV   = SPACE(15)
MWED_RECV   = SPACE(15)
MTHU_RECV   = SPACE(15)
MFRI_RECV   = SPACE(15)
MSAT_RECV   = SPACE(15)
MSUN_RECV   = SPACE(15)
MMORE_BUY = .T.
MTITLE = ' - ADD SHIP TO CUSTOMER INFORMATION' 
**** PUT UP THE SCREEN
DO TEXTBUY 
DO WHILE MMORE_BUY
   DO INITBUY  
   MNOT_DONE = .T.
   DO WHILE MNOT_DONE
      DO GETBUY 
      STORE 1 TO MACTION
      @ 24,0 CLEAR
      @ 24,01 SAY 'Action: ' + STR(MACTION,1)
      @ 24,13 SAY '1. Save      2. Edit       3. Cancel'
      READ
      @24,09 GET MACTION PICTURE '9' RANGE 1,3
      READ               
      DO CASE
      CASE MACTION = 3
         MNOT_DONE = .F.
         MMORE_BUY = .F.
         LOOP
         
      CASE MACTION = 2
         LOOP
         
      CASE MACTION = 1
         IF MNAME = SPACE(32)    
            MNOT_DONE = .F.
            MMORE_BUY = .F.
            LOOP
         ENDIF
         IF MBIL_NAME = SPACE(32)
            @ 24,0 CLEAR
            STORE 'PRINCIPAL BILL TO NAME NOT ENTERED - PRESS RETURN TO REENTER' TO MWAIT
            @ 24,5 GET MWAIT
            READ
            LOOP
         ENDIF
         
         SEEK MNAME
         IF .NOT. EOF()
            @ 24,0 CLEAR
            STORE 'N' TO MYES_NO 
            @ 24,1 SAY 'SHIP TO NAME ALREADY ON FILE - DO YOU WANT TO CONTINUE WITH ADD (Y/N)? ' GET MYES_NO PICTURE '@!'
            READ
            IF MYES_NO <> 'Y'
               MINIT_NM = .T.
               DO INITBUY 
               LOOP
            ENDIF
         ENDIF
         STORE MNAME TO MBUY_NAME
         STORE MSTREET TO MBUY_STRT
         STORE MCITY TO MBUY_CITY
         STORE MSTATE TO MBUY_STATE
         STORE MZIP TO MBUY_ZIP
         STORE MZIP4 TO MBUY_ZIP4
         STORE MNOTE TO MBUY_NOTE
         STORE MAREA_CODE TO MBUY_AREA
         STORE MPHONE TO MBUY_PHONE
         STORE MFAX   TO MBUY_FAX
         IF MBIL_NAME <> 'SAME'
            STORE MBIL_NAME TO MNAME
         ENDIF
         
         SELECT A
         DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYNAME, &MDBFLOC.BBUYCODE" ,.F.
         MNAME_FD = .F.
         
         DO BBUYSEL2
         
         **STORE MBUY_NAME TO MNAME
         **STORE MBUY_STRT TO MSTREET
         **STORE MBUY_CITY TO MCITY
         **STORE MBUY_STATE TO MSTATE
         **STORE MBUY_ZIP TO MZIP
         **STORE MBUY_ZIP4 TO MZIP4
         **STORE MBUY_NOTE TO MNOTE
         **STORE MBUY_AREA TO MAREA_CODE
         **STORE MBUY_PHONE TO MPHONE 
         **STORE MBUY_FAX   TO MFAX         
         IF .NOT. MNAME_FD
            @ 24,0 CLEAR
            STORE ' ' TO MWAIT
            @ 24,1 SAY 'BILL TO MUST BE ON FILE - PLEASE HIT ANY KEY TO REENTER'
            @ 24,78  GET MWAIT
            READ
            @ 24,0 CLEAR
            SELECT A
            DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME, &MDBFLOC.BUY_CODE", .F.
            LOOP
         ENDIF
         STORE BBUYCODE TO MBBUYCODE
         @ 20,26 SAY A->NAME
         @ 21,26 SAY A->STREET
         IF A->ZIP4 = SPACE(4)
            STORE A->ZIP TO MZIPB
         ELSE
            STORE A->ZIP + '-' + A->ZIP4 TO MZIPB
         ENDIF
         @ 22,26 SAY TRIM(A->CITY) + ', ' + A->STATE + '  ' + MZIPB
         SELECT A
         DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME, &MDBFLOC.BUY_CODE", .F.
         
         STORE 1 TO MACTION
         @ 24,0 CLEAR
         @ 24,01 SAY 'Action: ' + STR(MACTION,1)
         @ 24,13 SAY '1. Save      2. Edit       3. Cancel'
         @24,09 GET MACTION PICTURE '9' RANGE 1,3
         READ               
         
         DO CASE
         CASE MACTION = 2
            LOOP
         CASE MACTION = 3
            MNOT_DONE = .F.
            MMORE_BUY = .F.
            LOOP
            
         CASE MACTION = 1
            IF MMASTDBF <> MDBFLOC
               SELECT E
               DO FOX_USE WITH "&MDBFLOC.CONTROL", .F.
            ELSE
               SELECT E
               DO FOX_USE WITH "&MMASTDBF.CONTROL", .F.
            ENDIF
            DO RECLOCK
            STORE STR(BUY_CODE+1,4) TO MBUY_CODE
            REPLACE BUY_CODE WITH BUY_CODE + 1
            UNLOCK
            USE
            SELECT A
            DO FILELOCK
            APPEND BLANK
            UNLOCK
            STORE MBUY_NAME TO MNAME
            STORE MBUY_STRT TO MSTREET
            STORE MBUY_CITY TO MCITY
            STORE MBUY_STATE TO MSTATE
            STORE MBUY_ZIP TO MZIP
            STORE MBUY_ZIP4 TO MZIP4
            STORE MBUY_NOTE TO MNOTE
            STORE MBUY_AREA TO MAREA_CODE
            STORE MBUY_PHONE TO MPHONE 
            STORE MBUY_FAX   TO MFAX   

            DO REPLBUY
            MINIT_NM = .T.
            MADD = .T.
            MMORE_BUY = .F.
            MNOT_DONE = .F.
         ENDCASE
      ENDCASE
   ENDDO
ENDDO
RETURN
* EOF: BUY_ADD.PRG

PROCEDURE BBUYEDIT 
* ---OPEN FILES

MMORE_PP = .T.
MTITLE = ' - VIEW/CHANGE/DELETE BILL TO CUSTOMER INFORMATION' 
**** PUT UP THE SCREEN
DO TEXTBBUY
***DO STORBBUY
STORE name       TO mname      
STORE REG_NAME   TO MREG_NAME
STORE street     TO mstreet    
STORE city       TO mcity      
STORE state      TO mstate     
STORE zip        TO mzip       
STORE zip4       TO mzip4      
STORE cred_lim   TO mcred_lim  
STORE TERM_DAYS  TO MTERM_DAYS
STORE note       TO mnote
STORE BBUYCODE   TO MBBUYCODE
STORE AREA_CODE  TO MAREA_CODE
STORE PHONE      TO MPHONE
STORE EXTENSION  TO MEXTENSION
STORE FAX        TO MFAX
STORE FST_SALE   TO MFST_SALE
STORE BEG_DATE   TO MBEG_DATE
STORE END_DATE   TO MEND_DATE
STORE DATE_FIN   TO MDATE_FIN
STORE DATE_RVWD  TO MDATE_RVWD
STORE LET_CRD    TO MLET_CRD
STORE GUARAN     TO MGUARAN
STORE CUST_SW    TO MCUST_SW
STORE FED_CUST   TO MFED_CUST
IF MCUST_SW = SPACE(1)
   STORE 'N' TO MCUST_SW
ENDIF
STORE ACTIVE TO MACTIVE
IF MACTIVE <> 'I'
   STORE 'A' TO MACTIVE
ENDIF
STORE PO_WARN TO MPO_WARN
STORE REGION  TO MREGION
STORE INTERNAT TO MINTERNAT
STORE STREET2 TO MSTREET2
STORE ISTREET TO MISTREET
STORE ISTREET2 TO MISTREET2
STORE ICITY    TO MICITY
STORE COUNTRY TO MCOUNTRY
STORE INT_ZIP TO MINT_ZIP
STORE ILINE1  TO MILINE1
STORE ILINE2  TO MILINE2
STORE ILINE3  TO MILINE3
STORE NOTE2    TO MNOTE2
STORE CRED_RQST TO MCRED_RQST
STORE HIGH_BAL  TO MHIGH_BAL
STORE CREDAP_DT  TO MCREDAP_DT
STORE DB_DT      TO MDB_DT
IF FIN_PROV = SPACE(1)
   STORE 'N' TO MFIN_PROV
ELSE
   STORE FIN_PROV TO MFIN_PROV
ENDIF
IF CREDIT_AP = SPACE(1)
   STORE 'N' TO MCREDIT_AP
ELSE
   STORE CREDIT_AP TO MCREDIT_AP
ENDIF
IF DB_RPT = SPACE(1)
   STORE 'N' TO MDB_RPT
ELSE
   STORE DB_RPT TO MDB_RPT
ENDIF
IF LETTER_C = SPACE(1)
   STORE 'N' TO MLETTER_C
ELSE
   STORE LETTER_C TO MLETTER_C
ENDIF

MCUR_BAL = CUS_BAL
IF MPROG_CODE = 2
   IF DTOC(MFST_SALE) = '  /  /  '
      SELECT B
      DO FOX_USE WITH "CUS_INV INDEX CUS_INV, CUS_DATE, CUSIVNBR", .F.
      SEEK MBBUYCODE + 'Y'    
      IF .NOT. EOF()
         STORE SHIP_DATE TO MFST_SALE
      ELSE
         SEEK MBBUYCODE + ' '
         STORE SHIP_DATE TO MFST_SALE
      ENDIF
      USE
   ENDIF
ELSE
   SELECT D
   DO FOX_USE WITH "PO_HEAD INDEX TMP_BUY", .F.
   SEEK MBBUYCODE
   DO WHILE .NOT. EOF() .AND. BBUYCODE = MBBUYCODE
      MFST_SALE = SHIP_DATE
      SKIP
   ENDDO
   USE
ENDIF
IF MPROG_CODE = 1
   SELECT D
   DO FOX_USE WITH "PO_HEAD INDEX TMP_BUY", .F.
   SEEK MBBUYCODE
   MLAST_SALE = SHIP_DATE
   USE
ELSE
   MLAST_SALE = CTOD('')
ENDIF

SELECT A

IF SHIPS_25 <> 0 .AND. DAYS_25 <> 0
   MPREV_25DY = DAYS_25/SHIPS_25
ELSE
   MPREV_25DY = 0
ENDIF

IF SHIPS_180 <> 0 .AND. DAYS_180 <> 0
   MPREV_6MO = DAYS_180/SHIPS_180
ELSE
   MPREV_6MO = 0
ENDIF
IF MCOMPANY = 'MIDWEST FOOD -DIV 11 INVENTORY' .OR. MCOMPANY = 'AMERICHICKEN, INC'
   SELECT D
   DO FOX_USE WITH "SALESMAN INDEX SAL_CODE", .F.
   SEEK A->INCEN_CD
   IF EOF()
      IF A->NO_INCEN = 'Y' .OR. A->NO_INCEN = ' '
         STORE 'INCEN NOT ASSIGNED' + SPACE(2) TO MINCEN_NM
      ELSE
         STORE 'INCEN NOT ON FILE' + SPACE(3) TO MINCEN_NM
      ENDIF
   ELSE
      STORE SUBSTR(NAME,1,20) TO MINCEN_NM
   ENDIF
   USE
ENDIF

SELECT A
MNOT_DONE = .T.
DO WHILE MNOT_DONE
   DO GETBBUY
   STORE 1 TO MACTION
   @ 23,0 CLEAR
   @ 23,00 SAY 'Action:  ' + STR(MACTION,1)
   @ 23,12 SAY "1.Save  2.Edit Info  3.Delete Cust  4.View PO's  5.Cancel  6.Prt Ltr"
   @ 24,12 SAY '7.Sales Cred Limits  8.Fin. Stmt    9. D&B      10.L/C    11.Notes' 
   READ
   @23,08 GET MACTION PICTURE '99' RANGE 1,11
   READ               
   DO CASE
   CASE MACTION = 5
      MNOT_DONE = .F.
      LOOP
      
   CASE MACTION = 4
      MPICK = .F.
      STORE NAME TO MBBUYNAME
      STORE RECNO() TO MBBUY_REC
      SAVE SCREEN TO MCUST_SCRN
      DO SEL_VW
      RESTORE SCREEN FROM MCUST_SCRN
      SELECT A
      USE
      DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYNAME, &MDBFLOC.BBUYCODE", .F.
      GOTO MBBUY_REC
      DO STORBBUY
      
   CASE MACTION = 2
      LOOP
      
   CASE MACTION = 1 .OR. MACTION = 6 .OR. MACTION = 10 .OR. MACTION = 7 .OR. MACTION = 11
      IF MCOMPANY = 'MIDWEST FOOD -DIV 11 INVENTORY' .OR. MCOMPANY = 'AMERICHICKEN, INC'
         SELECT D
         DO FOX_USE WITH "SALESMAN INDEX SAL_NAME", .F.
         
         IF MINCEN_NM = SPACE(10)
            SEEK MINCEN_NM
         ELSE
            SEEK TRIM(MINCEN_NM)
         ENDIF
         
         IF EOF()
            IF A->NO_INCEN <> 'Y' .AND. A->NO_INCEN <> ' '
               @ 23,0 CLEAR
               STORE ' ' TO MYES_NO 
               @ 23,1 SAY 'INCENTIVE SALESPSERSON ON FILE - MUST BE ON FILE - PRESS RETURN' GET MYES_NO PICTURE '@!'
               READ
               MINIT_NM = .F.
               USE
               SELECT A
               LOOP
            ENDIF
         ELSE
            STORE SUBSTR(NAME,1,20) TO MINCEN_NM
         ENDIF  
         SELECT A
      ENDIF
      DO REPLBBUY
      MNOT_DONE = .F.
      DO CASE
      CASE MACTION = 7
         @ 3,1 CLEAR TO 21,78
         @ 05,1 SAY 'Enter Salesperson Credit Limits'
         MS1_LIM = S1_LIM
         MS2_LIM = S2_LIM
         MS3_LIM = S3_LIM
         MS1_CODE = S1_CODE
         MS2_CODE = S2_CODE
         MS3_CODE = S3_CODE 
         @ 08,1 SAY 'SALESPERSON: ' 
         @ 08,20 SAY 'LIMIT:'
         @ 10,1 SAY 'SALESPERSON: ' 
         @ 10,20 SAY 'LIMIT:'
         @ 12,1 SAY 'SALESPERSON: ' 
         @ 12,20 SAY 'LIMIT:'
         MACTION = 2
         DO WHILE MACTION = 2
            @ 08,14 GET MS1_CODE PICTURE '##'
            @ 08,27 GET MS1_LIM PICTURE '#,###,###'
            @ 10,14 GET MS2_CODE PICTURE '##'
            @ 10,27 GET MS2_LIM PICTURE '#,###,###'
            @ 12,14 GET MS3_CODE PICTURE '##'
            @ 12,27 GET MS3_LIM PICTURE '#,###,###'
            STORE 1 TO MACTION
            @ 23,0 CLEAR
            @ 24,00 SAY 'Action:  ' + STR(MACTION,1)
            @ 24,12 SAY '1. Save     2. Edit     3. Cancel'      
            READ
            @24,08 GET MACTION PICTURE '99' RANGE 1,3 
            READ               
            IF MACTION = 1
               MS_LIM = MS1_LIM + MS2_LIM + MS3_LIM
               IF MS_LIM <> MCRED_LIM
                  @ 24,0 CLEAR 
                  MWAIT = ' ' 
                  @ 24,1 SAY 'Salesperson Limits DO NOT TOTAL the Customer Credit Limit - Please Re-enter! ' get mwait
                  READ
                  @ 24,0 CLEAR
                  MACTION = 2
                  LOOP
               ENDIF
            ENDIF
         ENDDO
         IF MACTION = 1
            DO RECLOCK
            REPLACE S1_LIM WITH MS1_LIM
            REPLACE S2_LIM WITH MS2_LIM
            REPLACE S3_LIM WITH MS3_LIM
            REPLACE S1_CODE WITH MS1_CODE
            REPLACE S2_CODE WITH MS2_CODE
            REPLACE S3_CODE WITH MS3_CODE
         ENDIF
         
      CASE MACTION = 11
         DO BBUYNOTE
         SELECT A
         
      CASE MACTION = 6
         @ 3,1 CLEAR TO 21,78
         @ 08,5 SAY 'SELECT WITH AN "X" THE FOLLOWING LETTER FORMAT'
         @ 10,5 say '1. Credit Application'
         @ 12,5 say '2. Financial Statemnt'
         @ 14,5 say '3. Both of the Above'
         STORE ' ' TO MRPT1, MRPT2, MRPT3
         
         @ 10,27 GET MRPT1 PICTURE '@!'
         @ 12,27 GET MRPT2 PICTURE '@!'
         @ 14,27 GET MRPT3 PICTURE '@!'
         READ
         
         STORE ' ' TO MPRT_ACT
         MSETUP = .T.
         
         DO WHILE MSETUP
            
            STORE 'C' TO MPRT_ACT
            
            @ 19,01 SAY 'LOAD PAPER AND READY THE PRINTER'
            @ 20,01 SAY "TYPE 'C' TO CONTINUE OR 'A' TO ABORT: "     ;
               GET MPRT_ACT PICTURE '@! A'
            
            READ
            
            DO CASE
               
            CASE MPRT_ACT = 'C'
               MSETUP = .F.
               LOOP                
            CASE MPRT_ACT = 'A'
               MSETUP = .F.
               LOOP         
            ENDCASE
         ENDDO
         @ 19,1 SAY SPACE(78)
         @ 20,1 SAY SPACE(78)
         IF MPRT_ACT <> 'C'
            RETURN
         ENDIF 
         
         SET CONSOLE OFF
         IF FILE("C:\COMPINFO\PRINTERS.DBF")
            SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
         ELSE
            SET PRINT TO LPT3
         ENDIF
         SET DEVICE TO PRINT
         SET PRINT ON
         
         *** PRINT IN 10 CPI
         ?? chr(27) + '&k0S'
         
         *** LETTER GOTHIC AND BOLDED PRINT
         ?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'
         
         *** LETTER SIZE PAPER
         ?? CHR(27) + '&l2A'
         
         *** PORTRAIT MODE
         ?? CHR(27) + '&l0O'
         
         ?
         ?
         ?
         ?
         ?
         ?
         ?
         ?
         ?
         MINDENT = 10    
         STORE SUBSTR(DTOC(DATE()),4,2) TO MDAY
         IF VAL(MDAY) < 10
            MDAY = SUBSTR(MDAY,2)
         ENDIF
         ? SPACE(MINDENT) + TRIM(CMONTH(DATE())) + ' ' + MDAY + ', ' + STR(YEAR(DATE()),4)
         ?
         ?
         ?
         ?
         ? SPACE(MINDENT) + MNAME
         ? SPACE(MINDENT) + MSTREET
         ? SPACE(MINDENT) + TRIM(MCITY) + ', ' + MSTATE + '  ' + MZIP
         ?
         ? SPACE(MINDENT) + 'Dear Credit Manager:'
         ?
         ? SPACE(MINDENT) + 'We appreciate the opportunity to do business with your'
         ? SPACE(MINDENT) + 'company and look forward to a good working relationship.'
         ? 
         ? SPACE(MINDENT) + 'To update our credit files, it is our policy to obtain'   
         ? SPACE(MINDENT) + 'a minimum amount of information concerning your company'
         ? SPACE(MINDENT) + 'so that we can better serve you as a reliable supplier'
         ? SPACE(MINDENT) + 'in the most efficient manner.'
         ?
         ? SPACE(MINDENT) + 'We would appreciate it if you would forward to us by '  
         DO CASE
         CASE MRPT2 = 'X'
            ? SPACE(MINDENT) + 'return mail your most recent Financial Statement with'   
            ? SPACE(MINDENT) + 'Balance Sheet including Profit and Loss Statement.'      
         CASE MRPT1 = 'X'
            ? SPACE(MINDENT) + 'return mail the enclosed Credit Application.'
         OTHERWISE
            ? SPACE(MINDENT) + 'return mail the enclosed Credit Application and your'    
            ? SPACE(MINDENT) + 'most recent Financial Statement with Balance Sheet'      
            ? SPACE(MINDENT) + 'including Profit and Loss Statement.'
         ENDCASE
         ? SPACE(MINDENT) + 'Please mail the documents to us at the following address:'
         ?
         ? SPACE(MINDENT) + '            MIDWEST FOOD & POULTRY, INC.'
         ? SPACE(MINDENT) + '            1707 NORTH MOUNT AUBURN RD. SUITE A'
         ? SPACE(MINDENT) + '            CAPE GIRARDEAU, MO  63701'
         ?
         ? SPACE(MINDENT) + 'We assure you that this information will be kept strictly'
         ? SPACE(MINDENT) + 'confidential and within our credit department.'
         ?
         ? SPACE(MINDENT) + 'Thank you in advance for your cooperation and prompt'
         ? SPACE(MINDENT) + 'response.'
         ?
         ? SPACE(MINDENT) + 'Respectfully,'                    
         ?
         ?
         ?
         ? SPACE(MINDENT) + 'Celinda Tankersly'
         ? SPACE(MINDENT) + 'Credit Manager'
         ? ' ' 
         EJECT
         
         SET DEVICE TO SCREEN
         SET PRINT OFF
         SET PRINT TO
         SET CONSOLE ON
         IF MPRINTER3 <> 'DONOTPRINT'
            RUN &MPRINTIT3
         ENDIF
         
      CASE MACTION = 10
         **** DO LETTER OF CREDIT/PERSONAL GUARANTEE HERE
      ENDCASE
      
      
      
   CASE MACTION = 3
      SELECT E
      DO FOX_USE WITH "PO_HEAD INDEX TMP_BUY", .F.
      SEEK A->BBUYCODE
      IF .NOT. EOF()
         @ 24,0 CLEAR
         STORE ' ' TO MYES_NO
         STORE 'CANNOT DELETE THIS CUSTOMER - PO(s) ON FILE ! ' TO MWAIT
         @ 24,1 SAY MWAIT
         CLEAR GETS    
         @ 24,51 GET MYES_NO PICTURE '@!'
         READ
         @ 24,0 CLEAR
         USE
         SELECT A
      ELSE
         USE
         SELECT A
         @ 23,0 CLEAR
         STORE 'N' TO MYES_NO
         STORE 'Are You Sure You Want to DELETE this Customer (Y/N)? ' TO MWAIT
         @ 23,10 SAY MWAIT
         CLEAR GETS    
         @ 23,65 GET MYES_NO PICTURE '@!'
         READ
         IF MYES_NO = 'Y'
            DELETE
         ENDIF 
      ENDIF
      MNOT_DONE = .F.
   ENDCASE
   
ENDDO
RETURN
* EOF: BBUYEDIT.PRG


PROCEDURE BBUYVIEW 
* ---OPEN FILES

MMORE_PP = .T.
MTITLE = ' - VIEW BILL TO CUSTOMER INFORMATION' 
**** PUT UP THE SCREEN
DO TEXTBBUY
STORE name       TO mname      
STORE REG_NAME   TO MREG_NAME
STORE street     TO mstreet    
STORE city       TO mcity      
STORE state      TO mstate     
STORE zip        TO mzip       
STORE zip4       TO mzip4      
STORE cred_lim   TO mcred_lim  
STORE TERM_DAYS  TO MTERM_DAYS
STORE note       TO mnote
STORE BBUYCODE   TO MBBUYCODE
STORE AREA_CODE  TO MAREA_CODE
STORE PHONE      TO MPHONE
STORE EXTENSION  TO MEXTENSION
STORE FAX        TO MFAX
STORE FST_SALE   TO MFST_SALE
STORE BEG_DATE   TO MBEG_DATE
STORE END_DATE   TO MEND_DATE
STORE DATE_FIN   TO MDATE_FIN
STORE DATE_RVWD  TO MDATE_RVWD
STORE LET_CRD    TO MLET_CRD
STORE GUARAN     TO MGUARAN
STORE CUST_SW    TO MCUST_SW
STORE FED_CUST   TO MFED_CUST
IF MCUST_SW = SPACE(1)
   STORE 'N' TO MCUST_SW
ENDIF
STORE ACTIVE TO MACTIVE
IF MACTIVE <> 'I'
   STORE 'A' TO MACTIVE
ENDIF
STORE PO_WARN TO MPO_WARN
STORE REGION  TO MREGION
STORE INTERNAT TO MINTERNAT
STORE STREET2 TO MSTREET2
STORE ISTREET TO MISTREET
STORE ISTREET2 TO MISTREET2
STORE ICITY    TO MICITY
STORE COUNTRY TO MCOUNTRY
STORE INT_ZIP TO MINT_ZIP
STORE ILINE1  TO MILINE1
STORE ILINE2  TO MILINE2
STORE ILINE3  TO MILINE3
STORE NOTE2    TO MNOTE2
STORE CRED_RQST TO MCRED_RQST
STORE HIGH_BAL  TO MHIGH_BAL
STORE CREDAP_DT  TO MCREDAP_DT
STORE DB_DT      TO MDB_DT
IF FIN_PROV = SPACE(1)
   STORE 'N' TO MFIN_PROV
ELSE
   STORE FIN_PROV TO MFIN_PROV
ENDIF
IF CREDIT_AP = SPACE(1)
   STORE 'N' TO MCREDIT_AP
ELSE
   STORE CREDIT_AP TO MCREDIT_AP
ENDIF
IF DB_RPT = SPACE(1)
   STORE 'N' TO MDB_RPT
ELSE
   STORE DB_RPT TO MDB_RPT
ENDIF
IF LETTER_C = SPACE(1)
   STORE 'N' TO MLETTER_C
ELSE
   STORE LETTER_C TO MLETTER_C
ENDIF

MCUR_BAL = CUS_BAL
IF MPROG_CODE = 2
   IF DTOC(MFST_SALE) = '  /  /  '
      SELECT B
      DO FOX_USE WITH "CUS_INV INDEX CUS_INV, CUS_DATE, CUSIVNBR", .F.
      SEEK MBBUYCODE + 'Y'    
      IF .NOT. EOF()
         STORE SHIP_DATE TO MFST_SALE
      ELSE
         SEEK MBBUYCODE + ' '
         STORE SHIP_DATE TO MFST_SALE
      ENDIF
      USE
   ENDIF
ELSE
   SELECT D
   DO FOX_USE WITH "PO_HEAD INDEX TMP_BUY", .F.
   SEEK MBBUYCODE
   DO WHILE .NOT. EOF() .AND. BBUYCODE = MBBUYCODE
      MFST_SALE = SHIP_DATE
      SKIP
   ENDDO
   USE
ENDIF
IF MPROG_CODE = 1
   SELECT D
   DO FOX_USE WITH "PO_HEAD INDEX TMP_BUY", .F.
   SEEK MBBUYCODE
   MLAST_SALE = SHIP_DATE
   USE
ELSE
   MLAST_SALE = CTOD('')
ENDIF

SELECT A

IF SHIPS_25 <> 0 .AND. DAYS_25 <> 0
   MPREV_25DY = DAYS_25/SHIPS_25
ELSE
   MPREV_25DY = 0
ENDIF

IF SHIPS_180 <> 0 .AND. DAYS_180 <> 0
   MPREV_6MO = DAYS_180/SHIPS_180
ELSE
   MPREV_6MO = 0
ENDIF
IF MCOMPANY = 'MIDWEST FOOD -DIV 11 INVENTORY' .OR. MCOMPANY = 'AMERICHICKEN, INC'
   SELECT D
   DO FOX_USE WITH "SALESMAN INDEX SAL_CODE", .F.
   SEEK A->INCEN_CD
   IF EOF()
      IF A->NO_INCEN = 'Y' .OR. A->NO_INCEN = ' '
         STORE 'INCEN NOT ASSIGNED' + SPACE(2) TO MINCEN_NM
      ELSE
         STORE 'INCEN NOT ON FILE' + SPACE(3) TO MINCEN_NM
      ENDIF
   ELSE
      STORE SUBSTR(NAME,1,20) TO MINCEN_NM
   ENDIF
   USE
ENDIF

SELECT A
DO SAYBBUY
STORE 1 TO MACTION
@ 23,0 CLEAR
@ 23,00 SAY 'Action:  ' + STR(MACTION,1)
@ 23,12 SAY "1.Continue    2.Edit Notes     3. Edit Cust Info"
@ 23,08 GET MACTION PICTURE '99' RANGE 1,3
SET CONFIRM ON
READ
SET CONFIRM OFF

DO CASE
CASE MACTION = 2
   @ 20,09 GET MNOTE PICTURE '@!'
   @ 21,09 GET MNOTE2 PICTURE '@!'
   READ
   DO RECLOCK
   REPLACE NOTE WITH MNOTE
   REPLACE NOTE2 WITH MNOTE2
   UNLOCK

CASE MACTION = 3
   DO BBUYEDIT
ENDCASE

RETURN
* EOF: BBUYVIEW.PRG


PROCEDURE BUY_EDIT
*
* ---OPEN FILES
MTITLE = ' - VIEW/CHANGE/DELETE SHIP TO CUSTOMER INFORMATION' 
**** PUT UP THE SCREEN
STORE SPACE(10) TO MCONT_FAX
STORE SPACE(42) TO MCONT_NAME, MCONT_NAM2
STORE SPACE(10) TO MCONT_PH, MFRT_PH, MDEL_PH
STORE SPACE(35) TO MDEL_MAIL
STORE SPACE(12) TO MDEL_TIME
MMON_RECV   = SPACE(15)
MTUE_RECV   = SPACE(15)
MWED_RECV   = SPACE(15)
MTHU_RECV   = SPACE(15)
MFRI_RECV   = SPACE(15)
MSAT_RECV   = SPACE(15)
MSUN_RECV   = SPACE(15)
DO TEXTBUY
DO STORBUY 
STORE RECNO() TO MRECNO
DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYCODE, &MDBFLOC.BBUYNAME", .F.
SEEK MBBUYCODE
IF .NOT. EOF()
   STORE NAME TO MBIL_NAME
   STORE NAME TO MSV_NAME
   STORE STREET TO MBIL_STRT
   STORE CITY TO MBIL_CITY
   STORE STATE TO MBIL_STATE
   IF ZIP4 = SPACE(4)
      STORE ZIP  TO MBIL_ZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MBIL_ZIP
   ENDIF
ELSE
   STORE SPACE(32) TO MBIL_NAME
   STORE MBIL_NAME TO MSV_NAME
   STORE SPACE(28) TO MBIL_STRT
   STORE SPACE(20) TO MBIL_CITY
   STORE SPACE(2) TO MBIL_STATE
   STORE SPACE(5) TO MBIL_ZIP
ENDIF
DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME, &MDBFLOC.BUY_CODE", .F.
GOTO MRECNO
MNOT_DONE = .T.
DO WHILE MNOT_DONE
   DO GETBUY 
   @ 21,26 SAY MBIL_STRT
   @ 22,26 SAY TRIM(MBIL_CITY) + ', ' + MBIL_STATE + '  ' + MBIL_ZIP
   STORE 1 TO MACTION
   @ 24,0 CLEAR
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1.Save Updates    2.Edit Screen    3.Delete Customer   4.Cancel'
   READ
   @24,09 GET MACTION PICTURE '9' RANGE 1,4
   READ               
   DO CASE
   CASE MACTION = 4
      MNOT_DONE = .F.
      LOOP
      
   CASE MACTION = 2
      LOOP
      
   CASE MACTION = 1
      
      STORE MNAME TO MBUY_NAME
      STORE MSTREET TO MBUY_STRT
      STORE MCITY TO MBUY_CITY
      STORE MSTATE TO MBUY_STATE
      STORE MZIP TO MBUY_ZIP
      STORE MZIP4 TO MBUY_ZIP4
      STORE MNOTE TO MBUY_NOTE
      STORE MAREA_CODE TO MBUY_AREA
      STORE MPHONE TO MBUY_PHONE
      STORE MFAX   TO MBUY_FAX
      
      IF MBIL_NAME <> MSV_NAME
         
         IF MBIL_NAME <> 'SAME'
            STORE MBIL_NAME TO MNAME
         ENDIF
         SELECT A
         DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYNAME, &MDBFLOC.BBUYCODE" ,.F.
         MNAME_FD = .F.
         
         DO BBUYSEL2
         
         STORE MBUY_NAME TO MNAME
         STORE MBUY_STRT TO MSTREET
         STORE MBUY_CITY TO MCITY
         STORE MBUY_STATE TO MSTATE
         STORE MBUY_ZIP TO MZIP
         STORE MBUY_ZIP4 TO MZIP4
         STORE MBUY_NOTE TO MNOTE
         STORE MBUY_AREA TO MAREA_CODE
         STORE MBUY_PHONE TO MPHONE 
         STORE MBUY_FAX   TO MFAX   
         
         IF .NOT. MNAME_FD
            @ 24,0 CLEAR
            STORE ' ' TO MWAIT
            @ 24,1 SAY 'BILL TO MUST BE ON FILE - PLEASE HIT ANY KEY TO REENTER'
            @ 24,78  GET MWAIT
            READ
            @ 24,0 CLEAR
            DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME, &MDBFLOC.BUY_CODE" ,.F.
            GOTO MRECNO
            LOOP
         ENDIF
         
         STORE BBUYCODE TO MBBUYCODE
         
         @ 20,26 SAY NAME
         @ 21,26 SAY STREET
         IF ZIP4 = SPACE(4)
            STORE ZIP + SPACE(5) TO MZIP
         ELSE
            STORE ZIP + '-' + ZIP4 TO MZIP
         ENDIF
         @ 22,26 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
         SELECT A
         DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME, &MDBFLOC.BUY_CODE", .F.
         GOTO MRECNO
         STORE 1 TO MACTION
         @ 24,0 CLEAR
         @ 24,01 SAY 'Action: ' + STR(MACTION,1)
         @ 24,13 SAY '1. Save      2. Edit       3. Cancel'
         @24,09 GET MACTION PICTURE '9' RANGE 1,3
         READ               
         IF MACTION = 2
            LOOP
         ENDIF
         
         IF MACTION = 3
            MNOT_DONE = .F.
            LOOP
         ENDIF
      ENDIF
      
      DO REPLBUY 
      
      MNOT_DONE = .F.
      
   CASE MACTION = 3
      @ 24,0 CLEAR
      STORE 'N' TO MYES_NO
      STORE 'Are You Sure You Want to DELETE this Customer (Y/N)? ' TO MWAIT
      @ 24,10 SAY MWAIT
      CLEAR GETS    
      @ 24,65 GET MYES_NO PICTURE '@!'
      READ
      IF MYES_NO = 'Y'
         DELETE
      ENDIF 
      MNOT_DONE = .F.
   ENDCASE
   
ENDDO
RETURN

PROCEDURE MUL5BBUY
CLEAR 
@  1, 0 SAY MCOMPANY
@  1,68 SAY DATE()
@  2, 0 SAY MPROGRAM + ' - MATCH SELECT'
@ 3,0 TO 21,79
@  5, 2 SAY 'CUSTOMERS MATCHING YOUR INPUT.  PLEASE SELECT ACTION.'
@ 6,5 say 'NAME'
@ 6,42 SAY 'CITY'   
@ 6,70 SAY 'STATE'
MSEQ_NUM = 0
STORE 0 TO MSEQ_NUM, MSEQ_LST
STORE MFST_REC TO MLST_REC
GOTO MFST_REC

MMULT_BUY = .T.
DO WHILE MMULT_BUY
   
   MLINE = 7
   STORE RECNO() TO MTOP_REC
   STORE MSEQ_NUM + 1 TO MTOP_SEQ
   STORE .F. TO MORE_FLG
   DO WHILE .NOT. EOF() .AND. NAME = SRCH_ARG .AND. ACTIVE = ' ' .AND. MLINE < 20
      MSEQ_NUM = MSEQ_NUM + 1
      IF MSEQ_NUM > MSEQ_LST
         STORE MSEQ_NUM TO MSEQ_LST
         STORE RECNO() TO MLST_REC
      ENDIF
      @ MLINE, 1 SAY STR(MSEQ_NUM,2) + '.'
      @ MLINE, 5 SAY NAME
      @ MLINE,42 SAY CITY    
      @ MLINE,71 SAY STATE
      MLINE = MLINE + 1
      SKIP
   ENDDO
   
   IF .NOT. EOF() .AND. NAME = SRCH_ARG .AND. ACTIVE = ' '
      @ MLINE,59 SAY 'More...'
      MORE_FLG = .T.
   ENDIF
   
   STORE 0 TO MSEL_NUM
   @ 22,01 SAY 'Select Customer Number: '
   @ 22,25 GET MSEL_NUM PICTURE '###' RANGE 0,MSEQ_LST
   MACTION = 1
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1.Next Pg.  2.Previous Pg.  3.First Pg.  4.Add Customer  5.Cancel'
   
   READ
   
   IF MSEL_NUM <> 0
      STORE 1 TO MSEQ_NUM
      GOTO MFST_REC
      DO WHILE MSEQ_NUM <> MSEL_NUM
         SKIP
         STORE MSEQ_NUM + 1 TO MSEQ_NUM
      ENDDO     
      MMULT_BUY = .F.
      LOOP 
   ENDIF
   
   MACTION = 1
   @ 24,01 SAY 'Action: '
   @ 24,13 SAY '1.Next Pg.  2.Previous Pg.  3.First Pg.  4.Add Customer  5.Cancel'
   @ 24,09 GET MACTION PICTURE '9' RANGE 1,5
   READ               
   
   DO CASE
      
   CASE MACTION = 1
      @ 07,01 CLEAR TO 20,78
      IF .NOT. MORE_FLG
         GOTO MTOP_REC
         STORE MTOP_SEQ - 1 TO MSEQ_NUM
      ENDIF
      LOOP
      
   CASE MACTION = 2
      @ 07,01 CLEAR TO 20,78
      GOTO MTOP_REC
      STORE MTOP_SEQ - 1 TO MSEQ_NUM
      IF MSEQ_NUM <> 0
         SKIP -13
         STORE MSEQ_NUM - 13 TO MSEQ_NUM
      ENDIF
      LOOP
      
   CASE MACTION = 3
      @ 07,01 CLEAR TO 20,78
      STORE 0 TO MSEQ_NUM
      GOTO MFST_REC
      LOOP
   CASE MACTION = 4
      MINIT_NM = .F.
      DO BBUY_ADD
      MMULT_BUY = .F.
      
   CASE MACTION = 5
      MMULT_BUY = .F.
      
   ENDCASE
   
ENDDO

RETURN

PROCEDURE CUSTINQ

SELECT A
DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYNAME, &MDBFLOC.BBUYCODE", .F.
STORE SPACE(32)    TO MNAME 
MNAME_FD = .F.
STORE 1 TO MACTION
MBUY_SEL = .T.
DO WHILE MBUY_SEL
   
   CLEAR 
   @  1, 0 SAY MCOMPANY
   @  1,68 SAY DATE()
   MTITLE = ' - SELECT BILL TO CUSTOMER'
   @  2, 0 SAY MPROGRAM + MTITLE
   @ 3,0 TO 22,79
   @  5, 5 SAY 'Enter Search Field:'
   @  8, 5 SAY 'Name'
   @ 10, 5 GET Mname PICTURE '@!'
   
   STORE 1 TO MACTION
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)  
   @ 24,13 SAY '1. View/Update     2. Print      3. Edit      4. Finished'                                     
   
   READ
   
   @24,09 GET MACTION PICTURE '9' RANGE 1,4
   READ               
   
   DO CASE
      
   CASE MACTION = 1 .OR. MACTION = 2
      
      IF MNAME <> SPACE(32)
         STORE TRIM(MNAME) TO SRCH_ARG
         SEEK SRCH_ARG
         IF EOF() .OR. DELETED()
            @ 23,0 CLEAR
            STORE 'Y' TO MYES_NO
            @ 24,05 SAY 'NAME NOT FOUND - DO YOU WANT TO ADD (Y/N)? ' get MYES_NO PICTURE '@!'
            READ
            IF MYES_NO = 'Y'
               MINIT_NM = .F.
               DO BBUY_ADD
               STORE SPACE(32) TO MNAME
            ELSE 
               STORE SPACE(32) TO MNAME
            ENDIF
            LOOP
         ELSE               
            STORE RECNO() TO MFST_REC
            SKIP
            IF NAME = SRCH_ARG
               MADD = .F.
               DO MUL1BBUY 
               IF MACTION = 5
                  LOOP
               ENDIF
               IF MADD
                  MNAME = SPACE(32)
                  LOOP
               ENDIF
            ELSE
               GOTO MFST_REC
            ENDIF
            IF MACTION = 1
               DO BBUYEDIT
            ELSE
               ** DO BBUYPRT
            ENDIF
            MNAME = SPACE(32)
            LOOP
         ENDIF
      ELSE      
         MBUY_SEL = .F.
         LOOP
      ENDIF
   CASE MACTION = 3
      LOOP
      
   CASE MACTION = 4
      MBUY_SEL = .F.
      
   ENDCASE
   
ENDDO

RETURN


PROCEDURE BUY_SEL1

SELECT A
DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME", .F.
STORE SPACE(32)    TO MNAME 
MNAME_FD = .F.
STORE 1 TO MACTION
MBUY_SEL = .T.
DO WHILE MBUY_SEL
   CLEAR 
   @  1, 0 SAY MCOMPANY
   @  1,68 SAY DATE()
   MTITLE = ' - SELECT SHIP TO CUSTOMER'
   @  2, 0 SAY MPROGRAM + MTITLE
   @ 3,0 TO 22,79
   @  5, 5 SAY 'Enter Customer Search Field:'
   @  8, 5 SAY 'Name'
   @ 10, 5 GET Mname PICTURE '@!'
   
   STORE 1 TO MACTION
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)  
   @ 24,13 SAY '1. Continue    2. Edit     3. Finished'                                     
   
   READ
   
   @24,09 GET MACTION PICTURE '9' RANGE 1,3
   READ               
   
   DO CASE
      
   CASE MACTION = 1
      IF MNAME <> SPACE(32)
         STORE TRIM(MNAME) TO SRCH_ARG
         SEEK SRCH_ARG
         IF EOF() .OR. DELETED()
            @ 24,0 CLEAR
            STORE ' ' TO MYES_NO
            @ 24,05 SAY 'NAME NOT FOUND - PRESS RETURN TO REENTER ' get MYES_NO PICTURE '@!'
            READ
            @ 24,0 CLEAR     
            LOOP
         ELSE               
            STORE RECNO() TO MFST_REC
            SKIP
            IF NAME = SRCH_ARG
               MADD = .F.
               DO MUL1BUY
               IF MACTION <> 5
                  MNAME_FD = .T.
               ENDIF
            ELSE
               GOTO MFST_REC
               MNAME_FD = .T.
            ENDIF
         ENDIF
      ENDIF
      
      MBUY_SEL = .F.
      
   CASE MACTION = 3
      MBUY_SEL = .F.
      
   ENDCASE
   
ENDDO

RETURN
* EOF: BUY_SEL1.PRG

* EOF: BUY_PROC.PRG

*Formatted by: ToolBox Ver. 1.2  on 12/8/15 at 1:11 PM.
