**********
* Program.: USERHLP.PRG
* Author..: Grace Keller
* Date....: 04/19/88
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: DISPLAY PURCHASE ORDER NOTES
*
PARAMETERS MPRG

SAVE SCREEN TO MGRACE
STORE SUBSTR(MPRG,13) TO MPRG
CLEAR
@ 0,0 CLEAR TO 25,80
IF MSALESMAN <> SPACE(2)
   STORE MSALESMAN + '-' + MPO_NBR TO MSAY
ELSE
   STORE MPO_NBR TO MSAY
ENDIF
IF MPO_SUFFIX <> ' '
   STORE MSAY + '-' + MPO_SUFFIX TO MSAY
ENDIF
@ 0,01 SAY 'PO: ' + MSAY + '    NOTES / PAYMENT INFO'
RELEASE MSAY
@ 1,0 TO 24,80

MDO_HELP = .F.
DO CASE 
CASE MPRG = 'PO_ADD' .OR. MPRG = 'NEXT_PG' .OR. MPRG = 'MISC_ADD' .OR. MPRG = 'NEW_FRT' .OR. MPRG = 'FRT_SEL2'
   MDO_HELP = .T.
** TOO MANY MEMORY VARIABLES ON AND EDIT
**CASE MPRG = 'PO_EDIT' .OR. MPRG = 'ITEM_CHG' .OR. MPRG = 'EDIT_PG' .OR. MPRG = 'MISC_CHG' .OR. MPRG = 'FRT_EDIT' .OR. MPRG = 'FRT_CHG'
**   MDO_HELP = .T.
CASE MPRG = 'PO_VIEW' .OR. MPRG = 'PG_VIEW' .OR. MPRG = 'MISCVIEW' .OR. MPRG = 'FRT_VIEW' .OR. MPRG = 'FRT_VW'
   MDO_HELP = .T.
ENDCASE

IF .NOT. MDO_HELP
   @ 12,5 SAY 'No Notes Available from this Program - Contact Grace'
   @ 14,5 SAY 'Press Any Key to Return to Screen '
   wait ' '
   RESTORE SCREEN FROM MGRACE
   RETURN
ENDIF
STORE 0 TO VSUPAMT1, VSUPAMT2, VSUPAMT3
STORE 0 TO VCUSAMT1, VCUSAMT2, VCUSAMT3
STORE 0 TO VFRTAMT1, VFRTAMT2, VFRTAMT3
STORE 0 TO VSUPTOT, VCUSRECV, VCUSCRED, VCUSMISC, VFRTTOT 
STORE SPACE(12) TO VSUPINV1, VSUPINV2, VSUPINV3
STORE SPACE(12) TO VCUSINV1, VCUSINV2, VCUSINV3
STORE SPACE(12) TO VFRTINV1, VFRTINV2, VFRTINV3
STORE CTOD(' ') TO VSUPDT1, VSUPDT2, VSUPDT3
STORE CTOD(' ') TO VCUSDT1, VCUSDT2, VCUSDT3
STORE CTOD(' ') TO VFRTDT1, VFRTDT2, VFRTDT3
STORE SPACE(7) TO VCUSCK1, VCUSCK2, VCUSCK3
STORE SPACE(7) TO VSUPCK1, VSUPCK2, VSUPCK3
STORE SPACE(7) TO VFRTCK1, VFRTCK2, VFRTCK3
STORE 1 TO MSUPI, MCUSI, MFRTI
SELECT G
DO FOX_USE WITH "DISBJRN INDEX DISB_PO", .F.
SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
DO WHILE .NOT. EOF() .AND. SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX
   DO CASE
   CASE ACCT_TYPE = 'S'
      IF VOID_MAN <> 'V'
         IF MSUPI <= 3
            STORE STR(MSUPI,1) TO MI
            STORE AMOUNT1 TO VSUPAMT&MI
            STORE BILL_INV TO VSUPINV&MI
            STORE JRNL_MO + '/' + JRNL_DAY + '/' + JRNL_YR TO MDATE
            STORE CTOD(MDATE) TO MDATE
            STORE MDATE TO VSUPDT&MI
            STORE CK_NBR TO VSUPCK&MI
            MSUPI = MSUPI + 1
         ENDIF
         VSUPTOT = VSUPTOT + AMOUNT1
      ENDIF
   CASE ACCT_TYPE = 'F'
      IF VOID_MAN <> 'V'
         IF MFRTI <= 3
            STORE STR(MFRTI,1) TO MI
            STORE AMOUNT1 TO VFRTAMT&MI
            STORE BILL_INV TO VFRTINV&MI
            STORE JRNL_MO + '/' + JRNL_DAY + '/' + JRNL_YR TO MDATE
            STORE CTOD(MDATE) TO MDATE
            STORE MDATE TO VFRTDT&MI
            STORE CK_NBR TO VFRTCK&MI
            MFRTI = MFRTI + 1
         ENDIF
         VFRTTOT = VFRTTOT + AMOUNT1
      ENDIF
   ENDCASE
   SKIP
ENDDO
DO FOX_USE WITH "PAYMENTS INDEX PAY_PO", .F.
SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
DO WHILE .NOT. EOF() .AND. SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR  .AND. PO_SUFFIX = MPO_SUFFIX
   IF MCUSI <= 3
      STORE STR(MCUSI,1) TO MI
      STORE AMT_PAID + AMT_OVER + CRED_AMT TO VCUSAMT&MI
      STORE INV_NBR TO VCUSINV&MI
      STORE PAID_DATE TO VCUSDT&MI
      STORE CK_NBR TO VCUSCK&MI
      MCUSI = MCUSI + 1
   ENDIF
   VCUSRECV = VCUSRECV + AMT_PAID
   VCUSCRED = VCUSCRED + CRED_AMT
   VCUSMISC = VCUSMISC + AMT_OVER
   SKIP
ENDDO
USE
SELECT F
DO FOX_USE WITH "NOTES INDEX NOTES", .F.
SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX 
IF EOF()
   @ 04,1 SAY 'No Notes on file for this Purchase Order'
ELSE 
   MI = 2
   DO WHILE .NOT. EOF() .AND. SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX
      @ MI,1 SAY NOTE
      MI = MI + 1
      SKIP
   ENDDO
ENDIF
USE
SELECT B
@ 08,1 TO 08,78
@ 8,4 SAY 'Invoice Nbr'  
@ 8,20 say 'Paid Date'
@ 8,32 say 'Paid Amount'
@ 09,1 SAY 'SUPPLIER'
@ 09,44 SAY 'Due:'
@ 9,49 SAY TOT_PURCH + BILL_ADJ + SUP_PALL PICTURE '999,999.99'
@ 09,63 SAY 'Paid:'
@ 9,69 SAY VSUPTOT PICTURE '999,999.99'
@ 10,1 SAY '1.'
@ 10,4 SAY VSUPINV1
@ 10,20 SAY VSUPDT1
@ 10,33 SAY VSUPAMT1 PICTURE '@Z 999,999.99'
IF VSUPAMT1 <> 0
   @ 10,48 SAY 'CK#: ' + VSUPCK1
ENDIF
@ 11,1 SAY '2.'
@ 11,4 SAY VSUPINV2
@ 11,20 SAY VSUPDT2
@ 11,33 SAY VSUPAMT2 PICTURE '@Z 999,999.99'
IF VSUPAMT2 <> 0
   @ 11,48 SAY 'CK# ' + VSUPCK2
ENDIF
@ 12,1 SAY '3.'
@ 12,4 SAY VSUPINV3
@ 12,20 SAY VSUPDT3
@ 12,33 SAY VSUPAMT3 PICTURE '@Z 999,999.99'
IF VSUPAMT3 <> 0
   @ 12,48 SAY 'CK# ' + VSUPCK3
ENDIF
@ 13,1 TO 13,78
@ 14,1 SAY 'CUSTOMER Due:'
@ 14,15 SAY TOT_SELL + CUS_PALL PICTURE '@B 999999.99'
@ 14,27 SAY 'Paid:'
@ 14,33 SAY VCUSRECV + VCUSCRED + VCUSMISC PICTURE '@B 999999.99'
@ 14,44 SAY 'A/R:'
@ 14,49 SAY VCUSRECV PICTURE '@B 999999.99'
@ 14,60 SAY 'Misc/Crd:'
@ 14,70 say VCUSCRED+VCUSMISC PICTURE '@B 999999.99'
@ 15,1 SAY '1.'
@ 15,4 SAY VCUSINV1
@ 15,20 SAY VCUSDT1
@ 15,33 SAY VCUSAMT1 PICTURE '@Z 999,999.99'
IF VCUSAMT1 <> 0
   @ 15,48 SAY 'CK# ' + VCUSCK1
ENDIF
@ 16,1 SAY '2.'
@ 16,4 SAY VCUSINV2
@ 16,20 SAY VCUSDT2
@ 16,33 SAY VCUSAMT2 PICTURE '@Z 999,999.99'
IF VCUSAMT2 <> 0
   @ 16,48 SAY 'CK# ' + VCUSCK2
ENDIF
@ 17,1 SAY '3.'
@ 17,4 SAY VCUSINV3
@ 17,20 SAY VCUSDT3
@ 17,33 SAY VCUSAMT3 PICTURE '@Z 999,999.99'
IF VCUSAMT3 <> 0
   @ 17,48 SAY 'CK# ' + VCUSCK3
ENDIF
@ 18,1 TO 18,78
@ 19,1 SAY 'FREIGHT'
@ 19,44 SAY 'Due:'
MTFRT = FRT_AMT1 + FRT_PALL + FRT1_ADJ1 + FRT1_ADJ2 
IF MPROG_CODE = 2
   SELECT G
   DO FOX_USE WITH "FRT_2ND INDEX FRT2_PO", .F.
   SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
   IF .NOT. EOF()
      MTFRT = MTFRT + FRT_AMT2
   ENDIF
   USE
   SELECT G
   DO FOX_USE WITH "FRT_3RD INDEX FRT3_PO", .F.
   SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
   IF .NOT. EOF()
      MTFRT = MTFRT + FRT_AMT3
   ENDIF
   USE
   SELECT B
ENDIF
@ 19,49 SAY MTFRT PICTURE '999,999.99'

@ 19,63 SAY 'Paid:'
@ 19,69 SAY VFRTTOT PICTURE '999,999.99'
@ 20,1 SAY '1.'   
@ 20,4 SAY VFRTINV1
@ 20,20 SAY VFRTDT1
@ 20,33 SAY VFRTAMT1 PICTURE '@Z 999,999.99'
IF VFRTAMT1 <> 0
   @ 20,48 SAY 'CK# ' + VFRTCK1
ENDIF
@ 21,1 SAY '2.'
@ 21,4 SAY VFRTINV2
@ 21,20 SAY VFRTDT2
@ 21,33 SAY VFRTAMT2 PICTURE '@Z 999,999.99'
IF VFRTAMT2 <> 0
   @ 21,48 SAY 'CK# ' + VFRTCK2
ENDIF
@ 22,1 SAY '3.'
@ 22,4 SAY VFRTINV3
@ 22,20 SAY VFRTDT3
@ 22,33 SAY VFRTAMT3 PICTURE '@Z 999,999.99'
IF VFRTAMT3 <> 0
   @ 22,48 SAY 'CK# ' + VFRTCK3
ENDIF
STORE 'Press Any Key to Return to PO Screen.....'  TO MWAIT
@ 25,1 GET MWAIT
READ
RESTORE SCREEN FROM MGRACE
RETURN
* EOF: USERHLP.PRG
*Formatted by: ToolBox Ver. 1.2  on 2/1/97 at 5:20 AM.
