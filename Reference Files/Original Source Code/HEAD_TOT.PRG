**********
* Program.: HEAD_TOT.PRG
* Author..: Grace Keller
* Date....: 10/21/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: RECALCULATE HEADER TOTALS
*
* ---OPEN FILES
STORE 0 TO MTOT_SELL, MTOT_PURCH, MTOT_LBS, MTOT_QTY
STORE 0 TO MSW_LBS, MSW_PURCH, MSW_SELL, MTOT, MTOT_BILL, MBILL_ADJ
SELECT C
SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
DO WHILE MSALESMAN = SALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX  .AND. .NOT. EOF()
   MTOT_SELL = MTOT_SELL + TOT_SELL
   MTOT_PURCH = MTOT_PURCH + TOT_PURCH
   MTOT_LBS = MTOT_LBS + CALC_LBS
   MTOT_QTY = MTOT_QTY + QTY
   *IF MCOMPANY = 'DIVISION 15'
   *   IF LBS_CALC <> 0
   *      MTOT_LBS = MTOT_LBS + LBS_CALC
   *   ELSE
   *      MTOT_LBS = MTOT_LBS + LBS
   *   ENDIF
   *ELSE
   *   IF MCOMPANY = 'MIDWEST FOOD -DIV 11' .OR. MCOMPANY = 'AMERICHICKEN, INC'
   *      MTOT_LBS = MTOT_LBS + QTY
   *   ELSE
   *      MTOT_LBS = MTOT_LBS + LBS
   *   ENDIF
   *ENDIF

   MSW_LBS = MSW_LBS + SHRT_LBS
   MSW_PURCH = MSW_PURCH + ROUND((PUR_PRICE * SHRT_LBS),2)
   MSW_SELL = MSW_SELL + ROUND((SEL_PRICE * SHRT_LBS),2)
   MTOT = MTOT + TOT_PURCH
   IF TOT_BILL <> 0
      MTOT_BILL = MTOT_BILL + TOT_BILL
   ELSE
      MTOT_BILL = MTOT_BILL + TOT_PURCH
   ENDIF
   SKIP
ENDDO
SELECT B
MTOT_SELL = MTOT_SELL + CUS_AMT1 + CUS_AMT2 + WRITEOFF
MTOT_PURCH = MTOT_PURCH + SUP_AMT1 + SUP_AMT2
MBILL_ADJ =  MTOT_BILL - MTOT
DO RECLOCK
REPLACE BILL_ADJ WITH MBILL_ADJ
REPLACE SW_LBS WITH MSW_LBS
REPLACE SW_PURCH WITH MSW_PURCH
REPLACE SW_SELL WITH MSW_SELL
UNLOCK
RETURN
* EOF: HEAD_TOT.PRG
*Formatted by: ToolBox Ver. 1.2  on 12/12/96 at 7:34 PM.
