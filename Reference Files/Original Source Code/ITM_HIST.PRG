**********
* Program.: ITM_HIST.PRG
* Author..: Grace Keller
* Date....: 11/03/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: DISPLAY ITEM HISTORY
*

MTITLE = ' - DISPLAY ITEM HISTORY'
CLEAR 
@  1, 0 SAY MCOMPANY
@  1,68 SAY DATE()
@  2, 0 SAY MPROGRAM + MTITLE
DO TEXT4TH
SELECT D
SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX + MITEM(MNBR_ITM)
IF EOF()
   @ 11,5 SAY 'THERE IS NO HISTORY ON FILE FOR THIS ITEM'
   @ 12,5 SAY 'PRESS ANY KEY TO CONTINUE'
   WAIT ' '
   STORE SPACE(1) TO MHIST(MSAVE_ITM)
   RETURN
ENDIF
DO WHILE SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX .AND. ITEM_NBR = MITEM(MNBR_ITM) .AND. .NOT. EOF()
   STORE RECNO() TO MHIST_REC
   SKIP
ENDDO
GOTO MHIST_REC
SELECT C 
DO HISTITM
MLINE = 8
SELECT D
@ MLINE,1 SAY 'DATE:'
@ MLINE,7 SAY HIST_DATE
@ MLINE,17 SAY 'REASON:'
@ MLINE,25 SAY REAS_CODE
@ MLINE,38 SAY 'DESC:'
@ MLINE,44 SAY REAS_DESC
MLINE = MLINE + 1
DO SAYITM
MLINE = MLINE + 2
MFIRST_TM = .T.
MNOT_FIN = .T.
DO WHILE SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX .AND. ITEM_NBR = MITEM(MNBR_ITM) .AND. .NOT. EOF() .AND. MNOT_FIN
   IF MFIRST_TM  
      MFIRST_TM = .F.
   ELSE
      MLINE = 8
      @ 8,0 CLEAR
   ENDIF
   
   DO WHILE .NOT. EOF() .AND. MLINE <= 22 .AND. MNOT_FIN
      DO HISTITM          
      SKIP -1
      IF SALESMAN <> MSALESMAN .OR. PO_NBR <> MPO_NBR .OR. PO_SUFFIX <> MPO_SUFFIX .OR. ITEM_NBR <> MITEM(MNBR_ITM)
         @ MLINE,1 SAY 'ORIGINAL ITEM ENTRY'
         MNOT_FIN = .F.
      ELSE
         @ MLINE,1 SAY 'DATE:'
         @ MLINE,7 SAY HIST_DATE
         @ MLINE,17 SAY 'REASON:'
         @ MLINE,25 SAY REAS_CODE
         @ MLINE,38 SAY 'DESC:'
         @ MLINE,44 SAY REAS_DESC
      ENDIF
      MLINE = MLINE + 1
      DO SAYITM    
      MLINE = MLINE + 2
      
   ENDDO
   STORE 1 TO MACTION
   @ 25,0 SAY 'Action: ' + STR(MACTION,1)
   @ 25,12 SAY '1. Continue '
   @ 25,8 GET MACTION PICTURE '#' RANGE 1,1
   READ
   
ENDDO
@ 25,0 SAY SPACE(80)
STORE 'H' TO MHIST(MSAVE_ITM)
RETURN
* EOF: ITM_HIST.PRG
*Formatted by: dANALYST Ver. 7.4  on December 15, 1987 at 3:54 PM.
