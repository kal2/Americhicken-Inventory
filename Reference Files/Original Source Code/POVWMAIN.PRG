*************
* Program.: POVWMAIN.PRG
* Author..: Grace Keller
* Date....: 04/27/88
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: PURCHASE ORDER VIEW MAIN CONTROLLING PROGRAM
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
IF .NOT. MVIEW
   STORE DATE() TO MDATE
   STORE TIME() TO MTIME
   SET PROC TO PO_PROC
   SELECT B
   DO STORHEAD
   STORE SUP_CODE TO MSUP_CODE
   STORE BUY_CODE TO MBUY_CODE
   STORE RSUPCODE TO MRSUPCODE, SRSUPCODE
   STORE BBUYCODE TO MBBUYCODE, SBBUYCODE
   STORE SALESMAN TO MSALESMAN, SSALESMAN
   STORE FRT_CODE1 TO SFRT_CODE1
   STORE COM_CODE TO SCOM_CODE
   STORE COM_CODE2 TO SCOM_CODE2
   STORE COM_CODE3 TO SCOM_CODE3
   STORE SAL_CODE2 TO SSAL_CODE2
   STORE SAL_CODE3 TO SSAL_CODE3
   STORE INV_NBR TO MINV_NBR
   **RON MONTGOMERY CHANGES
   DO 8910_TOT
   DO HEAD_TOT
   DO SAVE_TOT
   STORE MTOT_SELL TO MSAV_SELL
   STORE MTOT_PURCH TO MSAV_PURCH
   STORE MTOT_LBS TO MSAV_LBS
ENDIF

IF .NOT. MVIEW .AND. B->FRT2_FLG <> ' '
   SELECT A
   DO FOX_USE WITH "FRT_2ND INDEX FRT2_PO, FRT2_FRT", .F.
   SEEK B->SALESMAN + B->PO_NBR + B->PO_SUFFIX       
   SFRT_CODE2 = FRT_CODE2
   SFRT_AMT2 =  FRT_AMT2
   USE
   SELECT B
ELSE
   SFRT_CODE2 = SPACE(4)
   SFRT_AMT2  = 0
ENDIF

IF .NOT. MVIEW .AND. B->FRT3_FLG <> ' '
   SELECT A
   DO FOX_USE WITH "FRT_3RD INDEX FRT3_PO, FRT3_FRT", .F.
   SEEK B->SALESMAN + B->PO_NBR + B->PO_SUFFIX       
   SFRT_CODE3 = FRT_CODE3
   SFRT_AMT3 =  FRT_AMT3
   USE
   SELECT B
ELSE
   SFRT_CODE3 = SPACE(4)
   SFRT_AMT3  = 0
ENDIF

STORE SPACE(9) TO MREF_PO3, MREF_PO4, MREF_PO5, MREF_PO6
IF .NOT. MVIEW
   *** IF DIVISION 11 - AND FEDERATED FOODS CUSTOMER
   *** SAVE OFF TEMP RECORD -BEGINNING OF ITEMS FOR FEDERATED FOODS
   IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      SELECT A
      DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYCODE", .F.
      SEEK B->BBUYCODE
      IF FED_CUST = 'Y'
         USE
         DO WRITTEMP
      ENDIF
      SELECT A
      USE
   ENDIF
ENDIF
STORE 1 TO MGOTO_PG
DO WHILE MGOTO_PG > 0 .AND. MGOTO_PG < 6
   IF MVIEW
      DO CASE
      CASE MGOTO_PG = 1
         RELEASE MQTY
         RELEASE MFR_FZ
         RELEASE MGRADE
         RELEASE MPAK  
         RELEASE MCLASS
         RELEASE MPROD
         RELEASE MSIZE
         RELEASE MPACKSPEC
         RELEASE MLBS
         RELEASE MPURC_PRI
         RELEASE MSELL_PRI
         RELEASE MPURC_TOT
         RELEASE MSELL_TOT
         RELEASE MSHRT_BOX
         RELEASE MSHRT_LBS
         RELEASE MBILL_PRI
         RELEASE MPAK1  
         RELEASE MPAK2  
         RELEASE MBOX_SZ
         RELEASE MOLD_LOT
         RELEASE MOLD_LBS
         RELEASE MOLD_QTY
         RELEASE MOLD_PROD
         RELEASE MIN_LOT
         RELEASE MOUT_LOT
         RELEASE MOLD_IN
         RELEASE MOLD_OUT
         RELEASE MSTOR_ITEM
         RELEASE MFLAG
         RELEASE MPAK_YR
         RELEASE MPAK_DAY
         RELEASE Mout_YR
         RELEASE Mout_DAY
         DO PO_VIEW
         DIMENSION MQTY(7)
         DIMENSION MFR_FZ(7)
         DIMENSION MGRADE(7)
         DIMENSION MPAK(7)  
         DIMENSION MCLASS(7)
         DIMENSION MPROD(7)
         DIMENSION MSIZE(7)
         DIMENSION MPACKSPEC(7)
         DIMENSION MLBS(7)
         DIMENSION MPURC_PRI(7)
         DIMENSION MSELL_PRI(7)
         DIMENSION MPURC_TOT(7)
         DIMENSION MSELL_TOT(7)
         DIMENSION MSHRT_BOX(7)
         DIMENSION MSHRT_LBS(7)
         DIMENSION MBILL_PRI(7)
         DIMENSION MFLAG(7)
         DIMENSION MPAK1(7)  
         DIMENSION MPAK2(7)  
         DIMENSION MBOX_SZ(7)
         DIMENSION MOLD_LOT(7)
         DIMENSION MOLD_LBS(7)
         DIMENSION MOLD_QTY(7)
         DIMENSION MOLD_PROD(7)
         DIMENSION MIN_LOT(7)
         DIMENSION MOUT_LOT(7)
         DIMENSION MOLD_IN(7)
         DIMENSION MOLD_OUT(7)
         DIMENSION MSTOR_ITEM(7)
         DIMENSION MPAK_YR(7)
         DIMENSION MPAK_DAY(7)
         DIMENSION Mout_YR(7)
         DIMENSION Mout_DAY(7)

      CASE MGOTO_PG = 2
         IF MCOMPANY = 'DIVISION 15' .OR. MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
            *IF B->BROKERAGE = 'H'
            ** ORDERS ON HOLD
            *   SET PROC TO  PO_PROC
            *   DO PG_VIEW
            *ELSE
            *** LOT NUMBER STUFF
            SET PROC TO I_PROC
            DO PG_VIEW
            SET PROC TO PO_PROC
            *ENDIF
            
            RELEASE MQTY
            RELEASE MFR_FZ
            RELEASE MGRADE
            RELEASE MPAK  
            RELEASE MCLASS
            RELEASE MPROD
            RELEASE MSIZE
            RELEASE MPACKSPEC
            RELEASE MLBS
            RELEASE MPURC_PRI
            RELEASE MSELL_PRI
            RELEASE MPURC_TOT
            RELEASE MSELL_TOT
            RELEASE MSHRT_BOX
            RELEASE MSHRT_LBS
            RELEASE MBILL_PRI
            RELEASE MPAK1  
            RELEASE MPAK2  
            RELEASE MBOX_SZ
            RELEASE MOLD_LOT
            RELEASE MOLD_LBS
            RELEASE MOLD_QTY
            RELEASE MOLD_PROD
            RELEASE MIN_LOT
            RELEASE MOUT_LOT
            RELEASE MOLD_IN
            RELEASE MOLD_OUT
            RELEASE MSTOR_ITEM
            RELEASE MFLAG
            RELEASE MPAK_YR
            RELEASE MPAK_DAY
            RELEASE Mout_YR
            RELEASE Mout_DAY

            MPO_ADD = .F.
            DO COM_PG
            
            DIMENSION MQTY(7)
            DIMENSION MFR_FZ(7)
            DIMENSION MGRADE(7)
            DIMENSION MPAK(7)  
            DIMENSION MCLASS(7)
            DIMENSION MPROD(7)
            DIMENSION MSIZE(7)
            DIMENSION MPACKSPEC(7)
            DIMENSION MLBS(7)
            DIMENSION MPURC_PRI(7)
            DIMENSION MSELL_PRI(7)
            DIMENSION MPURC_TOT(7)
            DIMENSION MSELL_TOT(7)
            DIMENSION MSHRT_BOX(7)
            DIMENSION MSHRT_LBS(7)
            DIMENSION MBILL_PRI(7)
            DIMENSION MFLAG(7)
            DIMENSION MPAK1(7)  
            DIMENSION MPAK2(7)  
            DIMENSION MBOX_SZ(7)
            DIMENSION MOLD_LOT(7)
            DIMENSION MOLD_LBS(7)
            DIMENSION MOLD_QTY(7)
            DIMENSION MOLD_PROD(7)
            DIMENSION MIN_LOT(7)
            DIMENSION MOUT_LOT(7)
            DIMENSION MOLD_IN(7)
            DIMENSION MOLD_OUT(7)
            DIMENSION MSTOR_ITEM(7)
            DIMENSION MPAK_YR(7)
            DIMENSION MPAK_DAY(7)
            DIMENSION Mout_YR(7)
            DIMENSION Mout_DAY(7)
         ELSE
            SET PROC TO PO_PROC
            DO PG_VIEW
         ENDIF
         SET PROC TO PO_PROC
      CASE MGOTO_PG = 3
         DO MISCVIEW
      CASE MGOTO_PG = 4
         DO FRT_VW
      CASE MGOTO_PG = 5
         DO FRT_VIEW
      ENDCASE
   ELSE
      DO CASE
      CASE MGOTO_PG = 1
         DO PO_EDIT
      CASE MGOTO_PG = 2
            DO ITEM_CHG
            RELEASE MQTY
            RELEASE MFR_FZ
            RELEASE MGRADE
            RELEASE MPAK  
            RELEASE MCLASS
            RELEASE MPROD
            RELEASE MSIZE
            RELEASE MPACKSPEC
            RELEASE MLBS
            RELEASE MPURC_PRI
            RELEASE MSELL_PRI
            RELEASE MPURC_TOT
            RELEASE MSELL_TOT
            RELEASE MSHRT_BOX
            RELEASE MSHRT_LBS
            RELEASE MBILL_PRI
            RELEASE MPAK1  
            RELEASE MPAK2  
            RELEASE MBOX_SZ
            RELEASE MOLD_LOT
            RELEASE MOLD_LBS
            RELEASE MOLD_QTY
            RELEASE MOLD_PROD
            RELEASE MIN_LOT
            RELEASE MOUT_LOT
            RELEASE MOLD_IN
            RELEASE MOLD_OUT
            RELEASE MSTOR_ITEM
            RELEASE MFLAG
            RELEASE MPAK_YR
            RELEASE MPAK_DAY
            RELEASE Mout_YR
            RELEASE Mout_DAY

            STORE SPACE(25) TO MCOM_NAME, MCOM_NAME2, MCOM_NAME3
            STORE SPACE(2)  TO  MCOM_CODE, MCOM_CODE2, MCOM_CODE3
            MPO_ADD = .F.
            DO COM_PG
            
            DIMENSION MQTY(7)
            DIMENSION MFR_FZ(7)
            DIMENSION MGRADE(7)
            DIMENSION MPAK(7)  
            DIMENSION MCLASS(7)
            DIMENSION MPROD(7)
            DIMENSION MSIZE(7)
            DIMENSION MPACKSPEC(7)
            DIMENSION MLBS(7)
            DIMENSION MPURC_PRI(7)
            DIMENSION MSELL_PRI(7)
            DIMENSION MPURC_TOT(7)
            DIMENSION MSELL_TOT(7)
            DIMENSION MSHRT_BOX(7)
            DIMENSION MSHRT_LBS(7)
            DIMENSION MBILL_PRI(7)
            DIMENSION MFLAG(7)
            DIMENSION MPAK1(7)
            DIMENSION MPAK2(7)  
            DIMENSION MBOX_SZ(7)
            DIMENSION MOLD_LOT(7)
            DIMENSION MOLD_LBS(7)
            DIMENSION MOLD_QTY(7)
            DIMENSION MOLD_PROD(7)
            DIMENSION MIN_LOT(7)
            DIMENSION MOUT_LOT(7)
            DIMENSION MOLD_IN(7)
            DIMENSION MOLD_OUT(7)
            DIMENSION MSTOR_ITEM(7)
            DIMENSION MPAK_YR(7)
            DIMENSION MPAK_DAY(7)
            DIMENSION Mout_YR(7)
            DIMENSION Mout_DAY(7)
         
      CASE MGOTO_PG = 3
         DO MISC_CHG
      CASE MGOTO_PG = 4
         DO FRT_CHG
      CASE MGOTO_PG = 5
         DO FRT_EDIT
      ENDCASE
      
   ENDIF
ENDDO
*** DELETE TEMPORARY RECORD
IF .NOT. MVIEW
   IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      DO DELTEMP
   ENDIF
ENDIF

RETURN
* EOF: POVWMAIN.PRG
*Formatted by: ToolBox Ver. 1.2  on 1/10/3 at 3:28 PM.
