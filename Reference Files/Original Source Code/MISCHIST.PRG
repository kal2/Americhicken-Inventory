**********
* Program.: MISCHIST.PRG
* Author..: Grace Keller
* Date....: 10/29/93
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: MISCELLANEOUS ADJUSTMENTS HISTORY VIEW         
*
* ---OPEN FILES
MTITLE =  ' - VIEW ADJUSTMENT HISTORY'    
SELECT F 
DO FOX_USE WITH "HIST_PG INDEX HIST_PG", .F.
SEEK B->SALESMAN + B->PO_NBR + B->PO_SUFFIX
IF EOF()
   MCONT = ' '
   @ 23,1 SAY SPACE(78)
   @ 23,1 SAY 'NO HISTORY ON FILE  - PRESS RETURN TO CONTINUE ' GET MCONT
   READ
   @ 23,1 SAY SPACE(78)
   USE
   RETURN
ENDIF

DO WHILE .NOT. EOF() .AND. SALESMAN = B->SALESMAN .AND. PO_NBR = B->PO_NBR .AND. PO_SUFFIX = B->PO_SUFFIX
   MRECNO = RECNO()
   SKIP
ENDDO

GOTO MRECNO

DO TEXTMISC
MPREVIOUS = .T.
DO WHILE MPREVIOUS
   
   STORE SUP_REAS1 TO MSUP_REAS1
   STORE SUP_REAS2 TO MSUP_REAS2
   STORE CUS_REAS1 TO MCUS_REAS1
   STORE CUS_REAS2 TO MCUS_REAS2
   STORE SUP_AMT1  TO MSUP_AMT1
   STORE SUP_AMT2  TO MSUP_AMT2
   STORE CUS_AMT1  TO MCUS_AMT1
   STORE CUS_AMT2  TO MCUS_AMT2
   STORE WRITEOFF  TO MWRITEOFF
   STORE CUS_PALL  TO MCUS_PALL  
   STORE SUP_PALL  TO MSUP_PALL    
   STORE INV_COMMT TO MINV_COMMT
   STORE SUP_COMMT TO MSUP_COMMT
   DO SAYMISC
   @ 2,45 SAY '*ID*:'
   @ 2,51 SAY USERID
   @ 2,63 SAY HIST_TIME
   @ 2,72 SAY HIST_DATE
   STORE 1 TO MACTION
   @ 24,0 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1. View Previous History Page      2. Finished with History'
   @ 24,8 GET MACTION PICTURE '#' RANGE 1,2
   READ
   IF MACTION = 2
      MPREVIOUS = .F.
      LOOP
   ENDIF
   SKIP -1
   IF SALESMAN <> B->SALESMAN .OR. PO_NBR <> B->PO_NBR .OR. PO_SUFFIX <> B->PO_SUFFIX
      MCONT = ' '
      @ 23,1 SAY SPACE(78)
      @ 23,1 SAY 'NO MORE HISTORY TO VIEW  - PRESS RETURN TO CONTINUE ' GET MCONT
      READ
      @ 23,1 SAY SPACE(78)
      MPREVIOUS = .F.
      LOOP
   ENDIF
ENDDO
SELECT F
USE
SELECT B

RETURN
* EOF: MISCHIST.PRG
*Formatted by: ToolBox Ver. 1.2  on 10/29/93 at 2:13 PM.
