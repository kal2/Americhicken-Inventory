**********
* Program.: FRT_VW.PRG
* Author..: Grace Keller
* Date....: 10/20/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: FREIGHT EDIT
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
SELECT B
STORE FRT_PALL TO MFRT_PALL
STORE REF_PO3  TO MREF_PO3
STORE REF_PO4  TO MREF_PO4
STORE REF_PO5  TO MREF_PO5
STORE REF_PO6  TO MREF_PO6

SELECT A
DO FOX_USE WITH "&MDBFLOC.FREIGHT INDEX &MDBFLOC.FRT_CODE", .F.
DO CASE
CASE MFRT_CODE1 = 'NONE'
   STORE 'NONE' + SPACE(28) TO MFRT_NAME1, MFSV1_NAME
CASE MFRT_CODE1 = 'CUST'
   STORE 'CUSTOMER PICK UP' + SPACE(16) TO MFRT_NAME1, MFSV1_NAME
CASE MFRT_CODE1 = SPACE(4)
   STORE SPACE(32) TO MFRT_NAME1, MFSV1_NAME
OTHERWISE     
   SEEK MFRT_CODE1
   IF .NOT. EOF()
      STORE NAME TO MFRT_NAME1, MFSV1_NAME
      STORE STREET TO MFRT_STRT1
      STORE CITY TO MFRT_CITY1
      STORE STATE TO MFRT_ST1   
      STORE ZIP TO MZIP1
      STORE ZIP4 TO MZIP4_1
   ELSE
      STORE 'FREIGHT CARRIER NOT ON FILE     ' TO MFRT_NAME1, MFSV1_NAME
   ENDIF
ENDCASE
*CLEAR 
*@  1, 0 SAY MCOMPANY
*@  1,68 SAY DATE()
@ 2,0 CLEAR

MTITLE = ' - PURCHASE ORDER FREIGHT CARRIERS'
@  2, 0 SAY MPROGRAM + MTITLE
@ 3,0 to 24,79
@  4, 5 SAY 'FREIGHT CARRIER:'     
@ 13,1 TO 13,78
@ 5,5 SAY MFRT_NAME1
IF MFRT_CODE1 <> 'NONE' .AND. MFRT_CODE1 <> SPACE(4) .AND. MFRT_CODE1 <> 'CUST' .AND. MFRT_NAME1 <> 'FREIGHT CARRIER NOT ON FILE'
   @ 04,40 SAY 'FREIGHT PAID(Y/N):'
   IF B->FRT_PD = ' '
      @ 4,59 SAY 'N'
   ELSE
      @ 4,59 SAY 'Y'
   ENDIF
   IF MZIP4_1 = SPACE(4)
      STORE MZIP1 TO MZIP
   ELSE
      STORE MZIP1 + '-' + MZIP4_1 TO MZIP
   ENDIF
   @ 06,5 SAY TRIM(MFRT_CITY1) + ', ' + MFRT_ST1 + '  ' + MZIP
   @ 7 ,40 SAY 'SPLIT FRT PO NBRS:'  
   @ 08,5 SAY 'FREIGHT AMOUNT:'
   @ 10,2 SAY '1. ADJUSTMENT AMT:'
   @ 10,40 SAY 'REASON:'
   @ 11,2 SAY '2. ADJUSTMENT AMT:'
   @ 11,40 SAY 'REASON:'
   @ 12,2 SAY 'PALLET ADJUSTMENT: '
   @ 08,21 SAY MFRT_AMT1 PICTURE '999999.99'
   @ 6,59 SAY MREF_PO1 PICTURE '@!'
   @ 6,70 SAY MREF_PO2 PICTURE '@!'
   @ 7,59 SAY MREF_PO3 PICTURE '@!'
   @ 7,70 SAY MREF_PO4 PICTURE '@!'
   @ 8,59 SAY MREF_PO5 PICTURE '@!'
   @ 8,70 SAY MREF_PO6 PICTURE '@!'
   @ 10,21 SAY MFRT1_ADJ1 PICTURE '99999.99'
   @ 10,48 SAY MFRT1_RS1 PICTURE '@!'
   @ 11,21 SAY MFRT1_ADJ2 PICTURE '99999.99'
   @ 11,48 SAY MFRT1_RS2 PICTURE '@!'
   @ 12,21 SAY MFRT_PALL PICTURE '99999.99'
ENDIF

*** AS OF 11/10/03 - DISPLAY ON ALL DATABASES
**** ONLY DISPLAY SECOND FREIGHT CARRIER ON MFI
**IF MPROG_CODE = 2
IF B->FRT2_FLG <> ' '
   SELECT A
   DO FOX_USE WITH "FRT_2ND INDEX FRT2_PO, FRT2_FRT", .F.
   SEEK B->SALESMAN + B->PO_NBR + B->PO_SUFFIX       
   MFRT_CODE2 = FRT_CODE2
   MFRT_AMT2 =  FRT_AMT2
   MFRT_PD2  =  FRT_PD2
ELSE
   MFRT_CODE2 = SPACE(4)
   MFRT_AMT2 = 0
   MFRT_PD2 = ' '
ENDIF
SELECT A
DO FOX_USE WITH "&MDBFLOC.FREIGHT INDEX &MDBFLOC.FRT_CODE, &MDBFLOC.FRT_NAME", .F.
DO CASE
CASE MFRT_CODE2 = 'NONE'
   STORE 'NONE' + SPACE(28) TO MFRT_NAME2             
CASE MFRT_CODE2 = 'CUST'
   STORE 'CUSTOMER PICK UP' + SPACE(16) TO MFRT_NAME2            
CASE MFRT_CODE2 = SPACE(4)
   STORE SPACE(32) TO MFRT_NAME2              
OTHERWISE     
   SEEK MFRT_CODE2
   IF .NOT. EOF()
      STORE NAME TO MFRT_NAME2, MFSV2_NAME
      STORE CITY TO MFRT_CITY2
      STORE STATE TO MFRT_ST2   
      STORE ZIP TO MZIP2
      STORE ZIP4 TO MZIP4_2
   ELSE
      STORE 'FREIGHT CARRIER NOT ON FILE     ' TO MFRT_NAME2, MFSV2_NAME
   ENDIF
ENDCASE

@ 15,5 SAY 'FREIGHT CARRIER 2'     
@ 16,5 SAY MFRT_NAME2
IF MFRT_CODE2 <> SPACE(4) .AND. MFRT_CODE2 <> 'NONE' .AND. MFRT_NAME2 <> 'FREIGHT CARRIER NOT ON FILE'
   @ 15,24 SAY 'PAID(Y/N):'
   IF MFRT_PD2 = ' '
      @ 15,35 SAY 'N'
   ELSE
      @ 15,35 SAY 'Y'
   ENDIF
   IF MZIP4_2 = SPACE(4)
      STORE MZIP2 TO MZIP
   ELSE
      STORE MZIP2 + '-' + MZIP4_2 TO MZIP
   ENDIF
   @ 17,5 SAY TRIM(MFRT_CITY2) + ', ' + MFRT_ST2 + '  ' + MZIP
ENDIF
@ 19,5 SAY 'FREIGHT AMOUNT:'
@ 19,21 SAY MFRT_AMT2 PICTURE '99999.99'


IF B->FRT3_FLG <> ' '
   SELECT A
   DO FOX_USE WITH "FRT_3RD INDEX FRT3_PO, FRT3_FRT", .F.
   SEEK B->SALESMAN + B->PO_NBR + B->PO_SUFFIX       
   MFRT_CODE3 = FRT_CODE3
   MFRT_AMT3 =  FRT_AMT3
   MFRT_PD3  =  FRT_PD3
ELSE
   MFRT_CODE3 = SPACE(4)
   MFRT_AMT3 = 0
   MFRT_PD3 = ' '
ENDIF
SELECT A
DO FOX_USE WITH "&MDBFLOC.FREIGHT INDEX &MDBFLOC.FRT_CODE, &MDBFLOC.FRT_NAME", .F.
DO CASE
CASE MFRT_CODE3 = 'NONE'
   STORE 'NONE' + SPACE(28) TO MFRT_NAME3             
CASE MFRT_CODE3 = 'CUST'
   STORE 'CUSTOMER PICK UP' + SPACE(16) TO MFRT_NAME3            
CASE MFRT_CODE3 = SPACE(4)
   STORE SPACE(32) TO MFRT_NAME3              
OTHERWISE     
   SEEK MFRT_CODE3
   IF .NOT. EOF()
      STORE NAME TO MFRT_NAME3, MFSV3_NAME
      STORE CITY TO MFRT_CITY3       
      STORE STATE TO MFRT_ST3   
      STORE ZIP TO MZIP3
      STORE ZIP4 TO MZIP4_3
   ELSE
      STORE 'FREIGHT CARRIER NOT ON FILE     ' TO MFRT_NAME3, MFSV3_NAME
   ENDIF
ENDCASE

@ 15,45 SAY 'FREIGHT CARRIER 3'     
@ 16,45 SAY MFRT_NAME3
IF MFRT_CODE3 <> SPACE(4) .AND. MFRT_CODE3 <> 'NONE' .AND. MFRT_NAME3 <> 'FREIGHT CARRIER NOT ON FILE'
   @ 15,64 SAY 'PAID(Y/N):'
   IF MFRT_PD3 = ' '
      @ 15,75 SAY 'N'
   ELSE
      @ 15,75 SAY 'Y'
   ENDIF
   IF MZIP4_3 = SPACE(4)
      STORE MZIP3 TO MZIP
   ELSE
      STORE MZIP3 + '-' + MZIP4_3 TO MZIP
   ENDIF
   @ 17,45 SAY TRIM(MFRT_CITY3) + ', ' + MFRT_ST3 + '  ' + MZIP
ENDIF
@ 19,45 SAY 'FREIGHT AMOUNT:'
@ 19,61 SAY MFRT_AMT3 PICTURE '99999.99'
***ENDIF


STORE 1 TO MACTION
@ 24,01 SAY 'Action: ' + STR(MACTION,1)  
@ 24,13 SAY '1. Continue     2. Previous Pg.     3. Finished with View'

@24,09 GET MACTION PICTURE '9' RANGE 1,3
READ               
DO CASE
CASE MACTION = 1
   MGOTO_PG = 5
CASE MACTION = 3
   MGOTO_PG = 99
CASE MACTION = 2
   MGOTO_PG = 3
ENDCASE
RETURN
* EOF: FRT_VW.PRG

*Formatted by: ToolBox Ver. 1.2  on 11/17/3 at 8:22 AM.
