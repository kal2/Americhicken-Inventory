**********
* Program.: SECURITY.PRG
* Author..: GRACE KELLER
* Date....: 02/18/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: SECURITY                   
*
STORE 'SUPERVISOR' TO MUSER 
MSECURITY = .T.
RETURN
******
RUN \PUBLIC\WHOAMI.EXE > BAT.BAT
SELECT A
USE TEXT EXCLUSIVE
DELETE ALL
PACK
USE
SELECT A
DO FOX_USE WITH "TEXT", .F.
APPEND FROM BAT.BAT SDF
GOTO TOP   
DO CASE
CASE SUBSTR(TEXT,14,10) = 'SUPERVISOR'
   STORE 'SUPERVISOR' TO MUSER 
CASE SUBSTR(TEXT,14,3) = 'KEN'
   STORE 'KEN' TO MUSER
CASE SUBSTR(TEXT,14,5) = 'KATHY'
   STORE 'KATHY' TO MUSER
CASE SUBSTR(TEXT,14,6) = 'CONNIE'
   STORE 'CONNIE' TO MUSER
CASE SUBSTR(TEXT,14,5) = 'GAIL' 
   STORE 'GAIL' TO MUSER
CASE SUBSTR(TEXT,14,5) = 'KAREN'   
   STORE 'KAREN' TO MUSER
CASE SUBSTR(TEXT,14,7) = 'CELINDA'
   STORE 'CELINDA' TO MUSER
CASE SUBSTR(TEXT,14,4) = 'MATT'
   STORE 'MATT' TO MUSER
OTHERWISE
   STORE SPACE(10) TO MUSER
ENDCASE
MTEXT = TRIM(TEXT)
MLEN = LEN(MTEXT)
MSTATION = SUBSTR(MTEXT,MLEN-1,1)
SELECT A
USE &MMASTDBF.SECURITY INDEX &MMASTDBF.SECURITY
SEEK MCALLING + MUSER
IF .NOT. EOF() .OR. MCALLING = 'MIDWEST' .OR. MUSER = 'SUPERVISOR'
   MSECURITY = .T.
ELSE  
   IF MPROG_CODE = 2
      MSECURITY = .T.
   ELSE 
      CLEAR
      STORE ' ' TO MWAIT
      @ 10,5 SAY 'SECURITY VIOLATION !!!!!'
      @ 12,5 SAY 'YOU ARE NOT AUTHORIZED TO ACCESS THIS PROCEDURE.'
      @ 14,5 SAY 'PLEASE CONTACT THE SUPERVISOR TO OBTAIN PROPER'
      @ 16,5 SAY 'AUTHORIZATION. '
      @ 19,5 SAY 'PRESS ENTER TO RETURN TO MENU. ' GET MWAIT
      READ
   ENDIF
ENDIF
RETURN
* EOF: SECURITY.PRG
*Formatted by: ToolBox Ver. 1.2  on 2/27/96 at 10:34 PM.
