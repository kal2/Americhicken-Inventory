**********
* Program.: UPDNOTES.PRG
* Author..: Grace Keller
* Date....: 04/19/88
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: UPDATE PURCHASE ORDER NOTES
*
CLEAR
@ 1,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@ 02,00 SAY MPROGRAM + ' - UPDATE PURCHASE ORDER NOTES'
@ 03,00 TO 24,79 
SELECT F
USE NOTES INDEX NOTES
STORE SPACE(78) TO MNOTE1, MNOTE2, MNOTE3, MNOTE4, MNOTE5, MNOTE6
SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX 

DO WHILE .NOT. EOF() .AND. SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX
   STORE SEQ TO MSEQ
   STORE NOTE TO MNOTE&MSEQ
   SKIP
ENDDO
IF MSALESMAN <> SPACE(2)
   STORE MSALESMAN + '-' + MPO_NBR TO MSAY
ELSE
   STORE MPO_NBR TO MSAY
ENDIF
IF MPO_SUFFIX <> ' '
   STORE MSAY + '-' + MPO_SUFFIX TO MSAY
ENDIF
@ 5,1 SAY 'NOTES FOR PO #  ' + MSAY
STORE 2 TO MACTION
DO WHILE MACTION = 2
   @ 08,1 GET MNOTE1  
   @ 09,1 GET MNOTE2
   @ 10,1 GET MNOTE3
   @ 11,1 GET MNOTE4
   @ 12,1 GET MNOTE5
   @ 13,1 GET MNOTE6
   STORE 1 TO MACTION
   @ 24,00 CLEAR
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1. Continue    2.  Edit    3. Cancel Updates'
   
   READ
   
   @24,09 GET MACTION PICTURE '9' RANGE 1,3
   READ               
   
ENDDO
IF MACTION = 3
   RETURN
ENDIF
MONE = .F.
MSEQ = 1
DO WHILE MSEQ <= 6
   STORE STR(MSEQ,1) TO MSEQI
   SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX + MSEQI
   IF EOF() 
      IF MNOTE&MSEQI <> SPACE(78)
         DO FILELOCK
         APPEND BLANK
         REPLACE SALESMAN WITH MSALESMAN
         REPLACE PO_NBR WITH MPO_NBR
         REPLACE PO_SUFFIX WITH MPO_SUFFIX
         REPLACE NOTE WITH MNOTE&MSEQI
         REPLACE SEQ WITH MSEQI
         UNLOCK
         MONE = .T.
      ENDIF
   ELSE
      IF MNOTE&MSEQI = SPACE(78)
         DO FILELOCK
         DELETE
         UNLOCK
      ELSE  
         DO RECLOCK
         REPLACE NOTE WITH MNOTE&MSEQI
         UNLOCK
         MONE = .T.
      ENDIF
   ENDIF
   MSEQ = MSEQ + 1
ENDDO
USE
SELECT B
IF MONE
  DO RECLOCK
  REPLACE NOTES_FLG WITH 'Y'
  UNLOCK
ENDIF
RETURN
* EOF: UPDNOTES.PRG
*Formatted by: dANALYST Ver. 7.3a on April 20, 1988 at 1:54 PM.
