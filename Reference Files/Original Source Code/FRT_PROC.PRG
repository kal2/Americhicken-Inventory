*************
* Program.: FRT_PROC.PRG
* Author..: Grace Keller
* Date....: 10/26/90
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: FREIGHT LISTING 
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
*
PROCEDURE TEXTFRT
CLEAR 
@  1, 0 SAY MCOMPANY
@  1,68 SAY DATE()
@  2, 0 SAY MPROGRAM + MTITLE
@ 3,0 TO 23,79
@ 03,01 TO 03,78
@ 04,01 SAY "      FREIGHT COMPANY                         PAY TO COMPANY"
@ 05,01 SAY "NAME:"
@ 05,39 SAY "  NAME:"
@ 06,01 SAY "ADDR:"
@ 06,39 SAY "  ADDR:"
@ 07,01 SAY "CITY:"
@ 07,39 SAY "  CITY:"
@ 08,01 SAY "STZP:"
@ 08,39 SAY "  STZP:"
@ 09,01 SAY "PHONE #:"
@ 09,39 SAY "  PHONE #:"
@ 10,01 SAY "  FAX #:"
@ 10,39 SAY "    FAX #:"
@ 11,01 SAY "CONTACT:"
@ 04,39 TO 10,39
@ 12,01 TO 12,78
@ 13,01 SAY "ACTIVE/HOLD (Y/N/H):"
@ 14,01 SAY "NOTE:"
@ 16,01 TO 16,78
@ 17,09 SAY "I N S U R A N C E   C O V E R A G E   I N F O R M A T I O N"
@ 18,01 SAY "A. INSURANCE CO:"
@ 19,01 SAY "B. INSURANCE CO:"
@ 20,01 SAY 'C. INSURANCE CO:'
@ 21,01 SAY 'D. INSURANCE CO:'
RETURN

PROCEDURE SAYFRT 
@ 05,07 SAY MNAME  
@ 05,47 SAY MPAY_NAME  
@ 06,07 SAY MSTREET    
@ 06,47 SAY MPAY_STRT  
@ 07,07 SAY MCITY      
@ 07,47 SAY MPAY_CITY  
@ 08,07 SAY MSTATE     
@ 08,13 SAY MZIP
@ 08,19 SAY MZIP4
@ 08,47 SAY MPAY_STATE 
@ 08,53 SAY MPAY_ZIP
@ 08,59 SAY MPAY_ZIP4
@ 09,10 SAY MAREA_CODE PICTURE '@R (###'
@ 09,14 SAY MPHONE PICTURE '@R )###-####'
@ 09,50 SAY MPAY_AREA  PICTURE '@R (###'
@ 09,54 SAY MPAY_PHONE PICTURE '@R )###-####'
@ 10,10 SAY MFAX_AREA PICTURE '@R (###'
@ 10,14 SAY MFAX_PHONE PICTURE '@R )###-####'
@ 10,50 SAY MPAY_FAREA  PICTURE '@R (###'
@ 10,54 SAY MPAY_FPHON PICTURE '@R )###-####'
@ 11,10 SAY MFRT_CONT 
@ 13,24 SAY MACTIVE
@ 14,07 SAY MNOTE      

@ 18,18 SAY MINS_CO1   
@ 19,18 SAY MINS_CO2   
@ 20,18 SAY MINS_CO3   
@ 21,18 SAY MINS_CO4   
RETURN

PROCEDURE GETFRT1 
@ 05,07 GET MNAME  PICTURE '@!'
@ 06,07 GET MSTREET    PICTURE '@!'
@ 07,07 GET MCITY      PICTURE '@!'
@ 08,07 GET MSTATE     PICTURE '@!'
@ 08,13 GET MZIP       PICTURE '#####'
@ 08,19 GET MZIP4      PICTURE '####'
@ 09,10 GET MAREA_CODE PICTURE '@R (###'
@ 09,14 GET MPHONE     PICTURE '@R )###-####'
@ 10,10 GET MFAX_AREA  PICTURE '@R (###'
@ 10,14 GET MFAX_PHONE PICTURE '@R )###-####'
@ 11,10 GET MFRT_CONT  PICTURE '@!'

@ 05,47 GET MPAY_NAME  PICTURE '@!'
@ 06,47 GET MPAY_STRT  PICTURE '@!'
@ 07,47 GET MPAY_CITY  PICTURE '@!'
@ 08,47 GET MPAY_STATE PICTURE '@!'
@ 08,53 GET MPAY_ZIP   PICTURE '#####'
@ 08,59 GET MPAY_ZIP4  PICTURE '####'
@ 09,50 GET MPAY_AREA  PICTURE '@R (###'
@ 09,54 GET MPAY_PHONE PICTURE '@R )###-####'
@ 10,50 GET MPAY_FAREA PICTURE '@R (###'
@ 10,54 GET MPAY_FPHON PICTURE '@R )###-####'

@ 13,24 GET MACTIVE
@ 14,07 GET MNOTE      
@ 18,18 GET MINS_CO1   
@ 19,18 GET MINS_CO2   
@ 20,18 GET MINS_CO3   
@ 21,18 GET MINS_CO4   

CLEAR GETS

@ 05,07 GET MNAME  PICTURE '@!'
@ 06,07 GET MSTREET    PICTURE '@!'
@ 07,07 GET MCITY      PICTURE '@!'
@ 08,07 GET MSTATE     PICTURE '@!'
@ 08,13 GET MZIP       PICTURE '#####'
@ 08,19 GET MZIP4      PICTURE '####'
@ 09,10 GET MAREA_CODE PICTURE '@R (###'
@ 09,14 GET MPHONE     PICTURE '@R )###-####'
@ 10,10 GET MFAX_AREA  PICTURE '@R (###'
@ 10,14 GET MFAX_PHONE PICTURE '@R )###-####'
@ 11,10 GET MFRT_CONT  PICTURE '@!'

@ 05,47 GET MPAY_NAME  PICTURE '@!'
@ 06,47 GET MPAY_STRT  PICTURE '@!'
@ 07,47 GET MPAY_CITY  PICTURE '@!'
@ 08,47 GET MPAY_STATE PICTURE '@!'
@ 08,53 GET MPAY_ZIP   PICTURE '#####'
@ 08,59 GET MPAY_ZIP4  PICTURE '####'
@ 09,50 GET MPAY_AREA  PICTURE '@R (###'
@ 09,54 GET MPAY_PHONE PICTURE '@R )###-####'
@ 10,50 GET MPAY_FAREA PICTURE '@R (###'
@ 10,54 GET MPAY_FPHON PICTURE '@R )###-####'
RETURN

PROCEDURE GETFRT2
@ 13,24 GET MACTIVE PICTURE '@!' VALID(MACTIVE = 'Y' .OR. MACTIVE = 'N' .OR. MACTIVE = 'H')
@ 14,07 GET MNOTE      
@ 18,18 GET MINS_CO1   
@ 19,18 GET MINS_CO2   
@ 20,18 GET MINS_CO3   
@ 21,18 GET MINS_CO4   
RETURN

PROCEDURE INITFRT 
IF MINIT_NM
   MNAME       = SPACE(32)
ENDIF
MSTREET     = SPACE(28)
MCITY       = SPACE(20)
MSTATE      = SPACE(2)
MZIP        = SPACE(5)
MZIP4       = SPACE(4)
MFRT_CODE   = SPACE(4)
MAREA_CODE  = SPACE(3)
MPHONE      = SPACE(7)
MPAY_NAME   = SPACE(32)
MPAY_STRT   = SPACE(28)
MPAY_CITY   = SPACE(20)
MPAY_STATE  = SPACE(2)
MPAY_ZIP    = SPACE(5)
MPAY_ZIP4   = SPACE(4)
MPAY_AREA   = SPACE(3)
MPAY_PHONE  = SPACE(7)
MFAX_AREA   = SPACE(3)
MFAX_PHONE  = SPACE(7)
MACTIVE     = 'Y'
MFRT_CONT   = SPACE(32)
MNOTE       = SPACE(65)
MINS_CO1    = SPACE(32)
MINS_CO2    = SPACE(32)
MINS_CO3    = SPACE(32)
MINS_CO4    = SPACE(32)

MINS_TP1   = SPACE(1)
MINS_TP2   = SPACE(1)
MINS_TP3   = SPACE(1)
MINS_TP4   = SPACE(1)
MINS_TP5   = SPACE(1)

MAUTO_COV1   = 0 
MAUTO_COV2   = 0 
MAUTO_COV3   = 0 
MAUTO_COV4   = 0 

MCARG_COV1 = 0
MCARG_COV2 = 0
MCARG_COV3 = 0
MCARG_COV4 = 0

MGEN_COV1   = 0
MGEN_COV2   = 0
MGEN_COV3   = 0
MGEN_COV4   = 0
MGEN_COV5   = 0
MGEN_COV6   = 0

MWORK_COV1  = 0
MWORK_COV2  = 0
MWORK_COV3  = 0

MPHY_COV1   = 0
MPHY_COV2   = 0

MPOLICY1    = SPACE(20)
MPOLICY2    = SPACE(20)
MPOLICY3    = SPACE(20)
MPOLICY4    = SPACE(20)
MPOLICY5    = SPACE(20)
MAUTO_BEG   = CTOD(' ')
MCARGO_BEG  = CTOD(' ')
MGEN_BEG    = CTOD(' ')
MWORK_BEG   = CTOD(' ')
MPHY_BEG    = CTOD(' ')

MAUTO_END   = CTOD(' ')
MCARGO_END  = CTOD(' ')
MGEN_END    = CTOD(' ')
MWORK_END   = CTOD(' ')
MPHY_END    = CTOD(' ')

MAUTO_LET   = CTOD(' ')
MCARGO_LET  = CTOD(' ')
MGEN_LET    = CTOD(' ')
MWORK_LET   = CTOD(' ')
MCANCEL     = 0

RETURN

PROCEDURE SAYPAY
@ 05,47 GET MPAY_NAME  PICTURE '@!'
@ 06,47 GET MPAY_STRT  PICTURE '@!'
@ 07,47 GET MPAY_CITY  PICTURE '@!'
@ 08,47 GET MPAY_STATE PICTURE '@!'
@ 08,51 GET MPAY_ZIP   PICTURE '#####'
@ 08,57 GET MPAY_ZIP4  PICTURE '####'
@ 09,50 GET MPAY_AREA  PICTURE '@R (###'
@ 09,54 GET MPAY_PHONE PICTURE '@R )###-####'
@ 10,50 GET MPAY_FAREA PICTURE '@R (###'
@ 10,54 GET MPAY_FPHON PICTURE '@R )###-####'
CLEAR GETS
RETURN

PROCEDURE STORFRT
STORE NAME       TO MNAME      
STORE STREET     TO MSTREET    
STORE CITY       TO MCITY      
STORE STATE      TO MSTATE
STORE ZIP        to MZIP
STORE ZIP4       TO MZIP4      
STORE FRT_CODE   TO MFRT_CODE
STORE AREA_CODE  TO MAREA_CODE
STORE PHONE      TO MPHONE
STORE FRT_CONT   TO MFRT_CONT
STORE PAY_NAME   TO MPAY_NAME
STORE PAY_STRT   TO MPAY_STRT
STORE PAY_CITY   TO MPAY_CITY
STORE PAY_STATE  TO MPAY_STATE
STORE PAY_ZIP    TO MPAY_ZIP
STORE PAY_ZIP4   TO MPAY_ZIP4
STORE PAY_AREA   TO MPAY_AREA
STORE PAY_PHONE  TO MPAY_PHONE
STORE FAX_AREA   TO MFAX_AREA
STORE FAX_PHONE  TO MFAX_PHONE
STORE PAY_FAREA  TO MPAY_FAREA
STORE PAY_FPHON  TO MPAY_FPHON
STORE ACTIVE     TO MACTIVE
STORE NOTE       TO MNOTE
STORE INS_CO1    TO MINS_CO1
STORE INS_CO2    TO MINS_CO2
STORE INS_CO3    TO MINS_CO3
STORE INS_CO4    TO MINS_CO4

STORE POLICY1    TO MPOLICY1
STORE POLICY2    TO MPOLICY2
STORE POLICY3    TO MPOLICY3
STORE POLICY4    TO MPOLICY4
STORE POLICY5    TO MPOLICY5

STORE INS_TP1    TO MINS_TP1
STORE INS_TP2    TO MINS_TP2
STORE INS_TP3    TO MINS_TP3
STORE INS_TP4    TO MINS_TP4
STORE INS_TP5    TO MINS_TP5

STORE AUTO_COV1  TO MAUTO_COV1
STORE AUTO_COV2  TO MAUTO_COV2
STORE AUTO_COV3  TO MAUTO_COV3
STORE AUTO_COV4  TO MAUTO_COV4

STORE CARG_COV1 TO MCARG_COV1
STORE CARG_COV2 TO MCARG_COV2
STORE CARG_COV3 TO MCARG_COV3
STORE CARG_COV4 TO MCARG_COV4

STORE GEN_COV1   TO MGEN_COV1 
STORE GEN_COV2   TO MGEN_COV2 
STORE GEN_COV3   TO MGEN_COV3 
STORE GEN_COV4   TO MGEN_COV4 
STORE GEN_COV5   TO MGEN_COV5 
STORE GEN_COV6   TO MGEN_COV6 

STORE WORK_COV1   TO MWORK_COV1
STORE WORK_COV2   TO MWORK_COV2
STORE WORK_COV3   TO MWORK_COV3

STORE AUTO_BEG   TO MAUTO_BEG
STORE CARGO_BEG  TO MCARGO_BEG
STORE GEN_BEG    TO MGEN_BEG  
STORE WORK_BEG   TO MWORK_BEG 
STORE AUTO_END   TO MAUTO_END
STORE CARGO_END  TO MCARGO_END
STORE GEN_END    TO MGEN_END  
STORE WORK_END   TO MWORK_END 
STORE AUTO_LET   TO MAUTO_LET
STORE CARGO_LET  TO MCARGO_LET
STORE GEN_LET    TO MGEN_LET  
STORE WORK_LET   TO MWORK_LET 
STORE CANCEL     TO MCANCEL

STORE PHY_BEG    TO MPHY_BEG
STORE PHY_END    TO MPHY_END
STORE PHY_COV1   TO MPHY_COV1
STORE PHY_COV2   TO MPHY_COV2

RETURN

PROCEDURE REPLFRT1
IF NAME <> MNAME .OR. FRT_CODE <> MFRT_CODE
   DO FILELOCK
   REPLACE NAME       WITH MNAME      
   REPLACE FRT_CODE   WITH MFRT_CODE
ELSE
   DO RECLOCK
ENDIF
REPLACE STREET     WITH MSTREET    
REPLACE CITY       WITH MCITY      
REPLACE STATE      WITH MSTATE
REPLACE ZIP        WITH MZIP       
REPLACE ZIP4       WITH MZIP4      
REPLACE AREA_CODE  WITH MAREA_CODE
REPLACE PHONE      WITH MPHONE
REPLACE FRT_CONT   WITH MFRT_CONT
REPLACE PAY_NAME   WITH MPAY_NAME
REPLACE PAY_STRT   WITH MPAY_STRT
REPLACE PAY_CITY   WITH MPAY_CITY
REPLACE PAY_STATE  WITH MPAY_STATE
REPLACE PAY_ZIP    WITH MPAY_ZIP
REPLACE PAY_ZIP4   WITH MPAY_ZIP4
REPLACE PAY_AREA   WITH MPAY_AREA
REPLACE PAY_PHONE  WITH MPAY_PHONE
REPLACE FAX_AREA   WITH MFAX_AREA
REPLACE FAX_PHONE  WITH MFAX_PHONE
REPLACE PAY_FAREA  WITH MPAY_FAREA
REPLACE PAY_FPHON  WITH MPAY_FPHON
REPLACE ACTIVE     WITH MACTIVE
REPLACE NOTE       WITH MNOTE
REPLACE INS_CO1    WITH MINS_CO1
REPLACE INS_CO2    WITH MINS_CO2
REPLACE INS_CO3    WITH MINS_CO3
REPLACE INS_CO4    WITH MINS_CO4
RETURN


PROCEDURE REPLFRT2
REPLACE POLICY1    WITH MPOLICY1
REPLACE POLICY2    WITH MPOLICY2
REPLACE POLICY3    WITH MPOLICY3
REPLACE POLICY4    WITH MPOLICY4
REPLACE POLICY5    WITH MPOLICY5

REPLACE INS_TP1    WITH MINS_TP1
REPLACE INS_TP2    WITH MINS_TP2
REPLACE INS_TP3    WITH MINS_TP3
REPLACE INS_TP4    WITH MINS_TP4
REPLACE INS_TP5    WITH MINS_TP5

REPLACE AUTO_COV1  WITH MAUTO_COV1
REPLACE AUTO_COV2  WITH MAUTO_COV2
REPLACE AUTO_COV3  WITH MAUTO_COV3
REPLACE AUTO_COV4  WITH MAUTO_COV4

REPLACE CARG_COV1 WITH MCARG_COV1
REPLACE CARG_COV2 WITH MCARG_COV2
REPLACE CARG_COV3 WITH MCARG_COV3
REPLACE CARG_COV4 WITH MCARG_COV4

REPLACE GEN_COV1   WITH MGEN_COV1 
REPLACE GEN_COV2   WITH MGEN_COV2 
REPLACE GEN_COV3   WITH MGEN_COV3 
REPLACE GEN_COV4   WITH MGEN_COV4 
REPLACE GEN_COV5   WITH MGEN_COV5 
REPLACE GEN_COV6   WITH MGEN_COV6 

REPLACE WORK_COV1  WITH MWORK_COV1
REPLACE WORK_COV2  WITH MWORK_COV2
REPLACE WORK_COV3  WITH MWORK_COV3

REPLACE AUTO_BEG   WITH MAUTO_BEG
REPLACE CARGO_BEG  WITH MCARGO_BEG
REPLACE GEN_BEG    WITH MGEN_BEG  
REPLACE WORK_BEG   WITH MWORK_BEG 
REPLACE AUTO_END   WITH MAUTO_END
REPLACE CARGO_END  WITH MCARGO_END
REPLACE GEN_END    WITH MGEN_END  
REPLACE WORK_END   WITH MWORK_END 
REPLACE AUTO_LET   WITH MAUTO_LET
REPLACE CARGO_LET  WITH MCARGO_LET
REPLACE GEN_LET    WITH MGEN_LET  
REPLACE WORK_LET   WITH MWORK_LET 
REPLACE CANCEL     WITH MCANCEL

REPLACE PHY_BEG    WITH MPHY_BEG
REPLACE PHY_END    WITH MPHY_END
REPLACE PHY_COV1   WITH MPHY_COV1
REPLACE PHY_COV2   WITH MPHY_COV2
REPLACE INS_TP5    WITH MINS_TP5
REPLACE POLICY5    WITH MPOLICY5

UNLOCK
RETURN

PROCEDURE PUBLFRT
PUBLIC mname, mstreet, mcity, MSTATE, mzip, mzip4, MFRT_CODE, MAREA_CODE, MPHONE
PUBLIC MPAY_NAME, MPAY_STRT, MPAY_CITY, MPAY_STATE, MPAY_ZIP, MPAY_ZIP4, MPAY_AREA, MPAY_PHONE
RETURN

PROCEDURE SAYFRT2 
CLEAR
@ 0, 0 SAY MCOMPANY
@ 1, 0 SAY MPROGRAM + MTITLE
@ 1,68 SAY DATE()
@ 2,0 to 24,79
@ 02,01 SAY "INS CO."
@ 02,09 SAY "TYPE/COVERAGE"
@ 02,24 SAY "POLICY NUMBER"
@ 02,46 SAY "BEGIN DT"
@ 02,57 SAY "END DT"
@ 02,68 SAY "LETTER SENT"

@ 03,09 SAY "GENERAL"
@ 04,01 SAY "              Each Occurrence:"
@ 04,52 SAY "Pers/Adv Injury:"
@ 05,01 SAY "           Damage to Premises:"
@ 05,52 SAY "  GEN Aggregate:"
@ 06,01 SAY "              Medical Expense:"
@ 06,52 SAY "  OPS Aggregate:"

@ 07,01 TO 07,78
@ 08,09 SAY "AUTO LIABILITY"

@ 09,01 SAY "        Combined Single Limit:"
@ 09,46 SAY "Injury (Per Accident):"
@ 10,01 SAY "          Injury (Per Person):"
@ 10,52 SAY "Property Damage:"
@ 11,01 TO 11,78
@ 12,09 SAY "WORKER'S COMP"
@ 13,01 SAY "                Each Accident:"
@ 13,49 SAY "Disease (Employee):"
@ 14,01 SAY "              Disease (Limit):"
@ 15,01 TO 15,78
@ 16,09 SAY "CARGO"
@ 17,01 SAY "            Vehicle Liability:"
@ 17,48 SAY "  Refer Deductible:"
@ 18,01 SAY "        Catastrophe Liability:"
@ 18,48 SAY "Regular Deductible:"
@ 19,01 TO 19,78
@ 20,08 SAY "PHYSICAL DAMAGE"
@ 21,01 SAY "                        Limit:"
@ 21,48 SAY "        Deductible:"
@ 22,01 SAY "     Cancellation Days Notice:"
RETURN

PROCEDURE SAYFRT3 
@ 03,04 SAY MINS_TP1 PICTURE '@!'
@ 03,24 SAY MPOLICY1 PICTURE '@!'
@ 03,46 SAY MGEN_BEG   
@ 03,57 SAY MGEN_END   
@ 03,69 SAY MGEN_LET   
@ 04,32 SAY MGEN_COV4  PICTURE '##,###,###'
@ 05,32 SAY MGEN_COV5  PICTURE '##,###,###'
@ 06,32 SAY MGEN_COV6  PICTURE '##,###,###'
@ 04,69 SAY MGEN_COV3  PICTURE '##,###,###'
@ 05,69 SAY MGEN_COV1  PICTURE '##,###,###'
@ 06,69 SAY MGEN_COV2  PICTURE '##,###,###'

@ 08,04 SAY MINS_TP2 PICTURE '@!'
@ 08,24 SAY MPOLICY2 PICTURE '@!'
@ 08,46 SAY MAUTO_BEG  
@ 08,57 SAY MAUTO_END  
@ 08,69 SAY MAUTO_LET  
@ 09,32 SAY MAUTO_COV1  PICTURE '##,###,###'
@ 10,32 SAY MAUTO_COV2  PICTURE '##,###,###'
@ 09,69 SAY MAUTO_COV3  PICTURE '##,###,###'
@ 10,69 SAY MAUTO_COV4  PICTURE '##,###,###'

@ 12,04 SAY MINS_TP3  PICTURE '@!'
@ 12,24 SAY MPOLICY3  PICTURE '@!'
@ 12,46 SAY MWORK_BEG   
@ 12,57 SAY MWORK_END  
@ 12,69 SAY MWORK_LET  
@ 13,32 SAY MAUTO_COV1 PICTURE '##,###,###'
@ 14,32 SAY MAUTO_COV2 PICTURE '##,###,###'
@ 13,69 SAY MAUTO_COV3 PICTURE '##,###,###'

@ 16,04 SAY MINS_TP4   PICTURE '@!'
@ 16,24 SAY MPOLICY4   PICTURE '@!'
@ 16,46 SAY MCARGO_BEG 
@ 16,57 SAY MCARGO_END 
@ 16,69 SAY MCARGO_LET 
@ 17,32 SAY MCARG_COV1 PICTURE '##,###,###'
@ 18,32 SAY MCARG_COV2 PICTURE '##,###,###'
@ 17,69 SAY MCARG_COV3 PICTURE '##,###,###'
@ 18,69 SAY MCARG_COV4 PICTURE '##,###,###'

@ 20,04 SAY MINS_TP5   PICTURE '@!'
@ 20,24 SAY MPOLICY5   PICTURE '@!'
@ 20,46 SAY MPHY_BEG 
@ 20,57 SAY MPHY_END 
**@ 16,69 SAY MCARGO_LET 
@ 21,32 SAY MPHY_COV1 PICTURE '##,###,###'
@ 21,69 SAY MPHY_COV2 PICTURE '##,###,###'
@ 22,33 SAY MCANCEL      
RETURN

PROCEDURE GETFRT3 
@ 03,04 GET MINS_TP1 PICTURE '@!'
@ 03,24 GET MPOLICY1 PICTURE '@!'
@ 03,46 GET MGEN_BEG   
@ 03,57 GET MGEN_END   
@ 03,69 GET MGEN_LET   
@ 04,32 GET MGEN_COV4  PICTURE '##,###,###'
@ 05,32 GET MGEN_COV5  PICTURE '##,###,###'
@ 06,32 GET MGEN_COV6  PICTURE '##,###,###'
@ 04,69 GET MGEN_COV3  PICTURE '##,###,###'
@ 05,69 GET MGEN_COV1  PICTURE '##,###,###'
@ 06,69 GET MGEN_COV2  PICTURE '##,###,###'

@ 08,04 GET MINS_TP2 PICTURE '@!'
@ 08,24 GET MPOLICY2 PICTURE '@!'
@ 08,46 GET MAUTO_BEG  
@ 08,57 GET MAUTO_END  
@ 08,69 GET MAUTO_LET  
@ 09,32 GET MAUTO_COV1  PICTURE '##,###,###'
@ 10,32 GET MAUTO_COV2  PICTURE '##,###,###'
@ 09,69 GET MAUTO_COV3  PICTURE '##,###,###'
@ 10,69 GET MAUTO_COV4  PICTURE '##,###,###'

@ 12,04 GET MINS_TP3  PICTURE '@!'
@ 12,24 GET MPOLICY3  PICTURE '@!'
@ 12,46 GET MWORK_BEG   
@ 12,57 GET MWORK_END  
@ 12,69 GET MWORK_LET  
@ 13,32 GET MAUTO_COV1 PICTURE '##,###,###'
@ 14,32 GET MAUTO_COV2 PICTURE '##,###,###'
@ 13,69 GET MAUTO_COV3 PICTURE '##,###,###'

@ 16,04 GET MINS_TP4   PICTURE '@!'
@ 16,24 GET MPOLICY4   PICTURE '@!'
@ 16,46 GET MCARGO_BEG 
@ 16,57 GET MCARGO_END 
@ 16,69 GET MCARGO_LET 

@ 17,32 GET MCARG_COV1 PICTURE '##,###,###'
@ 18,32 GET MCARG_COV2 PICTURE '##,###,###'
@ 17,69 GET MCARG_COV3 PICTURE '##,###,###'
@ 18,69 GET MCARG_COV4 PICTURE '##,###,###'
@ 20,04 GET MINS_TP5   PICTURE '@!'
@ 20,24 GET MPOLICY5   PICTURE '@!'
@ 20,46 GET MPHY_BEG 
@ 20,57 GET MPHY_END 
**@ 16,69 SAY MCARGO_LET 
@ 21,32 GET MPHY_COV1 PICTURE '##,###,###'
@ 21,69 GET MPHY_COV2 PICTURE '##,###,###'
@ 22,33 GET MCANCEL    PICTURE '##'
RETURN

PROCEDURE FRT_UPD2
MTITLE = ' - VIEW/CHANGE FREIGHT INSURANCE INFORMATION' 
**** PUT UP THE SCREEN
DO SAYFRT2
MNOT_DONE = .T.
DO WHILE MNOT_DONE
   DO GETFRT3
   STORE 1 TO MACTION
   @ 24,0 CLEAR
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1.Save/Return    2.Edit Screen    3.Print Ins. Letter   4.Cancel'
   READ
   
   @24,09 GET MACTION PICTURE '9' RANGE 1,4
   READ               
   DO CASE
   CASE MACTION = 4
      MNOT_DONE = .F.
      LOOP
      
   CASE MACTION = 2
      LOOP
      
   CASE MACTION = 1 .OR. MACTION = 3
      DO REPLFRT2
      IF MACTION = 3
         DO FRT_LET
      ENDIF
      MNOT_DONE = .F.
   ENDCASE
   
ENDDO
RETURN

PROCEDURE FRT_LET
STORE SPACE(1) TO MCERT, MCHOICE1, MCHOICE2, MCHOICE3, MCHOICE4, MCHOICE5
CLEAR
@ 0, 0 SAY MCOMPANY
@ 1, 0 SAY MPROGRAM + MTITLE
@ 1,68 SAY DATE()
@ 2,0 to 24,79
@ 04,01 SAY "SELECT FROM THE FOLLOWING OPTIONS FOR LETTER PRINT:"
@ 06,05 SAY 'Acord Insurance Certificate'
@ 09,05 say 'Additional Information'
@ 11,05 say '1. Auto Liability   '
@ 12,05 say '2. General Liability'
@ 13,05 say '3. Cargo Coverage   '
@ 14,05 say "4. Worker's Compensation"
@ 06,39 GET MCERT PICTURE '@!'
@ 11,39 GET MCHOICE1 PICTURE '@!'
@ 12,39 GET MCHOICE2 PICTURE '@!'
@ 13,39 GET MCHOICE3 PICTURE '@!'
@ 14,39 GET MCHOICE4 PICTURE '@!'
STORE 1 TO MACTION
@ 24,0 CLEAR
@ 24,01 SAY 'Action: ' + STR(MACTION,1)
@ 24,13 SAY '1. Print Letter    2. Cancel Print'
READ

@24,09 GET MACTION PICTURE '9' RANGE 1,2
READ               
IF MACTION = 2
   RETURN
ENDIF
STORE ' ' TO MPRT_ACT
DO PRT_SET 
IF MPRT_ACT <> 'C'
   RETURN
ENDIF 
SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

?
?
?
?
?
?
?
?
?
?
?
?
*?
MINDENT = 8     
? SPACE(MINDENT) + SPACE(49) + TRIM(CMONTH(DATE())) + ' ' + SUBSTR(DTOC(DATE()),4,2) + ', ' + STR(YEAR(DATE()),4)
? SPACE(MINDENT) + MNAME
? SPACE(MINDENT) + MSTREET
? SPACE(MINDENT) + TRIM(MCITY) + ', ' + MSTATE + '  ' + MZIP
?
?
?
? SPACE(MINDENT) + 'Gentlemen:'
?
DO CASE           
CASE MCERT <> ' '
   ? SPACE(MINDENT) + 'We have reviewed your insurance file and find that we need an Acord Insurance'
   ? SPACE(MINDENT) + 'Certificate with the following coverages and conditions:'
   ?
   ? SPACE(MINDENT) + space(5) + 'A.  Auto Liability     $1,000,000.'
   ?
   ? SPACE(MINDENT) + space(5) + 'B.  General Liability  $1,000,000.'
   ?
   ? SPACE(MINDENT) + space(5) + 'C.  Cargo Coverage including Refrigeration Breakdown  $125,000 per Vehicle'
   ?
   ? SPACE(MINDENT) + space(5) + "D.  Worker's Compensation"
   ?
   DO RECLOCK
   REPLACE AUTO_LET WITH DATE()
   REPLACE CARGO_LET WITH DATE()
   REPLACE GEN_LET WITH DATE()
   REPLACE WORK_LET WITH DATE()
   UNLOCK
OTHERWISE
   ? SPACE(MINDENT) + 'We are in receipt of a Certificate of Insurance issued by your insurance'
   ? SPACE(MINDENT) + 'agent.  It does not comply with our requirements.  Please forward an'
   ? SPACE(MINDENT) + 'ammended certificate which reflects the following changes:'
   ?
   MNUMBER = 0
   IF MCHOICE1 <> ' '
      MNUMBER = MNUMBER + 1
      ? SPACE(MINDENT) + space(5) + STR(MNUMBER,1) + '. ' + 'Auto Liability  - $1,000,000 coverage.'
      ?
      DO RECLOCK
      REPLACE AUTO_LET WITH DATE()
      UNLOCK
   ENDIF
   IF MCHOICE2 <> ' '
      MNUMBER = MNUMBER + 1
      ? SPACE(MINDENT) + space(5) + STR(MNUMBER,1) + '. ' + 'General Liability  - $1,000,000 coverage.'
      ?
      DO RECLOCK
      REPLACE GEN_LET WITH DATE()
      UNLOCK
   ENDIF
   IF MCHOICE3 <> ' '
      MNUMBER = MNUMBER + 1
      ? SPACE(MINDENT) + space(5) + STR(MNUMBER,1) + '. ' + 'Cargo Coverage including Refrigeration Breakdown  $125,000 per Vehicle'
      ?
      DO RECLOCK
      REPLACE CARGO_LET WITH DATE()
      UNLOCK
   ENDIF
   IF MCHOICE4 <> ' '
      MNUMBER = MNUMBER + 1
      ? SPACE(MINDENT) + space(5) + STR(MNUMBER,1) + '. ' + "Worker's Compensation"
      ?
      DO RECLOCK
      REPLACE WORK_LET WITH DATE()
      UNLOCK
   ENDIF
ENDCASE

? SPACE(MINDENT) + 'We also require thirty days prior written notice, guaranteed, in the event'
? SPACE(MINDENT) + 'of cancellation or reduction of coverage.  If you have any questions,'
? SPACE(MINDENT) + 'please call our office.'
?
?
?
? SPACE(MINDENT) + SPACE(49) + 'Respectfully,'                       
?
?
?
? SPACE(MINDENT) + SPACE(49) + 'Kenneth Ochs, President'           
EJECT
SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF

RETURN

*Formatted by: ToolBox Ver. 1.2  on 7/21/14 at 12:30 PM.
