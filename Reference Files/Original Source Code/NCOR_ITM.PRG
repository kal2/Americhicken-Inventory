************
* Program.: NCOR_ITM.PRG
* Author..: Grace Keller
* Date....: 04/10/95
* Notice..: CoPyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: CORRECT AN ITEM/SAVE HISTORY
*
STORE MSELL_PRI(MNBR_ITM) TO MORIG_PRICE
STORE MLBS(MNBR_ITM) TO MORIG_LBS
STORE MPURC_TOT(MNBR_ITM) TO MORIG_PURC
STORE MSELL_TOT(MNBR_ITM) TO MORIG_SELL
STORE MLINE TO MSAVE_LINE
**** SAVE THIS INFO COMING IN, IN CASE THEY DO EDITS OVER AND OVER
STORE MQTY(MNBR_ITM) TO MOLD_QTY(MNBR_ITM)
IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MSALESMAN = '11'
   STORE MOUT_LOT(MNBR_ITM) TO MOLD_OUT(MNBR_ITM)
   STORE MIN_LOT(MNBR_ITM) TO  MOLD_IN(MNBR_ITM)
ENDIF

CLEAR
MTITLE = ' - EDIT PO LINE ITEM'
CLEAR 
@  1, 0 SAY MCOMPANY
@  1,68 SAY DATE()
@  2, 0 SAY MPROGRAM + MTITLE
DO TEXT2ND
@ 13,4 SAY '       REASON CODE:'
@ 15,4 SAY 'REASON DESCRIPTION:'
STORE 1 TO MACTION
@ 25,0 SAY 'Action: ' + STR(MACTION,1)
@ 25,12 SAY '1. Finished with Item Edit      2. Edit Screen'
STORE SPACE(10) TO MREAS_CODE
STORE SPACE(25) TO MREAS_DESC
MACTION = 2
DO WHILE MACTION = 2   
   MLINE = 9
   DO GETITM
   IF MPROD(MNBR_ITM) = SPACE(4)
      STORE 0 TO MQTY(MNBR_ITM), MLBS(MNBR_ITM), MBOX_SZ(MNBR_ITM), MOLD_QTY(MNBR_ITM)
      STORE 0 TO MPURC_PRI(MNBR_ITM), MSELL_PRI(MNBR_ITM), MSTOR_ITEM(MNBR_ITM)
      STORE SPACE(2) TO MFR_FZ(MNBR_ITM)
      STORE SPACE(1) TO MPAK1(MNBR_ITM), MPAK2(MNBR_ITM), MGRADE(MNBR_ITM)
      IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
         STORE SPACE(6) TO MPROD(MNBR_ITM), MOLD_PROD(MNBR_ITM)
      ELSE
         STORE SPACE(4) TO MPROD(MNBR_ITM), MOLD_PROD(MNBR_ITM)
      ENDIF
      STORE SPACE(8) TO MPACKSPEC(MNBR_ITM)
      STORE SPACE(10) TO MIN_LOT(MNBR_ITM), MOLD_IN(MNBR_ITM)
      STORE SPACE(10) TO MOUT_LOT(MNBR_ITM), MOLD_OUT(MNBR_ITM)
      STORE SPACE(5) TO MSIZE(MNBR_ITM)
      STORE 0 TO MPAK_YR(MNBR_ITM), MPAK_DAY(MNBR_ITM)
      MACTION = 1
      LOOP
   ENDIF
   @ 13,25 GET MREAS_CODE PICTURE '@!'
   @ 15,25 GET MREAS_DESC PICTURE '@!'
   READ
   STORE 1 TO MACTION
   @ 25,8 GET MACTION PICTURE '#' RANGE 1,2
   READ
ENDDO
**** LOCATE THE RIGHT RECORD AND WRITE BACK
**** ALSO WRITE BACK HISTORY
STORE MLBS(MNBR_ITM) TO MCUR_LBS
***** TOTAL EXTENDED
STORE MSELL_TOT(MNBR_ITM) TO MCUR_SELL
STORE MPURC_TOT(MNBR_ITM) TO MCUR_PURC
***** PRICE PER POUND
STORE MSELL_PRI(MNBR_ITM) TO MCUR_PRICE
STORE MPURC_PRI(MNBR_ITM) TO MPUR_PRICE
MAPPEND = .F.
X = (MSAVE_LINE/2) -3
I = ((MPAGE-1)*7) + X
DO REPLHIST
MPRICE_CHG = .F.
DO REPLITM
IF B->BBUYCODE = 'INVN' .AND. MPRICE_CHG
   @ 25,0 CLEAR
   STORE ' ' TO MWAIT               
   @ 25,1 SAY 'PRICE CHANGE GOING INTO INVEN - MUST CHECK ORDERS SHIPPED OUT ' GET MWAIT
   READ
   @ 25,0 CLEAR
ENDIF

SELECT D
USE
SELECT E
USE
RETURN
* EOF: NCOR_ITM.PRG
*Formatted by: ToolBox Ver. 1.2  on 6/19/2 at 9:45 AM.
