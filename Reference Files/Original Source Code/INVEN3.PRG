*  FILE NAME: INVEN2.PRG
*  BY: 
*  NOTICE: 
*  DATE: 8/8/7
*  DESC:
*  CALLED BY:
*  DATA FILES:
*** GROUT = INVN_DTL TRANSACTIONS FOR CURRENT MONTH

SELECT C
USE INVGRA
INDEX ON FREEZ_LOC + LOT_NBR TO INVGRA
USE INVGRA INDEX INVGRA

SELECT B
USE GROUT

DO WHILE .NOT. EOF()
   
   IF LOT_NBR = 'P' .OR. LOT_NBR = 'U'
      SKIP
      LOOP
   ENDIF
   
   SELECT C
   SEEK B->FREEZ_LOC + B->LOT_NBR   
   
   DO CASE
   CASE EOF()     
      ? 'LOT NUMBER NOT ON FILE'
      SUSPEND
   OTHERWISE
      REPLACE OUT WITH OUT + B->LBS
      REPLACE VAL_OUT WITH VAL_OUT + B->INVVAL_OUT
   ENDCASE
   
   SELECT B
   SKIP
ENDDO
CLOSE DATA
SELECT A
USE INVGRA
REPLAC ALL VAL_CALC WITH VAL_LEFT + VAL_OUT
CLOSE DATA
RETURN
*Formatted by: ToolBox Ver. 1.2  on 8/8/7 at 9:13 AM.
