************
* Program.: AMERICON.PRG
* Author..: GRACE KELLER
* Date....: 10/12/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: MAIN PROGRAM FOR AMERICHICKEN BROKER SYSTEM SYSTEM
*
* ---SET environment.
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     

SET CENTURY ON
SET DELETED ON
SET TALK OFF
SET ECHO OFF
SET BELL OFF
SET MENU OFF
SET SAFETY OFF
SET ESCAPE ON
SET SCOREBOARD ON
SET STATUS OFF
SET EXCLUSIVE OFF
SET UNIQUE OFF
SET PATH TO \AMERIFOX
SET DECIMALS TO 5
SET DEVICE TO SCREEN
INSMODE(.F.)

CLIPPER = .F.
FOXBASE = .T.
MMONO   = .F.

* ---SET COLOR TO values.   (If changed, change other one farther down too)
IF .NOT. MMONO .AND. ISCOLOR()
   SET COLOR TO W+/B,W+/R
ELSE
   SET COLOR TO W/N,N/W
ENDIF

CLOSE ALL
SET DEVICE TO SCREEN

**** FINISHES THE READ WHEN DOING A PAGE DOWN

SELECT A
DO FOX_USE WITH "C:\COMPINFO\SCREEN", .F.
MSCRNSIZE = SCRNSIZE
USE

DO CASE
*** TEST
CASE MSCRNSIZE = 'T'
   DEFINE WINDOW MWINDOW ;
     FROM 2,24 TO 40,252 ;
     FONT "LUCIDA CONSOLE", 18 ;
     COLOR W+/B, W+/R ;
     NONE
*** Jeni
CASE MSCRNSIZE = 'J'
   **GOOD - FROM 2,10 TO 35,200  
   **BETTER-  FROM 2,5 TO 35,210
   DEFINE WINDOW MWINDOW ;
     FROM 2,5 TO 40,210 ;
     FONT "LUCIDA CONSOLE", 16 ;
     COLOR W+/B, W+/R ;
     NONE
*** WIDESCREEN
CASE MSCRNSIZE = 'W'
   DEFINE WINDOW MWINDOW ;
     FROM 5,30 TO 57,272 ;
     FONT "LUCIDA CONSOLE", 20 ;
     COLOR W+/B, W+/R ;
     NONE
*** viewsonic-CAROLYN HIGH RES 
CASE MSCRNSIZE = 'V'
   DEFINE WINDOW MWINDOW ;
     FROM 7,40 TO 60,280 ;
     FONT "LUCIDA CONSOLE", 28 ;
     COLOR W+/B, W+/R ;
     NONE
*** LAPTOP
CASE MSCRNSIZE = 'L'
   DEFINE WINDOW MWINDOW ;
     FROM 2,23 TO 54,265 ;
     FONT "LUCIDA CONSOLE", 20 ;
     COLOR W+/B, W+/R ;
     NONE
*** OTHER - SQUARE 
OTHERWISE
   DEFINE WINDOW MWINDOW ;
     FROM 5,4 TO 57,200 ;
     FONT "LUCIDA CONSOLE", 19 ;
     COLOR W+/B, W+/R ;
     NONE
ENDCASE

ACTIVATE WINDOW "MWINDOW"

* ---MAIN PROCESSING LOOP
CLEAR
SET COLOR TO W/W,W/W
SET COLOR TO W+/B+,W+/R+
CLEAR

* ---Initialize global variables.
SELECT A
DO FOX_USE WITH "COMPANY", .F.
MCOMPANY = TRIM(COMPANY)
MMASTDBF = TRIM(MASTDBF)
MDBFLOC = TRIM(DBFLOC)
USE

SELECT A
DO FOX_USE WITH "&MMASTDBF.CONTROL", .F.
MPROGRAM = TRIM(PROGRAM)
MPROG_CODE = PROG_CODE
USE

IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SELECT A
   DO FOX_USE WITH "C:\COMPINFO\PRINTERS", .F.
   MPRINTER  = TRIM(PRINTER1)
   MPRINTER1 = TRIM(PRINTER1)
   MPRINTER2 = TRIM(PRINTER2)
   MPRINTER3 = TRIM(PRINTER3)
   USE
ELSE
   MPRINTER  = 'DONOTPRINT'
   MPRINTER1 = 'DONOTPRINT'
   MPRINTER2 = 'DONOTPRINT'
   MPRINTER3 = 'DONOTPRINT'
ENDIF  

MPRINTIT  = 'COPY C:\COMPINFO\PRT_FILE.TXT ' + MPRINTER
MPRINTIT1 = 'COPY C:\COMPINFO\PRT_FILE.TXT ' + MPRINTER1
MPRINTIT2 = 'COPY C:\COMPINFO\PRT_FILE.TXT ' + MPRINTER2
MPRINTIT3 = 'COPY C:\COMPINFO\PRT_FILE.TXT ' + MPRINTER3


**********************************************************************
**** THIS WORKS - BUT GIVES AN EXTRA EJECT AT THE END OF JOB**********
**** ORIGINALLY HAD THIS WAY FOR STODDARD COUNTY
**MPRINTIT = "PRINT.EXE /D:" + MPRINTER + " C:\COMPINFO\PRT_FILE.TXT"
**********************************************************************

****TESTING************
****MPRINTIT = "PRINT.EXE /D:\\GRACE64-HP\HP4250 \COMPINFO\PRTFILE.TXT"
****MPRINTIT = "PRINT.EXE /D:\\GINGER-PC\HP940C \REPORTS\PRTFILE.TXT"
*** END OF TESTING*****
************************************************************************

STORE 'BROKER SYSTEM' TO MPROGRAM

STORE .T. TO MONO

MPASSWORD = 'ADM99'
MUSER = 'SUPERVISOR'
MSECURITY = .T.

SET PROC TO SUP_PROC
DO PUBLRSUP   
DO PUBLSUPP
SET PROC TO BUY_PROC
DO PUBLBBUY
DO PUBLBUY
SET PROC TO FRT_PROC
DO PUBLFRT
SET PROC TO PO_PROC
DO PUBLPO
*ON ERROR DO ERR_HAND
***ON KEY=315 DO USERHLP WITH SYS(16) 

ON KEY LABEL F1 DO USERHLP WITH SYS(16)
ON KEY LABEL F5 DO BBUYFSEL
ON KEY LABEL PGUP CLEAR READ
ON KEY LABEL PGDN CLEAR READ

CLEAR
@ 0,0 SAY MCOMPANY
@ 01,68 SAY DATE()
@ 1,0 SAY MPROGRAM + ' - SECURITY PASSWORD SCREEN'
@ 2,0 TO 24,79
STORE SPACE(5) TO MPASSWORD
@ 10,08 say 'Enter Password: '
SET COLOR TO W/W,W/W
SET CONFIRM ON
@ 10,24 GET MPASSWORD PICTURE '@!'
READ
SET COLOR TO W+/B+,W+/R+
SET CONFIRM OFF
STORE UPPER(SUBSTR(CDOW(DATE()),1,3)) TO MDAY
STORE (MDAY + STR(100 - DAY(DATE()),2)) TO MGUESS

IF MPASSWORD <> 'ADM99' .AND. MPASSWORD <> MGUESS
   MWAIT = ' '
   @ 15,10 SAY 'SECURITY VIOLATION !!!!   INVALID PASSWORD'
   @ 17,10 SAY 'RETURNING TO DESKTOP MENU - PRESS ENTER/RETURN KEY' GET MWAIT
   READ
   CLOSE DATA
   QUIT
ENDIF

STORE ' ' TO MSELECTION
DO WHILE MSELECTION <> '9'
   CLOSE DATA
   CLEAR
   @ 00,00 SAY Mcompany
   @ 01,68 SAY DATE()
   @ 01,00 SAY MPROGRAM + ' - MAIN MENU'
   @ 2,0 TO 24,79
   *  STORE 'COPYRIGHT (C) 1987-2014 SOLID SOFTWARE, INC.  ALL RIGHTS RESERVED.' ;
   *     TO MCOPR
   
   *  @ 24,40-LEN(MCOPR)/2 SAY MCOPR
   
   @ 04,10 SAY '1 - PURCHASE ORDERS'
   @ 06,10 SAY '2 - CUSTOMER INVOICES'
   @ 08,10 SAY '3 - DISBURSEMENTS / SUPPLIER INVOICES'
   @ 10,10 SAY '4 - RECEIPTS'
   @ 12,10 SAY '5 - JOURNAL/LEDGER POSTING'
   @ 14,10 SAY '6 - REPORTS'
   IF MCOMPANY = 'AMERICHICKEN, INC'
      @ 16,10 SAY '7 - INVENTORY - REPORTS/VIEW ACTIVITY'
   ENDIF
   @ 18,10 SAY '8 - FILE MAINTENANCE'
   @ 20,10 SAY '9 - EXIT'
   
   STORE '1' TO MSELECTION
   @ 22,02 SAY 'CHOICE: '
   @ 22,10 GET MSELECTION PICTURE '9'
   READ

   **CLEAR GETS
   **@ 22,09 SAY ' '
   **MSELECTION = INKEY(60)
   **IF MSELECTION = 0
   **   CLEAR
   **   SET COLOR TO W+/B,W+/R
   **   MSELECTION = INKEY(0)
   **   MSELECTION = '0'
   **ELSE
   **   DO CASE
   **   CASE MSELECTION < 0
   **      IF MSELECTION = -4
   **         SET PROC TO BUY_PROC
   **         DO CUSTINQ      
   **         SET PROC TO PO_PROC     
   **      ENDIF
   **      MSELECTION = '0'
   **   OTHERWISE
   **      IF MSELECTION = 13
   **         MSELECTION = '1'
   **      ELSE
   **         MSELECTION = CHR(MSELECTION)
   **      ENDIF
   **   ENDCASE
   **ENDIF
   
   SET PROCEDURE TO PO_PROC
   DO CASE
      
   CASE MSELECTION = '1'
      DO PO      
      MSELECTION = ' '
   CASE MSELECTION = '2'
      DO CUS_INV 
      MSELECTION = ' '
   CASE MSELECTION = '3'
      DO MID_PAY
      MSELECTION = ' '
   CASE MSELECTION = '4'
      DO BUY_PAY
      MSELECTION = ' '
   CASE MSELECTION = '5'
      DO ACCTMENU      
      MSELECTION = ' '
   CASE MSELECTION = '6'
      DO REPORTS 
      MSELECTION = ' '
   CASE MSELECTION = '7'
      IF MCOMPANY = 'AMERICHICKEN, INC'
         DO INVNPROC
      ENDIF
      MSELECTION = ' '
   CASE MSELECTION = '8'
      DO MAINT   
      MSELECTION = ' '
   ENDCASE
   *  CLOSE DATA
ENDDO

* ---Closing operations.

CLEAR
QUIT         
*RETURN
* EOF: AMERICON.PRG
*Formatted by: ToolBox Ver. 1.2  on 3/12/96 at 2:39 PM.
