************  
* Program.: PRT_ONE.PRG
* Author..: Grace Keller
* Date....: 01/21/97
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: PRINT ORDER                
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     

SELECT A
USE
SELECT D
USE
SELECT E
USE
SELECT F
USE

STORE 'C' TO MPRT_ACT
DO PRT_12I
IF MPRT_ACT <> 'C'
   RETURN
ENDIF

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

** GOTHIC 12 BOLD
?? CHR(27) + '(s0p12h0s3b4102T'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

MPAGE_NBR = 1

**** DO ALL THE NAME/ADDRESS SEARCHING HERE
SELECT B
STORE SALESMAN TO MSALESMAN
STORE PO_NBR TO MPO_NBR
STORE PO_SUFFIX TO MPO_SUFFIX
STORE BUY_CODE TO MBUY_CODE
STORE BBUYCODE TO MBBUYCODE
STORE RSUPCODE TO MRSUPCODE
STORE SUP_CODE TO MSUP_CODE
STORE FRT_CODE1 TO MFRT_CODE1
STORE COM_CODE TO MCOM_CODE
STORE COM_CODE2 TO MCOM_CODE2
STORE COM_CODE3 TO MCOM_CODE3
IF FRT2_FLG = 'Y'
   SELECT E
   DO FOX_USE WITH "FRT_2ND INDEX FRT2_PO", .F.
   SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
   STORE FRT_CODE2 TO MFRT_CODE2
   STORE FRT_AMT2 TO  MFRT_AMT2
   USE
   SELECT B
ELSE
   STORE SPACE(4) TO MFRT_CODE2
   STORE 0 TO MFRT_AMT2
ENDIF

IF FRT3_FLG = 'Y'
   SELECT E
   DO FOX_USE WITH "FRT_3RD INDEX FRT3_PO", .F.
   SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
   STORE FRT_CODE3 TO MFRT_CODE3
   STORE FRT_AMT3 TO  MFRT_AMT3
   USE
   SELECT B
ELSE
   STORE SPACE(4) TO MFRT_CODE3
   STORE 0 TO MFRT_AMT3
ENDIF

IF MISC_FLG = 'Y'
   SELECT E
   DO FOX_USE WITH "MISC_CHG INDEX MISC_CHG", .F.
   SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
   STORE MISCAMT1 TO MMISCAMT1   
   STORE MISCAMT2 TO MMISCAMT2   
   STORE MISCAMT3 TO MMISCAMT3   
   STORE MISCREAS1 TO MMISCREAS1
   STORE MISCREAS2 TO MMISCREAS2
   STORE MISCREAS3 TO MMISCREAS3
   USE
   SELECT B
ELSE
   STORE 0 TO MMISCAMT1, MMISCAMT2, MMISCAMT3
   STORE SPACE(10) TO MMISCREAS1, MMISCREAS2, MMISCREAS3
ENDIF

IF MCOM_CODE <> SPACE(2)
   SELECT E
   DO FOX_USE WITH "&mdbfloc.compayee INDEX &mdbfloc.com_code", .F.
   SEEK MCOM_CODE
   STORE NAME TO MCOM_NAME
ELSE
   STORE SPACE(32) TO MCOM_NAME
ENDIF

IF MCOM_CODE2 <> SPACE(2)
   SELECT E
   DO FOX_USE WITH "&mdbfloc.compayee INDEX &mdbfloc.com_code", .F.
   SEEK MCOM_CODE2
   STORE NAME TO MCOM_NAME2
ELSE
   STORE SPACE(32) TO MCOM_NAME2
ENDIF

IF MCOM_CODE3 <> SPACE(2)
   SELECT E
   DO FOX_USE WITH "&mdbfloc.compayee INDEX &mdbfloc.com_code", .F.
   SEEK MCOM_CODE3
   STORE NAME TO MCOM_NAME3
ELSE
   STORE SPACE(32) TO MCOM_NAME3
ENDIF

***************************
** GET CUSTOMER INFORMATION
***************************
SELECT E
DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_CODE", .F.
SEEK MBUY_CODE
IF .NOT. EOF()
   STORE NAME TO MCUS_NAME       
   STORE STREET TO MCUS_STRT  
   IF ZIP4 = SPACE(4)
      STORE ZIP + SPACE(5) TO MCUS_ZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MCUS_ZIP 
   ENDIF
   STORE TRIM(CITY) + ', ' + STATE  + '  ' + MCUS_ZIP TO MCUS_CITYST
ELSE
   IF MBUY_CODE = 'NONE'
      STORE 'NONE               '+ SPACE(13) TO MCUS_NAME
      STORE 'NONE' TO MCUS_CITYST
   ELSE
      STORE 'SHIP TO NOT ON FILE'+ SPACE(13) TO MCUS_NAME
      STORE SPACE(22) TO MCUS_CITYST
   ENDIF
   STORE SPACE(28) TO MCUS_STRT           
   STORE SPACE(11) TO MCUS_ZIP
ENDIF
MCUS_CITYST = TRIM(MCUS_CITYST)

STORE 0 TO MCUS_BAL, MAVG_25, MHOLD_BAL, MCRED_LIM
STORE CTOD('') TO MLAST_PAID
DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYCODE", .F.
SEEK MBBUYCODE
IF .NOT. EOF()
   IF MBBUYCODE <> 'NONE'
      STORE CUS_BAL TO MCUS_BAL
      IF SHIPS_25 <> 0 .AND. DAYS_25 <> 0
         MAVG_25 = ROUND(DAYS_25/SHIPS_25,0)
      ELSE
         MAVG_25 = 0
      ENDIF
      STORE CRED_LIM TO MCRED_LIM
   ENDIF
   STORE NAME TO MBIL_NAME
   STORE STREET TO MBIL_STRT
   IF ZIP4 = SPACE(4)
      STORE ZIP + SPACE(5) TO MBIL_ZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MBIL_ZIP 
   ENDIF
   STORE TRIM(CITY) + ', ' + STATE  + '  ' + MBIL_ZIP TO MBIL_CITYST
ELSE
   IF MBBUYCODE = 'NONE'
      STORE 'NONE               '+ SPACE(13) TO MBIL_NAME
      STORE 'NONE' TO MBIL_CITYST
   ELSE
      STORE 'BILL TO NOT ON FILE' + SPACE(13) TO MBIL_NAME
      STORE 'UNKNOWN CITY/STATE/ZIP' TO MBIL_CITYST
   ENDIF'
   STORE SPACE(11) TO MBIL_ZIP
   STORE SPACE(28) TO MBIL_STRT
ENDIF
MBIL_CITYST = TRIM(MBIL_CITYST)

***************************
** GET SUPPLIER INFORMATION
***************************
DO FOX_USE WITH "&MDBFLOC.SUPPLIER INDEX &MDBFLOC.SUP_CODE", .F.
SEEK MSUP_CODE
IF .NOT. EOF()
   STORE NAME TO MSUP_NAME       
   STORE STREET TO MSUP_STRT  
   IF ZIP4 = SPACE(4)
      STORE ZIP + SPACE(5) TO MSUP_ZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MSUP_ZIP 
   ENDIF
   STORE TRIM(CITY) + ', ' + STATE  + '  ' + MSUP_ZIP TO MSUP_CITYST
ELSE
   IF MSUP_CODE = 'NONE'
      STORE 'NONE                    '+ SPACE(8) TO MSUP_NAME
      STORE 'NONE' TO MSUP_CITYST    
   ELSE
      STORE 'SHIPPED FROM NOT ON FILE'+ SPACE(8) TO MSUP_NAME
      STORE SPACE(22) TO MSUP_CITYST
   ENDIF
   STORE SPACE(28) TO MSUP_STRT           
   STORE SPACE(11) TO MSUP_ZIP
ENDIF
MSUP_CITYST = TRIM(MSUP_CITYST)

DO FOX_USE WITH "&MDBFLOC.REM_SUP INDEX &MDBFLOC.RSUPCODE", .F.
SEEK MRSUPCODE
IF .NOT. EOF()
   STORE NAME TO MREM_NAME       
   STORE STREET TO MREM_STRT  
   IF ZIP4 = SPACE(4)
      STORE ZIP + SPACE(5) TO MREM_ZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MREM_ZIP 
   ENDIF
   STORE TRIM(CITY) + ', ' + STATE  + '  ' + MREM_ZIP TO MREM_CITYST
ELSE
   IF MRSUPCODE = 'NONE'
      STORE 'NONE                    ' + SPACE(8) TO MREM_NAME
      STORE 'NONE                  ' TO MREM_CITYST
   ELSE
      STORE 'SUP REMIT TO NOT ON FILE'+ SPACE(8) TO MREM_NAME
      STORE 'UNKNOWN CITY/STATE/ZIP' TO MREM_CITYST
   ENDIF
   STORE SPACE(11) TO MREM_ZIP
   STORE SPACE(28) TO MREM_STRT           
ENDIF

SELECT F
DO FOX_USE WITH "&MMASTDBF.SALESMAN INDEX &MMASTDBF.SAL_CODE", .F.
SEEK MSALESMAN
IF .NOT. EOF()
   MSAL_NAME = NAME
ELSE
   MSAL_NAME = 'SALESPERSON NAME NOT ON FILE' + SPACE(4)
ENDIF

DO FOX_USE WITH "&MDBFLOC.FREIGHT INDEX &MDBFLOC.FRT_CODE", .F.
IF MFRT_CODE1 = 'CUST'
   STORE 'CUSTOMER PICK UP' TO MFRT_NAME1
ELSE 
   IF MFRT_CODE1 = 'NONE'
      STORE 'DELIVERED' TO MFRT_NAME1
   ELSE
      SEEK MFRT_CODE1                
      IF .NOT. EOF()
         STORE NAME TO MFRT_NAME1
      ELSE
         STORE 'FREIGHT NOT ON FILE' TO MFRT_NAME1
      ENDIF
   ENDIF
ENDIF

IF MFRT_CODE2 <> SPACE(4)
   IF MFRT_CODE2 = 'CUST'
      STORE 'CUSTOMER PICK UP' TO MFRT_NAME2
   ELSE 
      IF MFRT_CODE2 = 'NONE'
         STORE 'DELIVERED' TO MFRT_NAME2
      ELSE
         SEEK MFRT_CODE2                
         IF .NOT. EOF()
            STORE NAME TO MFRT_NAME2
         ELSE
            STORE 'FREIGHT NOT ON FILE' TO MFRT_NAME2
         ENDIF
      ENDIF
   ENDIF
ELSE
   STORE SPACE(32) TO MFRT_NAME2
ENDIF

IF MFRT_CODE3 <> SPACE(4)
   IF MFRT_CODE3 = 'CUST'
      STORE 'CUSTOMER PICK UP' TO MFRT_NAME3
   ELSE 
      IF MFRT_CODE3 = 'NONE'
         STORE 'DELIVERED' TO MFRT_NAME3
      ELSE
         SEEK MFRT_CODE3                
         IF .NOT. EOF()
            STORE NAME TO MFRT_NAME3
         ELSE
            STORE 'FREIGHT NOT ON FILE' TO MFRT_NAME3
         ENDIF
      ENDIF
   ENDIF
ELSE
   STORE SPACE(32) TO MFRT_NAME3
ENDIF

SELECT B

? SPACE(3) + 'PRINT DATE'

** THIS IS THE PRINT ROUTINE
*** FONT ARIAL BOLD
?? CHR(27) + '(s1p10v0s3b16602T'

*** POINT HEIGHT 20 - DEFAULT IS 12
?? CHR(27) + '(s20V'

??  SPACE(20) + 'AMERICHICKEN, INC' + SPACE(15)

IF SALESMAN <> SPACE(2)
   ?? SALESMAN + '-'
ELSE
   ?? SPACE(3)
ENDIF
?? PO_NBR
IF PO_SUFFIX <> ' '
   ?? '-' + PO_SUFFIX
ENDIF

** GOTHIC 12 BOLD
?? CHR(27) + '(s0p12h0s3b4102T'

?
?  SPACE(3)   
?? DTOC(DATE())

?
?   SPACE(3) + 'ORDER DT: ' + DTOC(ORD_DATE) + SPACE(3)
?? 'SHIP DT: ' + DTOC(SHIP_DATE) + SPACE(3)
?? 'DELIV DT: ' + DTOC(DEL_REQD) + SPACE(3)
?? 'CUST PO#: ' + BUYER_PO              
?

? SPACE(3) 
*** UNDERLINE ON
?? CHR(27) + '&d0D'

?? 'SHIPPED FROM SUPPLIER:'+ SPACE(10)
*** UNDERLINE OFF
?? CHR(27) + '&d@'
?? SPACE(10)

*** UNDERLINE ON
?? CHR(27) + '&d0D'
?? 'REMIT TO SUPPLIER:' + SPACE(14)
*** UNDERLINE OFF
?? CHR(27) + '&d@'

? SPACE(3) + MSUP_NAME + SPACE(10) + MREM_NAME
? SPACE(3) + MSUP_STRT + SPACE(14) + MREM_STRT
? SPACE(3) + MSUP_CITYST + SPACE(42-LEN(MSUP_CITYST)) + MREM_CITYST

?
? SPACE(3)

*** UNDERLINE ON
?? CHR(27) + '&d0D'
?? 'SHIPPED TO CUSTOMER:' + SPACE(12)
*** UNDERLINE OFF
?? CHR(27) + '&d@'
?? SPACE(10) 

*** UNDERLINE ON
?? CHR(27) + '&d0D'
?? 'BILL TO CUSTOMER: ' + SPACE(15)
*** UNDERLINE OFF
?? CHR(27) + '&d@'

? SPACE(3) + MCUS_NAME + SPACE(10) + MBIL_NAME
? SPACE(3) + MCUS_STRT + SPACE(14) + MBIL_STRT
? SPACE(3) + MCUS_CITYST + SPACE(42-LEN(MCUS_CITYST)) + MBIL_CITYST

IF B->PU_LOC <> SPACE(25)
   MPRT_LOC = B->PU_LOC
   MPRT_LOC = TRIM(MPRT_LOC)
   MSPACEIT = 93 - LEN(MPRT_LOC)
   ? SPACE(3) + SPACE(MSPACEIT) + MPRT_LOC
ELSE
   ?
ENDIF

SELECT A
USE
SELECT D
USE
SELECT E
USE
SELECT F
USE
RELEASE MBIL_NAME, MREM_NAME
RELEASE MCUS_ZIP, MBIL_ZIP, MSUP_ZIP, MREM_SUP
RELEASE MCUS_CITYST, MBIL_CITYST, MSUP_CITYST, MREM_CITYST
RELEASE MCUS_STRT, MBIL_STRT, MSUP_STRT, MREM_STRT

? SPACE(3) + REPLICATE('=',93)
? SPACE(3) + 'ITM  CS PRODUCT / PACKAGING / SIZE DESCRIPTION'
IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
   ?? SPACE(19) + 'QTY SHIP              $ SELL'
ELSE
   ?? SPACE(19) + 'QTY SHIP   $ PURCH    $ SELL'
ENDIF
? SPACE(3) + REPLICATE('=',93)
MTOT_SELL = 0
MTOT_PUR  = 0
MTOT_FRT  = 0
MTOT_LBS  = 0
MTOT_ALBS = 0
MTOT_CASE = 0
SELECT C
SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
MCOUNT = 0
MLINE = 20

DO WHILE .NOT. EOF() .AND. MSALESMAN = SALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX
   IF PROD_DESC = SPACE(4)                           
      SKIP
      LOOP
   ENDIF
   MCOUNT = MCOUNT + 1
   
   STORE SPACE(6) TO MPART1
   STORE SPACE(8) TO MPART2, MPART3, MPART6
   STORE SPACE(9) TO MPART3_X
   STORE SPACE(20) TO MPART4
   STORE SPACE(13) TO MPART5
   
   SELECT F
   DO FOX_USE WITH "&MDBFLOC.PRODUCTS INDEX &MDBFLOC.PRODUCTS", .F.
   IF C->FRH_FRZ <> SPACE(2)
      SEEK 'F' + C->FRH_FRZ
      IF .NOT. EOF()
         STORE SUBSTR(DESC,1,6) TO MPART1
      ENDIF
   ENDIF
   
   IF C->GRADE <> SPACE(1)
      SEEK 'G' + C->GRADE
      IF .NOT. EOF()
         STORE SUBSTR(DESC,1,8) TO MPART2
      ENDIF
   ENDIF
   
   IF SUBSTR(C->PACKAGED,1,1) <> SPACE(1)
      SEEK 'D' + SUBSTR(C->PACKAGED,1,1)
      IF .NOT. EOF()
         STORE SUBSTR(DESC,1,8) TO MPART3
      ENDIF
   ENDIF
   
   IF SUBSTR(C->PACKAGED,2) <> SPACE(1)
      SEEK 'K' + SUBSTR(C->PACKAGED,2)
      IF .NOT. EOF()
         STORE SUBSTR(DESC,1,9) TO MPART3_X
      ENDIF
   ENDIF
   
   IF MPART3 = SPACE(8)
      MPART3 = MPART3_X             
   ELSE
      MPART3 = TRIM(MPART3) + ' ' + MPART3_X  
   ENDIF
   
   SEEK 'R' + C->PROD_DESC
   IF .NOT. EOF()
      STORE DESC TO MPART4 
   ENDIF
   
   IF C->SIZE <> SPACE(5)
      SEEK 'Z' + C->SIZE
      IF .NOT. EOF()
         STORE SUBSTR(DESC,1,13) TO MPART5
      ENDIF
   ENDIF
   
   IF C->PACKED <> SPACE(8)
      SEEK 'S' + C->PACKED
      IF .NOT. EOF()
         STORE SUBSTR(DESC,1,11) TO MPART6
      ENDIF
   ENDIF
   
   SELECT C
   ? SPACE(3) + SUBSTR(ITEM_NBR,2) + '. ' + TRANSFORM(QTY, '@Z 9999') + SPACE(1)
   MLINE = MLINE + 1
   
   MPRT_LINE = ' '
   MPART1 = TRIM(MPART1)
   MPART2 = TRIM(MPART2)
   MPART3 = TRIM(MPART3)
   MPART4 = TRIM(MPART4)
   MPART5 = TRIM(MPART5)
   MPART6 = TRIM(MPART6)
   
   MLEN1 = LEN(MPART1)
   MLEN2 = LEN(MPART2)
   MLEN3 = LEN(MPART3)
   MLEN4 = LEN(MPART4)
   MLEN5 = LEN(MPART5)
   MLEN6 = LEN(MPART6)
   IF MLEN1 <> 0
      MPRT_LINE = MPRT_LINE + MPART1 + ' '
   ENDIF
   IF MLEN2 <> 0
      MPRT_LINE = MPRT_LINE + MPART2 + ' '
   ENDIF
   IF MLEN4 <> 0
      MPRT_LINE = MPRT_LINE + MPART4 + ' '
   ENDIF
   IF MLEN5 <> 0
      MPRT_LINE = MPRT_LINE + MPART5 + ' '
   ENDIF
   IF MLEN6 <> 0
      MPRT_LINE = MPRT_LINE + MPART6 + ' '
   ENDIF
   IF MLEN3 <> 0
      MPRT_LINE = MPRT_LINE + MPART3 + ' '
   ENDIF
   
   MPRT_LINE = TRIM(SUBSTR(MPRT_LINE,2))
   MTOT_LEN = LEN(MPRT_LINE)
   
   IF MTOT_LEN > 58
      ?? SUBSTR(MPRT_LINE,1,58)
      MTOT_LEN = 58
   ELSE
      ?? MPRT_LINE
   ENDIF
   
   MDIFF = 56 - MTOT_LEN
   ?? SPACE(MDIFF)             
   
   ?? TRANSFORM(LBS, '999999.99')
   IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      ?? SPACE(10)
   ELSE
      ?? SPACE(1) + TRANSFORM(TOT_PURCH, '999999.99')
   ENDIF
   ?? SPACE(1) + TRANSFORM(TOT_SELL, '999999.99')
   *IF SUP_PCODE <> SPACE(10)  
   *   ? SPACE(3) + SPACE(8) + 'VENDOR CODE #: ' + SUP_PREFX + SUP_PCODE
   *   MLINE = MLINE + 1
   *ENDIF                  
   
   ? SPACE(3) + REPLICATE('-',93)
   MLINE = MLINE + 1
   
   **?? SPACE(4) + TRANSFORM(PUR_PRICE, '99.9999')
   **?? SPACE(4) + TRANSFORM(SEL_PRICE, '99.9999')
   
   *? SPACE(3)
   *?? CHR(27) + '-' + '1'
   *??  SPACE(65) 
   *?? SPACE(06)                          
   *?? SPACE(1) + TRANSFORM(TOT_PURCH, '999,999.99')
   *?? SPACE(1) + TRANSFORM(TOT_SELL, '999,999.99') + SPACE(2)
   *?? CHR(27) + '-' + '0'
   *?
   MTOT_SELL = MTOT_SELL + TOT_SELL
   MTOT_PUR  = MTOT_PUR  + TOT_PURCH
   MTOT_LBS  = MTOT_LBS  + LBS
   MTOT_CASE = MTOT_CASE + QTY
   DO CASE
   CASE SUBSTR(PACKED,1,1) = 'B'
      MX = VAL(SUBSTR(PACKED,2))
      MTOT_ALBS = MTOT_ALBS + ROUND(MX*LBS,2)
   OTHERWISE
      MTOT_ALBS = MTOT_ALBS + LBS
   ENDCASE
   
   SKIP
ENDDO


?
? SPACE(3)
?? SPACE(3) + TRANSFORM(MTOT_CASE, '9999') 
?? SPACE(20)
IF MTOT_ALBS = MTOT_LBS
   ?? SPACE(14)
ELSE
   ?? 'LBS= ' + TRANSFORM(MTOT_ALBS, '999999.99')
ENDIF
?? SPACE(8) + 'TOTALS:   ' + SPACE(5)

?? TRANSFORM(MTOT_LBS, '999999.99')
IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
   ?? SPACE(10)
ELSE
   ?? SPACE(1) + TRANSFORM(MTOT_PUR, '999999.99')
ENDIF
?? SPACE(1) + TRANSFORM(MTOT_SELL, '999999.99')
?
MLINE = MLINE + 3

IF (MCOUNT*3) + MLINE > 54
   ? SPACE(3) + SPACE(20) + '*********>  ORDER CONTINUED ON NEXT PAGE  <*********'
   ?
   EJECT
   DO ORD_HEAD
ENDIF

MLINE = MLINE + (MCOUNT*3) + 4

SELECT C
SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
? SPACE(3) + REPLICATE('=',93)
? SPACE(3) 

?? '|' + 'ITEM ' + '|' + ' CASE ' + '|' + 'UNIT PACK ' + '|' + 'FR/Z' + '|' + 'PTY' +  '|' + 'REF'
??  '|' + 'PAK' + '|' + 'PRODCT' + '|' + ' SIZE  '+ '|' + 'SHIPPED QTY'  
IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
   ?? '|' + '           '+  '|' + ' SELL PRICE' +  '|'
ELSE
   ?? '|' + '  PUR PRICE'+  '|' + ' SELL PRICE' +  '|'
ENDIF
*** BLANK LINE
? SPACE(3) + '|' + SPACE(5) + '|' + SPACE(6) + '|'+ SPACE(10) + '|' + SPACE(4) + '|' + SPACE(3) +  '|' + SPACE(3)   
??  '|' + SPACE(3) + '|' + SPACE(6) + '|' + SPACE(7) + '|' + SPACE(11)      
?? '|' + SPACE(11) +  '|' + SPACE(11) +  '|'


DO WHILE .NOT. EOF() .AND. MSALESMAN = SALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX
   IF PROD_DESC = SPACE(4)                           
      SKIP
      LOOP
   ENDIF
   
   ? SPACE(3) + '|' +  ' ' + ITEM_NBR
   ?? '. '
   ?? '|'+ ' ' + TRANSFORM(QTY,'9999') + ' ' + '|'+ ' '
   IF MCOMPANY = 'DIVISION 15'
      ?? PACKED + ' ' + '|'
   ELSE
      ?? PACKED + ' ' + SPACE(4) + '|'
   ENDIF
   ?? ' ' + FRH_FRZ + ' ' + '|' + ' '
   ?? GRADE + ' ' + '|' + ' ' + SUBSTR(PACKAGED,1,1) + ' '
   ??  '|' + ' ' + SUBSTR(PACKAGED,2) + ' ' +  '|'
   IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      ?? SUBSTR(PROD_DESC,1,6)
   ELSE
      ?? ' ' + SUBSTR(PROD_DESC,1,4) + ' '
   ENDIF
   ?? '|' + ' ' + SIZE
   ?? ' ' + '|' + '  ' + TRANSFORM(LBS,'999999.99')     
   IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      ??   '|' + '   ' + SPACE(7) + ' ' +  '|' + '   '
   ELSE
      ??   '|' + '   ' + TRANSFORM(PUR_PRICE,'99.9999') + ' ' +  '|' + '   '
   ENDIF
   ?? TRANSFORM(SEL_PRICE,'99.9999')+ ' ' +  '|'
   
   ? SPACE(3) + '|' + SPACE(5) + '|'
   
   IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      IF B->RSUPCODE = 'INVN'
         ?? 'OUT LT ' + OUT_LOT
      ELSE
         ?? SPACE(6) + '|' + SPACE(10)
      ENDIF
   ELSE
      ?? SPACE(6) + '|' + SPACE(10)
   ENDIF

   DO CASE
   CASE B->BBUYCODE = 'INVN'
      SELECT E
      DO FOX_USE WITH "INVEN INDEX INVNLOC", .F.
      SEEK MCUS_NAME + C->IN_LOT
      IF .NOT. EOF()
         STORE PAK_DAY TO MPAK_DAY
         STORE PAK_YR  TO MPAK_YR
      ELSE
         DO FOX_USE WITH "HINVEN INDEX HINVNLOC", .F.
         SEEK MCUS_NAME + C->IN_LOT
         IF .NOT. EOF()
            STORE PAK_DAY TO MPAK_DAY
            STORE PAK_YR  TO MPAK_YR
         ELSE
            STORE 0 TO MPAK_DAY, MPAK_YR
         ENDIF
      ENDIF
      USE
      SELECT C
      ?? '|'  + ' PAK DT   '
      ?? STR(MPAK_YR,2) + '/' + SUBSTR(STR(MPAK_DAY+1000,4),2)
      ?? '|' + SPACE(6) + '|'
   CASE B->RSUPCODE = 'INVN'
      SELECT E
      DO FOX_USE WITH "INVEN INDEX INVNLOC", .F.
      SEEK MSUP_NAME + C->OUT_LOT
      IF .NOT. EOF()
         STORE PAK_DAY TO MPAK_DAY
         STORE PAK_YR  TO MPAK_YR
      ELSE
         DO FOX_USE WITH "HINVEN INDEX HINVNLOC", .F.
         SEEK MSUP_NAME + C->OUT_LOT
         IF .NOT. EOF()
            STORE PAK_DAY TO MPAK_DAY
            STORE PAK_YR  TO MPAK_YR
         ELSE
            STORE 0 TO MPAK_DAY, MPAK_YR
         ENDIF
      ENDIF
      USE
      SELECT C
      ?? '|'  + ' PAK DT   '
      ?? STR(MPAK_YR,2) + '/' + SUBSTR(STR(MPAK_DAY+1000,4),2)
      ?? '|' + SPACE(6) + '|'
   OTHERWISE
      ?? '|' + SPACE(4)
      ?? '|' + SPACE(3)
      ?? '|' + SPACE(3)
      ?? '|' + SPACE(3)
      ?? '|' + SPACE(6) + '|'
   ENDCASE

   IF MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      IF B->BBUYCODE = 'INVN'
         ?? 'IN LT ' + IN_LOT + SPACE(3)
      ELSE
         ??  SPACE(7) + '|' + SPACE(8) + SPACE(3)
      ENDIF
   ELSE
      ??  SPACE(7) + '|' + SPACE(8) + SPACE(3)
   ENDIF
   ?? '|'+ SPACE(11)
   ?? '|' + SPACE(11) +  '|'
   
   *** BLANK LINE
   ? SPACE(3) + '|' + REPLICATE('-',91) + '|'
   
   SKIP
ENDDO

? SPACE(3) + REPLICATE('=',93)
SELECT B

MPRT_ADJ = .T.
IF MPRT_ADJ
   IF CUS_AMT1 <> 0 .OR. CUS_AMT2 <> 0 .OR. CUS_PALL <> 0
      IF MLINE > 54
         ? SPACE(3) + SPACE(20) + '*********>  ORDER CONTINUED ON NEXT PAGE  <*********'
         ?
         EJECT
         DO ORD_HEAD
      ENDIF
      ?  SPACE(3) + '1. CUST ADJUST: ' + CUS_REAS1 + SPACE(2) + TRANSFORM(CUS_AMT1, '9,999,999.99') + SPACE(3)
      ?? '2. CUST ADJUST: ' + CUS_REAS2 + SPACE(1) + TRANSFORM(CUS_AMT2, '9,999,999.99')
      ? SPACE(3) + 'CUSTOMER PALLETS        ' + SPACE(15) + SPACE(05) + TRANSFORM(SUP_PALL, '9,999,999.99')
      MTOT_SELL = MTOT_SELL + + CUS_AMT1 + CUS_AMT2 + CUS_PALL
      ? SPACE(3) + REPLICATE('=',94)
   ENDIF
   
   IF SUP_AMT1 <> 0 .OR. SUP_AMT2 <> 0 .OR. SUP_PALL <> 0
      IF MLINE > 54
         ? SPACE(3) + SPACE(20) + '*********>  ORDER CONTINUED ON NEXT PAGE  <*********'
         ?
         EJECT
         DO ORD_HEAD
      ENDIF
      ? SPACE(3) + '1. SUPP ADJUST: ' + SUP_REAS1 + SPACE(2) + TRANSFORM(SUP_AMT1, '9,999,999.99') + SPACE(5)
      ?? '2. SUPP ADJUST: ' + SUP_REAS2 + SPACE(2) + TRANSFORM(SUP_AMT2, '9,999,999.99')
      ? SPACE(3) + '   SUPPLIER PALLETS        ' + SPACE(15) + SPACE(05) + TRANSFORM(SUP_PALL, '9,999,999.99')
      MTOT_PUR  = MTOT_PUR  + SUP_AMT1 + SUP_AMT2 + SUP_PALL
      ? SPACE(3) + REPLICATE('=',94)
   ENDIF
ENDIF
MPRT_FRT = .T.
IF MPRT_FRT
   IF MFRT_NAME1 <> SPACE(32) .AND. MFRT_NAME1 <> 'NONE'
      ************************************
      **** NOW DO FREIGHT INFORMATION ****
      ************************************
      IF MLINE > 54
         ? SPACE(3) + SPACE(20) + '*********>  ORDER CONTINUED ON NEXT PAGE  <*********'
         ?
         EJECT
         DO ORD_HEAD
      ENDIF
      ? SPACE(3) + 'FREIGHT CARRIER:   '  + MFRT_NAME1 + SPACE(05) + 'AMOUNT: ' + SPACE(5) + TRANSFORM(B->FRT_AMT1, '9999999.99')
      IF REF_PO1 <> SPACE(9) .OR. REF_PO2 <> SPACE(9) .OR. REF_PO3 <> SPACE(9) .OR. REF_PO4 <> SPACE(9) .OR. REF_PO5 <> SPACE(9) .OR. REF_PO6 <> SPACE(9)
         ? SPACE(3) + 'SHIPPED WITH POS: ' + REF_PO1
         IF REF_PO2 <> SPACE(9)
            ?? '; ' + REF_PO2
         ENDIF
         IF REF_PO3 <> SPACE(9)
            ?? '; ' + REF_PO3
         ENDIF
         IF REF_PO4 <> SPACE(9)
            ?? '; ' + REF_PO4
         ENDIF
         IF REF_PO5 <> SPACE(9)
            ?? '; ' + REF_PO5
         ENDIF
         IF REF_PO6 <> SPACE(9)
            ?? '; ' + REF_PO6
         ENDIF
      ENDIF
      IF FRT1_RS1 <> SPACE(10) .OR. FRT1_RS2 <> SPACE(10) .OR. FRT1_ADJ1 <> 0 .OR. FRT1_ADJ2 <> 0
         ? SPACE(3) + '1. FRT ADJUST:  ' + FRT1_RS1  +SPACE(2) + TRANSFORM(FRT1_ADJ1, '9999999.99') + SPACE(5)
         ?? '2. FRT ADJUST:  ' + FRT1_RS2  + SPACE(2) + TRANSFORM(FRT1_ADJ2, '9999999.99')
      ENDIF
      IF FRT_PALL <> 0
         ? SPACE(3) + '   FREIGHT PALLETS:     ' + SPACE(15)  + SPACE(5) + TRANSFORM(FRT_PALL, '9999999.99')
      ENDIF
   ENDIF
   
   *** 11/2003
   ***IF MPROG_CODE = 2
   IF MFRT_CODE2 <> SPACE(4)
      IF MFRT_NAME2 <> SPACE(32) .AND. MFRT_NAME2 <> 'NONE'             
         ? SPACE(3) + 'FREIGHT CARR #2:   '  + MFRT_NAME2 + SPACE(05) + 'AMOUNT: ' + SPACE(5) + TRANSFORM(MFRT_AMT2, '9999999.99')
      ENDIF
   ENDIF
   IF MFRT_CODE3 <> SPACE(4)
      IF MFRT_NAME3 <> SPACE(32) .AND. MFRT_NAME3 <> 'NONE'             
         ? SPACE(3) + 'FREIGHT CARR #3:   '  + MFRT_NAME3 + SPACE(05) + 'AMOUNT: ' + SPACE(5) + TRANSFORM(MFRT_AMT3, '9999999.99')
      ENDIF
   ENDIF
   ***ENDIF
   
   ? SPACE(3) + REPLICATE('=',94)
ENDIF
IF MMISCAMT1 <> 0 .OR. MMISCAMT2 <> 0
   IF MLINE > 54
      ? SPACE(3) + SPACE(20) + '*********>  ORDER CONTINUED ON NEXT PAGE  <*********'
      ?
      EJECT
      DO ORD_HEAD
   ENDIF
   **** NOW DO MISCELLANEOUS ADJUSTMENTS
   ? SPACE(3) + '1. MISC ADJUST: ' + MMISCREAS1 + SPACE(3)  + TRANSFORM(MMISCAMT1, '9999999.99') + SPACE(5)
   ?? '2. MISC ADJUST: ' + MMISCREAS2 + SPACE(3)  + SPACE(05) + TRANSFORM(MMISCAMT2, '9999999.99')
   ? SPACE(3) + REPLICATE('=',94)
ENDIF

IF MPROG_CODE = 2
   IF MMISCAMT3 <> 0                       
      IF MLINE > 54
         ? SPACE(3) + SPACE(20) + '*********>  ORDER CONTINUED ON NEXT PAGE  <*********'
         ?
         EJECT
         DO ORD_HEAD
      ENDIF
      **** NOW DO MISCELLANEOUS ADJUSTMENTS
      ? SPACE(3) + '3. MISC ADJUST: ' + MMISCREAS3 + SPACE(3)  + TRANSFORM(MMISCAMT3, '9999999.99') + SPACE(5)
      ? SPACE(3) + REPLICATE('=',94)
   ENDIF
ENDIF

IF MCOM_NAME <> SPACE(32)
   IF MLINE > 54
      ? SPACE(3) + SPACE(20) + '*********>  ORDER CONTINUED ON NEXT PAGE  <*********'
      ?
      EJECT
      DO ORD_HEAD
   ENDIF
   **** NOW DO THIRD PARTY COMMISSION PEOPLE
   ? SPACE(3) + MCOM_NAME + SPACE(5) 
   DO CASE
   CASE MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      ? SPACE(3)
      SELECT C
      SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
      MNBR = 1
      DO WHILE .NOT. EOF() .AND. SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX
         IF MNBR > 5
            ? SPACE(3)
            MNBR = 1
         ENDIF
         ?? SUBSTR(PROD_DESC,1,6) + ': ' + TRANSFORM(COM1_CENT, '99.9999') + ' / '
         MNBR = MNBR + 1
         SKIP
      ENDDO
   OTHERWISE
      IF COMM_ENT <> 0
         ?? 'AMOUNT:   ' + TRANSFORM(COMM_ENT, '9999.99')
      ELSE
         ?? 'CENTS/LB: ' + TRANSFORM(COMM_CENT, '99.9999')
      ENDIF
   ENDCASE
   ? SPACE(3) + REPLICATE('=',94)
ENDIF

IF MCOM_NAME2 <> SPACE(32)
   IF MLINE > 54
      ? SPACE(3) + SPACE(20) + '*********>  ORDER CONTINUED ON NEXT PAGE  <*********'
      ?
      EJECT
      DO ORD_HEAD
   ENDIF
   **** NOW DO THIRD PARTY COMMISSION PEOPLE
   ? SPACE(3) + MCOM_NAME2 + SPACE(5) 
   DO CASE
   CASE MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      ? SPACE(3)
      SELECT C
      SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
      MNBR = 1
      DO WHILE .NOT. EOF() .AND. SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX
         IF MNBR > 5
            ? SPACE(3)
            MNBR = 1
         ENDIF
         ?? SUBSTR(PROD_DESC,1,6) + ': ' + TRANSFORM(COM2_CENT, '99.9999') + ' / '
         MNBR = MNBR + 1
         SKIP
      ENDDO
   OTHERWISE
      IF COMM_ENT2 <> 0
         ?? 'AMOUNT:   ' + TRANSFORM(COMM_ENT2, '9999.99')
      ELSE
         ?? 'CENTS/LB: ' + TRANSFORM(COMM_CEN2, '99.9999')
      ENDIF
   ENDCASE
   ? SPACE(3) + REPLICATE('=',94)
ENDIF

IF MCOM_NAME3 <> SPACE(32)
   IF MLINE > 54
      ? SPACE(3) + SPACE(20) + '*********>  ORDER CONTINUED ON NEXT PAGE  <*********'
      ?
      EJECT
      DO ORD_HEAD
   ENDIF
   **** NOW DO THIRD PARTY COMMISSION PEOPLE
   ? SPACE(3) + MCOM_NAME3 + SPACE(5) 
   DO CASE
   CASE MCOMPANY = 'AMERICHICKEN, INC' .OR. MCOMPANY = 'MIDWEST FOOD -DIV 11'
      ? SPACE(3)
      SELECT C
      SEEK MSALESMAN + MPO_NBR + MPO_SUFFIX
      MNBR = 1
      DO WHILE .NOT. EOF() .AND. SALESMAN = MSALESMAN .AND. PO_NBR = MPO_NBR .AND. PO_SUFFIX = MPO_SUFFIX
         IF MNBR > 5
            ? SPACE(3)
            MNBR = 1
         ENDIF
         ?? SUBSTR(PROD_DESC,1,6) + ': ' + TRANSFORM(COM3_CENT, '99.9999') + ' / '
         MNBR = MNBR + 1
         SKIP
      ENDDO
   OTHERWISE
      IF COMM_ENT3 <> 0
         ?? 'AMOUNT:   ' + TRANSFORM(COMM_ENT3, '9999.99')
      ELSE
         ?? 'CENTS/LB: ' + TRANSFORM(COMM_CEN3, '99.9999')
      ENDIF
   ENDCASE
   ? SPACE(3) + REPLICATE('=',94)
ENDIF


MDOIT = .F.
IF MDOIT
   IF MCOMPANY = 'AMERICHICKEN, INC'
      SELECT E
      DO FOX_USE WITH "PAYMENTS INDEX PAY_SYS", .F.
      SEEK MBBUYCODE
      IF .NOT. EOF()
         STORE PAID_DATE TO MLAST_PAID
      ENDIF
      USE
      SELECT B
      STORE RECNO() TO MRECNO
      SUM TOT_SELL+CUS_PALL TO MHOLD_BAL FOR BROKERAGE = 'H' .AND. BBUYCODE = MBBUYCODE
      GOTO MRECNO
      ? 'CUSTOMER OUTSTANDING BALANCE: ' + TRANSFORM(MCUS_BAL, '9,999,999.99')
      ?? SPACE(16) + 'CREDIT LIMIT: ' + TRANSFORM(MCRED_LIM, '9,999,999.99')
      ? '      BALANCE ON HOLD ORDERS: ' + TRANSFORM(MHOLD_BAL, '9,999,999.99')
      ?? SPACE(14) +  'LAST DATE PAID: ' + SPACE(2) + DTOC(MLAST_PAID)
      ? '                   TOTAL DUE: ' + TRANSFORM(MCUS_BAL+MHOLD_BAL, '9,999,999.99')
      ?? SPACE(8) + 'LAST 25 DAYS AVG PAY: ' + SPACE(9) + TRANSFORM(MAVG_25, '999')
      ?
   ENDIF
ENDIF
EJECT
**** ALL DONE PRINTING NOW
**** PRINT SOME TOTALS HERE FOR CHECKING

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF

SELECT E
USE
SELECT F
USE
RETURN

* EOF: PRT_ONE.PRG
*Formatted by: ToolBox Ver. 1.2  on 1/7/16 at 11:21 AM.
