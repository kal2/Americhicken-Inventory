**********
* Program.: SUP_DISB.PRG
* Author..: GRACE KELLER
* Date....: 03/11/88
* Notice..: Copyright 1988, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: MANUAL SUPPLIER DISBURSEMENTS
*
* ---PROCESSING LOOP
STORE CTOD(' ') TO MCK_DATE
SELECT B
DO FOX_USE WITH "DISBJRN INDEX DISBJRN, DISB_PO, DISBINV, DISBSTR, DISBINQ", .F.
SELECT C
DO FOX_USE WITH "CK_REG INDEX CK_REG, CK_DATE", .F.

MMORE = .T.
DO WHILE MMORE
   STORE SPACE(32) TO MNAME 
   MNAME_FD = .F.
   DO RSUPSEL3
   IF .NOT. MNAME_FD
      MMORE = .F.
      LOOP
   ENDIF
   
   STORE NAME TO MNAME
   STORE RSUPCODE TO MRSUPCODE
   STORE STREET TO MSTREET
   STORE CITY TO MCITY
   STORE STATE TO MSTATE
   STORE ZIP TO MZIP
   
   CLEAR
   @ 1,00 SAY MCOMPANY
   @ 01,68 SAY DATE()
   @ 02,00 SAY MPROGRAM + ' - RECORD MANUAL SUPPLIER DISBURSEMENTS'
   @ 03,00 TO 24,79 
   
   @ 4,3 SAY 'REMIT TO:'
   @ 5,5 SAY 'STREET: '
   @ 6,5 SAY '  CITY: ' 
   @ 6,45 SAY 'STATE: ' 
   @ 6,58 SAY 'ZIP: '
   @ 8,1  SAY '          CHECK DATE: '
   @ 10,1 SAY '           CHECK NBR: '
   @ 12,1 SAY 'SUPPLIER INVOICE NBR: '
   @ 14,1 SAY ' MIDWEST INVOICE NBR: '
   @ 16,1 SAY '      MIDWEST PO NBR: '
   @ 16,26 SAY '-'
   @ 16,31 SAY '-'
   @ 18,1 SAY '   1. PRODUCT AMOUNT:' 
   @ 19,1 SAY '   2. FREIGHT AMOUNT: '
   STORE 1 TO MACTION
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1. Save/Add Another    2. Edit   3. Save/Finished    4. Cancel'
   
   STORE SPACE(6) TO MCK_NBR
   STORE 0 TO MAMOUNT1, MAMOUNT2
   STORE SPACE(12) TO MSUP_INV
   STORE SPACE(2) TO MSALESMAN 
   STORE SPACE(6) TO MCK_NBR
   STORE SPACE(4) TO MPO_NBR
   STORE SPACE(1) TO MPO_SUFFIX
   STORE SPACE(5) TO MINV_NBR
   
   STORE 2 TO MACTION
   DO WHILE MACTION = 2
      @ 21,1 CLEAR TO 21,78
      @ 4,13 SAY MNAME PICTURE '@!'
      @ 5,13 SAY MSTREET PICTURE '@!'
      @ 6,13 SAY MCITY PICTURE '@!'
      @ 6,52 SAY MSTATE PICTURE '@!'
      @ 6,63 SAY MZIP PICTURE '#####'
      @ 8,24 GET MCK_DATE
      @ 10,24 GET MCK_NBR PICTURE '@!'    
      @ 12,24 GET MSUP_INV PICTURE '@!'
      @ 14,24 GET MINV_NBR PICTURE '#####'
      @ 16,24 GET MSALESMAN PICTURE '##'
      @ 16,27 GET MPO_NBR PICTURE '####'
      @ 16,32 GET MPO_SUFFIX PICTURE '@!'
      
      
      @ 18,24 GET MAMOUNT1 PICTURE '###,###.##'
      @ 19,24 GET MAMOUNT2 PICTURE '###,###.##'
      
      STORE 1 TO MACTION
      @ 24,01 SAY 'Action: ' + STR(MACTION,1)
      @ 24,13 SAY '1. Save/Add Another    2. Edit   3. Save/Finished    4. Cancel'
      READ
      
      @ 24,9 GET MACTION PICTURE '#' RANGE 1,4
      READ
   ENDDO
   IF MACTION = 4
      MMORE = .F.
   ENDIF
   
   IF MAMOUNT1 + MAMOUNT2 = 0
      LOOP
   ENDIF
   STORE DTOC(MCK_DATE) TO MDATE
   STORE SUBSTR(MDATE,1,2) TO MMONTH
   STORE SUBSTR(MDATE,4,2) TO MDAY
   STORE SUBSTR(MDATE,7) TO MYEAR
   STORE VAL(MCK_NBR) TO MNBR
   IF MNBR > 0 .AND. MNBR <= 999999
      MCK_NBR = STR(MNBR,6)
   ENDIF
   SELECT B
   IF MAMOUNT1 <> 0
      DO FILELOCK
      APPEND BLANK
      REPLACE JRNL_MO WITH MMONTH
      REPLACE JRNL_YR WITH MYEAR
      REPLACE JRNL_DAY WITH MDAY
      REPLACE CK_NBR WITH MCK_NBR
      REPLACE SALESMAN WITH MSALESMAN
      MINV_NBR = STR(VAL(MINV_NBR),5)
      REPLACE INV_NBR WITH MINV_NBR
      REPLACE PO_NBR WITH MPO_NBR
      REPLACE PO_SUFFIX WITH MPO_SUFFIX
      REPLACE AMOUNT1 WITH MAMOUNT1
      REPLACE SYS_DATE WITH MCK_DATE
      **** FOR PRODUCT INVOICE
      REPLACE CATEGORY1 WITH 'P'
      REPLACE ACCT_NBR WITH MRSUPCODE
      
      **** FOR THE SUPPLIER
      REPLACE ACCT_TYPE WITH 'S'
      REPLACE BILL_INV WITH MSUP_INV
      UNLOCK
   ENDIF
   IF MAMOUNT2 <> 0
      DO FILELOCK
      APPEND BLANK
      REPLACE JRNL_MO WITH MMONTH
      REPLACE JRNL_YR WITH MYEAR
      REPLACE JRNL_DAY WITH MDAY
      REPLACE CK_NBR WITH MCK_NBR
      REPLACE SALESMAN WITH MSALESMAN
      MINV_NBR = STR(VAL(MINV_NBR),5)
      REPLACE INV_NBR WITH MINV_NBR
      REPLACE PO_NBR WITH MPO_NBR
      REPLACE PO_SUFFIX WITH MPO_SUFFIX
      REPLACE AMOUNT1 WITH MAMOUNT2
      REPLACE SYS_DATE WITH MCK_DATE
      
      **** FOR FREIGHT    
      REPLACE CATEGORY1 WITH 'F'
      REPLACE ACCT_NBR WITH MRSUPCODE
      
      **** FOR THE SUPPLIER
      REPLACE ACCT_TYPE WITH 'S'
      REPLACE BILL_INV WITH MSUP_INV
      UNLOCK
   ENDIF
   SELECT C
   DO FILELOCK
   APPEND BLANK
   REPLACE PAY_CODE WITH MRSUPCODE
   REPLACE CK_NBR WITH MCK_NBR
   REPLACE CK_DATE WITH MCK_DATE
   REPLACE PAY_TYPE WITH 'S' 
   REPLACE AMOUNT WITH MAMOUNT1 + MAMOUNT2
   REPLACE SYS_DATE WITH MCK_DATE 
   REPLACE CLEAR_FLG WITH 'Y'
   UNLOCK
   
ENDDO

CLOSE DATA
RETURN

* EOF: SUP_DISB.PRG
*Formatted by: dANALYST Ver. 7.3a on August 2, 1988 at 2:17 PM.
