*  FILE NAME: GR.PRG
*  BY: 
*  NOTICE: 
*  DATE: 1/16/95
*  DESC:
*  CALLED BY:
*  DATA FILES:
SET TALK OFF
SET EXCLUSIVE ON  && ALLOW MULTI USER ACCESS TO DATA FILES
STORE .T. TO FOXBASE
IF FOXBASE
   dPID    = SYS(0)   && MACHINE NAME & NET #
   dNAME   = SYS(3)   && FILENAME FOR TEMP FILES
   dCDIR   = SYS(5)   && CURRENT DEFAULT DEVICE
   dPRT    = SYS(6)   && CURRENT PRINT DEVICE
   dSNUM   = SYS(9)   && FOXBASE SERIAL NUMBER
   dMEMORY = SYS(12)  && AVAILABLE MEMORY IN BYTES
   dPON    = SYS(13)  && STATUS OF THE PRINTER
ENDIF
PUBLIC CLIPPER
SET DELETED ON
SET ECHO OFF
SET BELL OFF
SET MENU OFF
SET SAFETY OFF
SET ESCAPE ON
SET SCOREBOARD ON   
SET STATUS OFF
*SET HISTORY TO 50  
SET DOHISTORY OFF
SET ESCAPE ON
SET DECIMALS TO 5
SET CONFIRM OFF
CLOSE ALL
SET DEVICE TO SCREEN

* ---Initialize global variables.
SET COLOR TO W/N,N/W
* ---MAIN PROCESSING LOOP
SELECT A
USE HALSPOS             
INDEX ON SUBSTR(LOT,1,7) +PO_nbr+po_suffix TO TMP1
USE HALSPOS INDEX TMP1

SELECT B
USE INVN_DTL            
SET FILTER TO SALESMAN = '15'
GOTO TOP
DO WHILE .NOT. EOF()
   IF ACT_CODE <> 'S'
      SKIP
      LOOP
   ENDIF
   MCASE = SHIP_CASE       
   SELECT A
   SEEK B->LOT_NBR+B->PO_NBR+B->PO_SUFFIX
   DO WHILE .NOT. EOF() .AND. LOT = B->LOT_NBR .AND. B->PO_NBR = PO_NBR  .AND. B->PO_SUFFIX = PO_SUFFIX
       IF MCASE = QTY
          SELECT B
          REPLACE CUS_PRI WITH A->SEL_PRICE
          SELECT A
          GOTO BOTTOM
       ENDIF
       SKIP
   ENDDO
   SELECT B
   SKIP
ENDDO
CLOSE DATA
RETURN
*Formatted by: ToolBox Ver. 1.2  on 1/16/95 at 5:46 PM.
