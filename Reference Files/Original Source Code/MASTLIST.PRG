****************
* Program.: MASTLIST.PRG
* Author..: GRACE KELLER
* Date....: 10/26/87
* Notice..: Copyright (C) 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: MASTER FILE LISTINGS
*
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
STORE ' ' TO MSELECTION
STORE ' ' TO MACTION
SET PROC TO MASTLIST
DO WHILE VAL(MSELECTION) <> 99 
   
   CLEAR
   @ 01,00 SAY MCOMPANY
   @ 02,00 SAY MPROGRAM + ' - MASTER FILE LISTINGS'
   @ 02,70 SAY DATE()
   @ 3,0 to 25,79
   
   @ 04,10 SAY ' 1 - SUPPLIER LISTING              3. (NOT CURRENTLY USED)'
   @ 05,10 SAY ' 2 - CUSTOMER LISTING              4. SHIPTO CUST/BY STATE'
   
   @ 06,10 SAY ' 5 - FREIGHT CARRIER LISTING'
   @ 07,10 SAY ' 6 - SALESPERSON LISTING'
   @ 08,10 SAY ' 7 - THIRD PARTY COMMISSION\BILLBACK PAYEE LISTING'
   @ 09,10 SAY ' 8 - PRODUCT NATURE LISTING'
   @ 10,10 SAY ' 9 - PRODUCT GRADE/PROCESS TYPE LISTING'
   @ 11,10 SAY '10 - REFRIGERATION/STORAGE AND PACKAGING CODE LISTING'
   @ 12,10 SAY '11 - PRODUCT SIZE LISTING'
   @ 13,10 SAY '12 - UNIT PACK (BOX SIZE) LISTING'
   @ 14,10 SAY '13 - PRODUCT DESCRIPTION CODE LISTING'
   @ 15,10 SAY '14 - MISCELLANEOUS CHARGES REASON CODE LISTING'
   @ 16,10 SAY '15 - CHART OF ACCOUNTS'
   
   @ 17,10 SAY '16 - CUSTOMER COMM BROKERS / PROGRAM BILLBACKS'
   @ 18,10 SAY '17 - FEES FOR AMERICHICKEN COMM BROKERS / BILLBACKS'
   @ 19,10 SAY '18 - NATIONAL PRICING MASTER'
   @ 20,10 SAY '19 - SUPPLIER/CUSTOMER PRICING MASTER'
   @ 21,10 SAY '99 - RETURN TO REPORTS MENU'
   
   STORE '  ' TO MSELECTION
   @ 23,02 SAY 'CHOICE: '
   @ 23,10 GET MSELECTION picture '##'
   READ
   
   DO CASE
      
   CASE VAL(MSELECTION) = 1     
      DO RSUPLIST
   CASE VAL(MSELECTION) = 2     
      DO BCUSLIST
   CASE VAL(MSELECTION) =  3    
      *    DO SUP_LIST
   CASE VAL(MSELECTION) =  4    
      DO CUS_LIST
   CASE VAL(MSELECTION) =  5    
      DO FRT_LIST
   CASE VAL(MSELECTION) =  6    
      DO SALELIST
   CASE VAL(MSELECTION) =  7    
      DO COM_LIST
   CASE VAL(MSELECTION) =  8    
      DO FRFZLIST
   CASE VAL(MSELECTION) =  9    
      DO GRDLIST
   CASE VAL(MSELECTION) =  10   
      DO PAKLIST
   CASE VAL(MSELECTION) =  11   
      DO SIZELIST
   CASE VAL(MSELECTION) =  12    
      DO SPECLIST
   CASE VAL(MSELECTION) =  13    
      DO PRODLIST
   CASE VAL(MSELECTION) =  14    
      DO REASLIST
   CASE VAL(MSELECTION) =  15    
      DO ACCTLIST
   CASE VAL(MSELECTION) =  16    
      ***DO VENDPROD
      DO CUSCOMLT
   CASE VAL(MSELECTION) =  17
      DO BROKFEES
   CASE VAL(MSELECTION) =  18    
      DO NATLLIST
   CASE VAL(MSELECTION) =  19
      DO CUSTLIST
      
   ENDCASE
   CLOSE DATA
ENDDO
RETURN

PROCEDURE RSUPLIST
MTITLE = ' - REMIT TO SUPPLIER LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
MYES_NO = 'Y'
@ 8,1 SAY 'Only Print Active Suppliers (Orders within last 12 MO) (Y/N)? ' GET MYES_NO PICTURE '@!' VALID(MYES_NO = 'Y' .OR. MYES_NO = 'N')
READ

STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT C
DO FOX_USE WITH "PO_HEAD INDEX TMP_SUP", .F.
MACTIVE_DT = DATE() - 365

SELECT B
DO FOX_USE WITH "&MDBFLOC.SUPPLIER", .F.
INDEX ON RSUPCODE TO &MDBFLOC.TMP_SUPX
DO FOX_USE WITH "&MDBFLOC.SUPPLIER INDEX &MDBFLOC.TMP_SUPX", .F.
SELECT A
DO FOX_USE WITH "&MDBFLOC.REM_SUP INDEX &MDBFLOC.RSUPNAME", .F.
DO WHILE .NOT. EOF()
   DO RECLOCK
   REPLACE ACTIVE WITH ' '
   UNLOCK
   SKIP
ENDDO

GOTO TOP
DO WHILE .NOT. EOF()
   SELECT C
   SEEK A->RSUPCODE
   IF EOF() .OR. SHIP_DATE < MACTIVE_DT
      SELECT A
      DO RECLOCK
      REPLACE ACTIVE WITH 'N'
      UNLOCK
   ENDIF
   SELECT A
   SKIP
ENDDO

SELECT A
IF MYES_NO = 'Y'
   SET FILTER TO ACTIVE <> 'N'
ENDIF
GOTO TOP

MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()
   IF NAME = SPACE(32)
      SKIP
      LOOP
   ENDIF
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,27 say '     SUPPLIER LISTING'     
      @ MLINE,65 SAY DTOC(DATE())
      MLINE = MLINE + 2
      @ MLINE,1 SAY 'SUP CODE  LED CODE  TERMS  NAME/ADDRESS/SHIPPED FROM'
      @ MLINE,65 SAY 'PHONE/CITY'    
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,1 SAY RSUPCODE
   IF LED_CODE = SPACE(4)
      @ MLINE,12 SAY RSUPCODE
   ELSE
      @ MLINE,12 SAY LED_CODE
   ENDIF
   IF NET_DAYS = 0
      @ MLINE,22 SAY '14'
   ELSE
      @ MLINE,21 SAY NET_DAYS PICTURE '999'
   ENDIF
   @ MLINE,29 SAY NAME       
   @ MLINE,65 SAY '(' + AREA_CODE + ')' + TRANSFORM(PHONE, '@R 999-9999')
   
   MLINE = MLINE + 1
   IF ACTIVE <> ' '
      @ MLINE,03 SAY '*** INACTIVE SUPPLIER ***'
   ENDIF
   @ MLINE,29 SAY STREET
   IF ZIP4 = SPACE(4)
      STORE ZIP TO MZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MZIP
   ENDIF
   IF CITY <> '   ' .AND. STATE <> '  '
      @ MLINE,65 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
   ENDIF
   IF NOTE <> SPACE(60)
      MLINE = MLINE + 1
      @ MLINE,29 SAY NOTE
   ENDIF
   MLINE = MLINE + 2
   SELECT B
   SEEK A->RSUPCODE
   DO WHILE .NOT. EOF() .AND. RSUPCODE = A->RSUPCODE
      IF NAME = SPACE(32)
         SKIP
         LOOP
      ENDIF
      
      IF MLINE > 58
         IF MFIRST_TM
            MFIRST_TM = .F.
         ELSE
            EJECT
         ENDIF
         MLINE = 2
         MPAGE_NO = MPAGE_NO + 1
         @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
         @ mline,27 say '     SUPPLIER LISTING'     
         @ MLINE,65 SAY DTOC(DATE())
         MLINE = MLINE + 2
         @ MLINE,1 SAY 'SUP CODE  LED CODE  TERMS  NAME/ADDRESS/SHIPPED FROM'
         @ MLINE,65 SAY 'PHONE/CITY'    
         MLINE = MLINE + 2
      ENDIF
      @ MLINE,32 SAY NAME       
      @ MLINE,65 SAY '(' + AREA_CODE + ')' + TRANSFORM(PHONE, '@R 999-9999')
      MLINE = MLINE + 1
      @ MLINE,32 SAY STREET
      IF ZIP4 = SPACE(4)
         STORE ZIP TO MZIP
      ELSE
         STORE ZIP + '-' + ZIP4 TO MZIP
      ENDIF
      IF CITY <> '   ' .AND. STATE <> '  '
         @ MLINE,65 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
      ENDIF
      SKIP
      MLINE = MLINE + 2
   ENDDO
   SELECT A
   SKIP
   MLINE = MLINE + 1
ENDDO
@ MLINE,1 SAY ' '
EJECT
SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF

RETURN

PROCEDURE SUP_LIST
MTITLE = ' - SUPPLIER LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.SUPPLIER INDEX &MDBFLOC.SUP_NAME", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,26 say 'SHIPPED FROM SUPPLIER LISTING' 
      @ MLINE,65 SAY DTOC(DATE())
      MLINE = MLINE + 2
      @ MLINE,5 SAY 'NAME/ADDRESS'
      @ MLINE,45 SAY 'PHONE'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,05 SAY NAME       
   @ MLINE,45 SAY '(' + AREA_CODE + ')' + TRANSFORM(PHONE, '@R 999-9999')
   MLINE = MLINE + 1
   @ MLINE,05 SAY STREET
   IF ZIP4 = SPACE(4)
      STORE ZIP TO MZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MZIP
   ENDIF
   @ MLINE,45 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT
SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF

RETURN
* EOF: SUP_LIST.PRG

PROCEDURE BCUSLIST
* Notes...: CUSTOMER LISTING 
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - BILL TO CUSTOMER LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE 'NO ' TO MYES_NO
STORE CTOD('') TO MACT_DATE
@ 10,10 SAY '  Do you want to print SHIP TO information (YES/NO)? ' get myes_no picture '@!'
@ 12,10 say 'ONLY Select Customers with Activity After this Date: ' GET MACT_DATE
@ 13,10 SAY 'Note: Leave Date Blank if Selecting ALL Customers'
READ
@ 10,01 CLEAR TO 13,78
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 
SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT C
DO FOX_USE WITH "PO_HEAD INDEX TMP_BUY", .F.
SELECT B
DO FOX_USE WITH "&MDBFLOC.BUYER", .F.
INDEX ON BBUYCODE TO &MDBFLOC.TMP_XBUY
DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.TMP_XBUY", .F.
SELECT A
DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYNAME", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()
   IF MACT_DATE <> CTOD('')
      SELECT C
      SEEK A->BBUYCODE
      IF SHIP_DATE < MACT_DATE
         SELECT A
         SKIP
         LOOP
      ENDIF
      SELECT A
   ENDIF
   IF MLINE+6 > 60
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,1 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,36 say '    CUSTOMER LISTING'
      @ MLINE,85 SAY DTOC(DATE())
      IF MACT_DATE <> CTOD('')
         MLINE = MLINE + 1
         @ mline,30 say 'With Shipment Actvivity On/After: ' + dtoc(mact_date)
      ENDIF
      MLINE = MLINE + 2
      @ MLINE,1 SAY '                                   CREDIT   AVG PAY   LETTER   BEGIN     END    CUST   LEDGER'
      MLINE = MLINE + 1
      @ MLINE,1 SAY 'NAME / ADDRESS                      LIMIT     DAYS    CREDIT    DATE    DATE    CODE    CODE'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,1 SAY NAME
   @ MLINE,35 SAY CRED_LIM PICTURE '9999999'
   IF SHIPS_180 <> 0 .AND. DAYS_180 <> 0
      MAVG_180 = DAYS_180/SHIPS_180
   ELSE
      MAVG_180 = 0
   ENDIF
   @ MLINE,46 SAY MAVG_180 PICTURE '999.99'
   IF LET_CRD <> 0
      @ MLINE,54 SAY LET_CRD PICTURE '9999999'
      @ MLINE,63 SAY BEG_DATE
      @ MLINE,72 SAY END_DATE
   ENDIF
   
   @ MLINE,81 SAY BBUYCODE
   IF LED_CODE = SPACE(4)
      @ MLINE,89 SAY BBUYCODE
   ELSE
      @ MLINE,89 SAY LED_CODE
   ENDIF
   MLINE = MLINE + 1
   @ MLINE,1 SAY STREET  
   IF CRED_LIM <> 0
      @ MLINE,34 SAY DATE_FIN
   ENDIF
   MLINE = MLINE + 1
   IF ZIP4 = SPACE(4)
      STORE ZIP TO MZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MZIP
   ENDIF
   IF CITY <> '   ' .AND. STATE <> '  '
      @ MLINE,1 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
   ENDIF
   MLINE = MLINE + 1
   IF AREA_CODE <> SPACE(3) .AND. PHONE <> SPACE(7)
      @ MLINE,1 SAY '(' + AREA_CODE + ')' + TRANSFORM(PHONE, '@R 999-9999')
      MLINE = MLINE + 1
   ENDIF
   IF ACTIVE <> ' '
      @ MLINE,01 SAY '* INACTIVE CUSTOMER *'
      MLINE = MLINE + 1
   ENDIF
   IF NOTE <> SPACE(60)
      @ MLINE,1 SAY '* NOTE: *'
      @ MLINE,11 SAY NOTE
      MLINE = MLINE + 1
   ENDIF
   MLINE = MLINE + 1
   IF MYES_NO = 'YES'
      MSHIP_LINE = .T.
      SELECT B
      SEEK A->BBUYCODE
      DO WHILE .NOT. EOF() .AND. BBUYCODE = A->BBUYCODE
         IF NAME = SPACE(32)
            SKIP
            LOOP
         ENDIF
         IF MLINE+3 > 58
            IF MFIRST_TM
               MFIRST_TM = .F.
            ELSE
               EJECT
            ENDIF
            MLINE = 2
            MPAGE_NO = MPAGE_NO + 1
            @ MLINE,1 SAY 'PAGE  ' + str(mpage_no,3)
            @ mline,36 say '    CUSTOMER LISTING    ' 
            @ MLINE,85 SAY DTOC(DATE())
            MLINE = MLINE + 2
            @ MLINE,1 SAY '                                   CREDIT   AVG PAY   LETTER   BEGIN     END    CUST   LEDGER'
            MLINE = MLINE + 1
            @ MLINE,1 SAY 'NAME / ADDRESS                      LIMIT     DAYS    CREDIT    DATE    DATE    CODE    CODE'
            MLINE = MLINE + 2
         ENDIF
         IF MSHIP_LINE
            @ MLINE,15 SAY 'SHIP TO:'
            MSHIP_LINE = .F.
         ENDIF
         @ MLINE,36 SAY NAME       
         MLINE = MLINE + 1
         IF STREET <> SPACE(10)
            @ MLINE,36 SAY STREET
            MLINE = MLINE + 1
         ENDIF
         IF ZIP4 = SPACE(4)
            STORE ZIP TO MZIP
         ELSE
            STORE ZIP + '-' + ZIP4 TO MZIP
         ENDIF
         IF CITY <> '   ' .AND. STATE <> '  '
            @ MLINE,36 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
            MLINE = MLINE + 1
         ENDIF
         SKIP
         MLINE = MLINE + 1
      ENDDO
   ENDIF
   SELECT A
   SKIP
   MLINE = MLINE + 1
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN
* EOF: BCUSLIST.PRG

PROCEDURE CUS_LIST
*************
* Program.: CUS_LIST.PRG
* Author..: Grace Keller
* Date....: 10/26/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: CUSTOMER LISTING 
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - SHIP TO CUSTOMER LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE '  ' TO MOPT_STATE
@ 10,2 SAY 'Enter Optional Ship To State: ' GET MOPT_STATE PICTURE '@!'
READ
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_NAME", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()
   
   IF MOPT_STATE <> '  '
      IF STATE <> MOPT_STATE
         SKIP
         LOOP
      ENDIF
   ENDIF
   IF NAME = SPACE(32)
      SKIP
      LOOP
   ENDIF
   
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,27 say 'SHIP TO CUSTOMER LISTING' 
      @ MLINE,65 SAY DTOC(DATE())
      MLINE = MLINE + 2
      @ MLINE,5 SAY 'CUS CODE/NAME/ADDRESS'
      @ MLINE,45 SAY 'PHONE'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,05 SAY NAME       
   @ MLINE,45 SAY '(' + AREA_CODE + ')' + TRANSFORM(PHONE, '@R 999-9999')
   MLINE = MLINE + 1
   @ MLINE,05 SAY STREET
   IF ZIP4 = SPACE(4)
      STORE ZIP TO MZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MZIP
   ENDIF
   @ MLINE,45 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN
* EOF: CUS_LIST.PRG

PROCEDURE FRT_LIST
*************
* Program.: FRT_LIST.PRG
* Author..: Grace Keller
* Date....: 10/26/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: FREIGHT LISTING 
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - FREIGHT CARRIER LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
MYES_NO = 'Y'
@ 8,1 SAY 'Only Print Active Freight Carriers (Orders within last 12 MO) (Y/N)? ' GET MYES_NO PICTURE '@!' VALID(MYES_NO = 'Y' .OR. MYES_NO = 'N')
READ

STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

MACTIVE_DT = DATE() - 365

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT B
DO FOX_USE WITH "DAILYJRN", .F.

SELECT A
DO FOX_USE WITH "&MDBFLOC.FREIGHT INDEX &MDBFLOC.FRT_NAME", .F.

DO WHILE .NOT. EOF()
   DO RECLOCK
   REPLACE ACTIVE WITH ' '
   UNLOCK
   SKIP
ENDDO

GOTO TOP
DO WHILE .NOT. EOF()
   SELECT B
   SET FILTER TO INV_COR = 'I' .AND. SHIP_DATE >= MACTIVE_DT .AND. (FRT_CODE1 = A->FRT_CODE .OR. FRT_CODE2 = A->FRT_CODE .OR. FRT_CODE3 = A->FRT_CODE)

   GOTO TOP
   IF EOF()
      SELECT A
      DO RECLOCK
      REPLACE ACTIVE WITH 'N'
      UNLOCK
   ENDIF
   SELECT A
   SKIP
ENDDO
SELECT B
USE

SELECT A
IF MYES_NO = 'Y'
   SET FILTER TO ACTIVE <> 'N'
ENDIF
GOTO TOP


MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,25 say 'FREIGHT CARRIER LISTING' 
      @ MLINE,65 SAY DTOC(DATE())
      MLINE = MLINE + 2
      @ MLINE,5 SAY 'FREIGHT CARRIER'
      @ MLINE,45 SAY 'PAY TO'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,5 SAY NAME       
   @ MLINE,45 SAY PAY_NAME
   MLINE = MLINE + 1
   @ MLINE,5 SAY STREET
   @ MLINE,45 SAY PAY_STRT
   MLINE = MLINE + 1
   IF ZIP4 = SPACE(4)
      STORE ZIP TO MZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MZIP
   ENDIF
   IF PAY_ZIP4 = SPACE(4)
      STORE PAY_ZIP TO MPAY_ZIP
   ELSE
      STORE PAY_ZIP + '-' + PAY_ZIP4 TO MPAY_ZIP
   ENDIF
   @ MLINE,5 SAY TRIM(CITY) + ', ' + STATE + '  ' + MZIP
   @ MLINE,45 SAY TRIM(PAY_CITY) + ', ' + PAY_STATE + '  ' + MPAY_ZIP
   MLINE = MLINE + 1
   @ MLINE,5 SAY '(' + AREA_CODE + ') '   
   @ MLINE,11 SAY PHONE PICTURE '@R 999-9999'
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN
* EOF: FRT_LIST.PRG

PROCEDURE SALELIST  
*************
* Program.: SALELIST.PRG
* Author..: Grace Keller
* Date....: 11/26/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: SALESMAN LISTING 
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - SALESPERSON LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MMASTDBF.SALESMAN INDEX &MMASTDBF.SAL_CODE", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,30 say 'SALESPERSON LISTING' 
      @ MLINE,65 SAY DTOC(DATE())
      MLINE = MLINE + 2
      @ MLINE,10 SAY 'SALESPERSON CODE'
      @ MLINE,30 SAY 'SALESPERSON NAME'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,16 SAY SALE_CODE  
   @ MLINE,30 SAY NAME
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
SET CONSOLE ON
RETURN
* EOF: SALELIST.PRG

PROCEDURE COM_LIST
*************
* Program.: COM_LIST.PRG
* Author..: Grace Keller
* Date....: 11/17/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: THIRD PARTY COMMISSION PAYEE
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - THIRD PARTY COMMISSION\BILLBACK PAYEES'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 
SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.COMPAYEE INDEX &MDBFLOC.COM_NAME, &MDBFLOC.COM_CODE", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()
   IF NAME = 'NOT USED'
      SKIP
      LOOP
   ENDIF
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,6 SAY 'PAGE ' + str(mpage_no,3)
      @ mline,20 say 'THIRD PARTY COMMISSION PAYEE LISTING' 
      @ MLINE,65 SAY DTOC(DATE())
      MLINE = MLINE + 2
      @ MLINE,6 SAY 'PAYEE NAME'
      @ MLINE,45 SAY 'LEDGER GROUP PAYEE'
      MLINE = MLINE + 2
   ENDIF
   IF BILL_BACK = 'Y'
      @ MLINE,1 SAY '(B)'
   ENDIF
   @ MLINE,6 SAY NAME
   IF LED_CODE <> SPACE(2) .AND. LED_CODE <> COM_CODE
      STORE RECNO() TO MRECNO
      STORE LED_CODE TO MLED_CODE
      SET ORDER TO 2
      SEEK MLED_CODE
      IF .NOT. EOF()
         @ MLINE,45 SAY NAME
      ELSE
         @ MLINE,25 SAY 'LEDGER GROUPING NOT ON FILE'
      ENDIF
      SET ORDER TO 1
      GOTO MRECNO
   ENDIF
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF

SET CONSOLE ON
RETURN
* EOF: COM_LIST.PRG

PROCEDURE FRFZLIST
*************
* Program.: FRFZLIST.PRG
* Author..: Grace Keller
* Date....: 11/17/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: FRESH/FROZEN LISTING
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - FRESH FROZEN LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.PRODUCTS INDEX &MDBFLOC.PRODUCTS", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
SEEK 'F'
DO WHILE .NOT. EOF() .AND. TYPE = 'F'
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,22 say '    NATURE OF PRODUCT    ' 
      @ MLINE,65 SAY DTOC(DATE())
      mline = mline + 1
      @ mline,22 say '    (2 position code)'
      MLINE = MLINE + 2
      @ MLINE,10 SAY 'FRESH/FROZEN CODE        DESCRIPTION'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,16 SAY CODE
   @ MLINE,35 SAY SUBSTR(DESC,1,6)
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT
SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF

RETURN
* EOF: FRFZLIST.PRG

PROCEDURE GRDLIST 
*************
* Program.: GRDLIST.PRG
* Author..: Grace Keller
* Date....: 11/17/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: GRADE LISTING
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - GRADE LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 
SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.PRODUCTS INDEX &MDBFLOC.PRODUCTS", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
SEEK 'G'
DO WHILE .NOT. EOF() .AND. TYPE = 'G'
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,20 say '  PRODUCT GRADE   ' 
      @ MLINE,50 SAY DTOC(DATE())
      mline = mline + 1
      @ mline,19 say '(1 position code)'
      MLINE = MLINE + 2
      @ MLINE,10 SAY 'GRADE CODE        DESCRIPTION'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,13 SAY CODE
   @ MLINE,29 SAY SUBSTR(DESC,1,8)
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN
* EOF: GRDLIST.PRG

PROCEDURE PAKLIST    
*************
* Program.: PAKLIST.PRG
* Author..: Grace Keller
* Date....: 11/17/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: PACKAGED LISTING
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - PACKAGED LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.PRODUCTS INDEX &MDBFLOC.PRODUCTS", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
SEEK 'D'
DO WHILE .NOT. EOF() .AND. TYPE = 'D'
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,2 SAY 'PAGE  ' + str(mpage_no,2)
      @ mline,13 say ' REFRIGERATION/STORAGE DESCRIPTION  ' 
      @ MLINE,50 SAY DTOC(DATE())
      mline = mline + 1
      @ mline,20 say ' (1 position code)'
      MLINE = MLINE + 2
      @ MLINE,08 SAY 'REFRIGERATION CODE        DESCRIPTION'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,15 SAY CODE
   @ MLINE,34 SAY SUBSTR(DESC,1,8)
   MLINE = MLINE + 2
   SKIP
ENDDO
EJECT

MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
SEEK 'K'
DO WHILE .NOT. EOF() .AND. TYPE = 'K'
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,20 say ' PACKAGING DESCRIPTION  ' 
      @ MLINE,50 SAY DTOC(DATE())
      mline = mline + 1
      @ mline,22 say ' (1 position code)'
      MLINE = MLINE + 2
      @ MLINE,08 SAY '  PACKAGING CODE          DESCRIPTION'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,15 SAY CODE
   @ MLINE,34 SAY SUBSTR(DESC,1,9)
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN
* EOF: PAKLIST.PRG

PROCEDURE SIZELIST
*************
* Program.: SIZELIST.PRG
* Author..: Grace Keller
* Date....: 11/17/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: SIZE LISTING
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - SIZE LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.PRODUCTS INDEX &MDBFLOC.PRODUCTS", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
SEEK 'Z'
DO WHILE .NOT. EOF() .AND. TYPE = 'Z'
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,20 say '  PRODUCT SIZE   ' 
      @ MLINE,50 SAY DTOC(DATE())
      MLINE = MLINE + 1
      @ MLINE,20 SAY '(5 position code)'
      MLINE = MLINE + 2
      @ MLINE,10 SAY 'SIZE CODE        DESCRIPTION'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,13 SAY CODE
   @ MLINE,27 SAY SUBSTR(DESC,1,13)
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN
* EOF: SIZELIST.PRG

PROCEDURE SPECLIST   
*************
* Program.: SPECLIST.PRG
* Author..: Grace Keller
* Date....: 11/17/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: UNIT PACK (BOX SIZE)   LISTING
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - UNIT PACK (BOX SIZE)  LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.PRODUCTS INDEX &MDBFLOC.PRODUCTS", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
SEEK 'S'
DO WHILE .NOT. EOF() .AND. TYPE = 'S'
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,20 say 'UNIT PACK (BOX SIZE)  ' 
      @ MLINE,60 SAY DTOC(DATE())
      MLINE = MLINE + 1
      @ MLINE,20 SAY '  (4 position code)'
      MLINE = MLINE + 2
      @ MLINE,10 SAY '  UNIT PACK CODE      DESCRIPTION'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,16 SAY CODE
   @ MLINE,31 SAY SUBSTR(DESC,1,8)
   MLINE = MLINE + 2
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN
* EOF: SPECLIST.PRG

PROCEDURE PRODLIST 
*************
* Program.: PRODLIST.PRG
* Author..: Grace Keller
* Date....: 11/17/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: PRODUCT CODE LISTING
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - PRODUCT CODE LISTING'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 
SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.PRODUCTS INDEX &MDBFLOC.PRODUCTS", .F.
*SET FILTER TO VAL(CODE) >= 1 .AND. VAL(CODE) <= 9999 .AND. USED = 'Y'
**SET FILTER TO VAL(CODE) >= 1 .AND. VAL(CODE) <= 9999                      
GOTO TOP
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
SEEK 'R'
DO WHILE .NOT. EOF() .AND. TYPE = 'R'
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,20 say 'PRODUCT CODE LISTING' 
      @ MLINE,50 SAY DTOC(DATE())
      MLINE = MLINE + 3
      @ MLINE,10 SAY 'PRODUCT CODE         DESCRIPTION                  PACKED'
      MLINE = MLINE + 3
   ENDIF
   
   @ MLINE,13 SAY CODE
   @ MLINE,31 SAY DESC
   @ MLINE,60 SAY BOX_CODE
   MLINE = MLINE + 1
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN
* EOF: PRODLIST.PRG

PROCEDURE REASLIST
*************
* Program.: REASLIST.PRG
* Author..: Grace Keller
* Date....: 11/17/87
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: REASON CODE LISTING
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - MISCELLANEOUS CHARGE REASON CODES'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 
SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.PRODUCTS INDEX &MDBFLOC.PRODUCTS", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
SEEK 'M'
DO WHILE .NOT. EOF() .AND. TYPE = 'M'
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,18 say 'MISCELLANEOUS CHARGE REASONS' 
      @ MLINE,50 SAY DTOC(DATE())
      MLINE = MLINE + 1
      @ MLINE,10 SAY ' REASON CODE        DESCRIPTION'
      MLINE = MLINE + 1
   ENDIF
   @ MLINE,14 SAY CODE
   @ MLINE,31 SAY DESC
   MLINE = MLINE + 1
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF

RETURN
* EOF: REASLIST.PRG

PROCEDURE ACCTLIST
*************
* Program.: ACCTLIST.PRG
* Author..: Grace Keller
* Date....: 04/04/88
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: CHART OF ACCOUNTS LISTING
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - CHART OF ACCOUNTS'

CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MACTION
DO PRT_SET
IF MACTION <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MMASTDBF.ACCOUNTS INDEX &MMASTDBF.ACCOUNTS", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()
   IF MLINE > 58
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,6 SAY 'PAGE  ' + str(mpage_no,2)
      DO CASE
      CASE MCOMPANY = 'AMERICHICKEN, INC'
         @ mline,19 say 'AMERICHICKEN CHART OF ACCOUNTS'
      CASE MCOMPANY = 'MIDWEST FOOD -DIV 11'
         @ mline,19 say 'MIDWEST-DIV 11 CHART OF ACCOUNTS'
      OTHERWISE
         @ mline,19 say 'MIDWEST FOODS CHART OF ACCOUNTS'
      ENDCASE
      @ MLINE,59 SAY DTOC(DATE())
      MLINE = MLINE + 2
      @ MLINE,5 SAY '   ACCOUNT    OFFICE DESCRIPTION             CHECK DESCRIPTION'
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,9 SAY ACCOUNT
   @ MLINE,19 SAY DESCRIP
   @ MLINE,50 SAY CK_DESC
   MLINE = MLINE + 1
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN

PROCEDURE VENDPROD 
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - VENDOR CODE LISTING'
CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE ' ' TO MPRT_ACT
DO PRT_SET
IF MPRT_ACT <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MDBFLOC.SUP_PROD INDEX &MDBFLOC.SUP_PROD", .F.
MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()                      
   IF MLINE > 59
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,28 say 'VENDOR PRODUCT CODE LISTING' 
      @ MLINE,80 SAY DTOC(DATE())
      MLINE = MLINE + 1
      @ MLINE,1 SAY '                                                               MIDWEST PRODUCT INFORMATION'
      MLINE = MLINE + 1
      @ MLINE,0 SAY 'VENDOR CODE  DESCRIPTION                                  UNIT PAK NA PTY RF PK PROD SIZE  BXSZ'
      @ MLINE,0 SAY REPLICATE('_',95)
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,0 SAY SUP_PREFX + SUP_PCODE
   @ MLINE,13 SAY DESCRIP
   @ MLINE,58 SAY PACKED
   @ MLINE,68 SAY FRH_FRZ
   @ MLINE,71 SAY GRADE
   @ MLINE,75 SAY SUBSTR(PACKAGED,1,1)
   @ MLINE,78 SAY SUBSTR(PACKAGED,2)
   @ MLINE,80 SAY PROD_DESC
   @ MLINE,85 SAY SIZE
   IF BOX_SZ <> 0
      @ MLINE,91 SAY BOX_SZ PICTURE '99.9'
   ENDIF
   MLINE = MLINE + 1
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT
SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN

PROCEDURE BROKFEES
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - VENDOR CODE LISTING'
CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79
STORE SPACE(32) TO MCOM_NAME 
@ 5,1 SAY 'BROKER/COMMISSION NAME'
@ 6,1 GET MCOM_NAME PICTURE '@!'
READ
IF MCOM_NAME = SPACE(32)
   RETURN
ENDIF
SELECT A
DO FOX_USE WITH "&MDBFLOC.COMPAYEE INDEX &MDBFLOC.COM_NAME", .F.
MCOM_FD = .F.
STORE TRIM(MCOM_NAME) TO SRCH_ARG
DO COM_SEL2
IF .NOT. MCOM_FD
   RETURN
ENDIF
STORE NAME TO MCOM_NAME
STORE COM_CODE TO MCOM_CODE

STORE ' ' TO MPRT_ACT
DO PRT_SET
IF MPRT_ACT <> 'C'
   RETURN
ENDIF 

SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT A
DO FOX_USE WITH "&MMASTDBF.BROK_FEE INDEX &MMASTDBF.BROK_FEE", .F.
SET FILTER TO COM_CODE = MCOM_CODE
GOTO TOP

MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.
DO WHILE .NOT. EOF()                      
   IF MLINE > 59
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ mline,28 say 'COMMISSION BROKERAGE FEE LISTING' 
      @ MLINE,80 SAY DTOC(DATE())
      MLINE = MLINE + 1
      @ MLINE,28 SAY 'FOR: ' + MCOM_NAME
      MLINE = MLINE + 2
      @ MLINE,11 SAY 'PRODUCT  FEE AMT'
      
      @ MLINE,11 SAY REPLICATE('_',16)
      MLINE = MLINE + 2
   ENDIF
   @ MLINE,11 SAY  PROD_CODE
   @ MLINE,20 SAY BROK_FEE PICTURE '99.9999'
   MLINE = MLINE + 1
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT
SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
RETURN


PROCEDURE CUSCOMLT

* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - CUSTOMER BROKER COMM AND BILLBACKS/PROGRAMS'
CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79

STORE 'N' TO MSEL, MYES_NO, MBBS
@ 5,1  SAY 'Do You Want to Print Expanded List With Products and Fees (N/Y): ' GET MSEL PICTURE '@!' VALID(MSEL = 'Y' .OR. MSEL = 'N')
@ 8,1  SAY 'Select Specific Broker/Billback (Y/N): ' GET MYES_NO PICTURE '@!' VALID(MYES_NO = 'Y' .OR. MYES_NO = 'N')
@ 11,1 SAY 'Print  Billback Brokers (Y/N): ' GET MBBS PICTURE '@!' VALID(MBBS = 'Y' .OR. MBBS = 'N')
READ
STORE SPACE(2) TO MCOM_CODE
IF MYES_NO = 'Y'
   STORE SPACE(32) TO MCOM_NAME
   @ 9,1 SAY 'BROKER/BILLBACK NAME: '
   @ 9,23 GET MCOM_NAME PICTURE '@!'
   READ
   SAVE SCREEN TO MGRACE                  
   
   SELECT A
   DO FOX_USE WITH "&MDBFLOC.COMPAYEE INDEX &MDBFLOC.COM_NAME", .F.
   MCOM_FD = .F.
   STORE TRIM(MCOM_NAME) TO SRCH_ARG
   DO COM_SEL2
   IF MCOM_FD
      STORE NAME     TO MCOM_NAME
      STORE COM_CODE TO MCOM_CODE
   ELSE
      STORE 'N' TO MYES_NO
      STORE SPACE(2) TO MCOM_CODE
   ENDIF
   SELECT A
   USE
   RESTORE SCREEN FROM MGRACE
ENDIF


STORE ' ' TO MPRT_ACT
DO PRT_SET
IF MPRT_ACT <> 'C'
   RETURN
ENDIF 
SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT C
DO FOX_USE WITH "&MDBFLOC.BIL_BUY INDEX &MDBFLOC.BBUYCODE", .F.

SELECT B
DO FOX_USE WITH "&MDBFLOC.COMPAYEE INDEX &MDBFLOC.COM_CODE", .F.

SELECT A
DO FOX_USE WITH "&MDBFLOC.CUSTCOMM INDEX &MDBFLOC.CUSTCOMM", .F.

DO WHILE .NOT. EOF()
   SELECT C
   SEEK A->BBUYCODE
   SELECT A
   DO RECLOCK
   REPLACE BBUYNAME WITH C->NAME
   UNLOCK
   SKIP
ENDDO


DO CASE
CASE MSEL = 'N'
   
   SELECT A
   USE &MDBFLOC.CUSTCOMM EXCLUSIVE
   INDEX ON BBUYNAME TO &MDBFLOC.CUSTNAME
   UNLOCK
   
   DO FOX_USE WITH "&MDBFLOC.CUSTCOMM INDEX &MDBFLOC.CUSTNAME", .F.
   
   MLINE = 99
   MPAGE_NO = 0
   MFIRST_TM = .T.
   
   DO WHILE .NOT. EOF()
      MDOIT = .F.
      IF MCOM_CODE <> SPACE(2)
         IF MCOM_CODE = CUSTCOMM1 .OR. MCOM_CODE = CUSTCOMM2 .OR. MCOM_CODE = CUSTCOMM3
            MDOIT = .T.
         ENDIF
         IF MCOM_CODE = CUSTBILL1 .OR. MCOM_CODE = CUSTBILL2 .OR. MCOM_CODE = CUSTBILL3
            MDOIT = .T.
         ENDIF
      ELSE
         MDOIT = .T.
      ENDIF
      
      IF .NOT. MDOIT
         SKIP
         LOOP
      ENDIF
      
      IF MLINE > 56
         IF MFIRST_TM
            MFIRST_TM = .F.
         ELSE
            EJECT
         ENDIF
         MLINE = 2
         MPAGE_NO = MPAGE_NO + 1
         @ MLINE,1 SAY 'PAGE  ' + str(mpage_no,3)
         IF MBBS = 'N'
            @ MLINE,15 say 'AMERICHICKEN CUSTOMER BROKER COMMISSIONS'
         ELSE
            @ MLINE,15 say 'AMERICHICKEN CUSTOMER BROKER COMMISSION & BILLBACKS'
         ENDIF
         @ MLINE,80 SAY DTOC(DATE())
         MLINE = MLINE + 2
         IF MBBS = 'N'
            @ MLINE,1  SAY 'Customer                             Brokers'
         ELSE
            @ MLINE,1  SAY 'Customer                             Brokers/Billbacks'
         ENDIF
         MLINE = MLINE + 2
      ENDIF
      
      SELECT C
      SEEK A->BBUYCODE
      
      MLINE1 = C->NAME
      MLINE2 = C->STREET
      MLINE3 = TRIM(C->CITY) + ', ' + C->STATE + '  ' + C->ZIP
      MPRT_LN1 = .T.
      MPRT_LN2 = .T.
      MPRT_LN3 = .T.
      
      I = 1
      DO WHILE I<=3
         MI = STR(I,1)
         DO CASE
         CASE I = 1
            IF A->CUSTCOMM&MI <> SPACE(2)
               DO CASE
               CASE MPRT_LN1
                  @ MLINE,1 SAY MLINE1
                  MPRT_LN1 = .F.
               CASE MPRT_LN2
                  @ MLINE,1 SAY MLINE2
                  MPRT_LN2 = .F.
               CASE MPRT_LN3
                  @ MLINE,1 SAY MLINE3
                  MPRT_LN3 = .F.
               ENDCASE
               
               SELECT B
               SEEK A->CUSTCOMM&MI
               @ MLINE,38 SAY NAME
               @ MLINE,75 SAY 'BROKER'
               MLINE = MLINE + 1
            ENDIF
         CASE I = 2
            IF A->CUSTCOMM&MI <> SPACE(2)
               DO CASE
               CASE MPRT_LN1
                  @ MLINE,1 SAY MLINE1
                  MPRT_LN1 = .F.
               CASE MPRT_LN2
                  @ MLINE,1 SAY MLINE2
                  MPRT_LN2 = .F.
               CASE MPRT_LN3
                  @ MLINE,1 SAY MLINE3
                  MPRT_LN3 = .F.
               ENDCASE
               SELECT B
               SEEK A->CUSTCOMM&MI
               @ MLINE,38 SAY NAME
               @ MLINE,75 SAY 'BROKER'
               MLINE = MLINE + 1
            ENDIF
         CASE I = 3
            IF A->CUSTCOMM&MI <> SPACE(2)
               DO CASE
               CASE MPRT_LN1
                  @ MLINE,1 SAY MLINE1
                  MPRT_LN1 = .F.
               CASE MPRT_LN2
                  @ MLINE,1 SAY MLINE2
                  MPRT_LN2 = .F.
               CASE MPRT_LN3
                  @ MLINE,1 SAY MLINE3
                  MPRT_LN3 = .F.
               ENDCASE
               SELECT B
               SEEK A->CUSTCOMM&MI
               @ MLINE,38 SAY NAME
               @ MLINE,75 SAY 'BROKER'
               MLINE = MLINE + 1
            ENDIF
         ENDCASE
         
         I = I + 1
      ENDDO
      IF MBBS <> 'N'
         I = 1
         DO WHILE I<=3
            MI = STR(I,1)
            DO CASE
            CASE I = 1
               IF A->CUSTBILL&MI <> SPACE(2)
                  DO CASE
                  CASE MPRT_LN1
                     @ MLINE,1 SAY MLINE1
                     MPRT_LN1 = .F.
                  CASE MPRT_LN2
                     @ MLINE,1 SAY MLINE2
                     MPRT_LN2 = .F.
                  CASE MPRT_LN3
                     @ MLINE,1 SAY MLINE3
                     MPRT_LN3 = .F.
                  ENDCASE
                  
                  SELECT B
                  SEEK A->CUSTBILL&MI
                  @ MLINE,38 SAY NAME
                  @ MLINE,75 SAY 'BILLBACK'
                  MLINE = MLINE + 1
               ENDIF
            CASE I = 2
               IF A->CUSTBILL&MI <> SPACE(2)
                  DO CASE
                  CASE MPRT_LN1
                     @ MLINE,1 SAY MLINE1
                     MPRT_LN1 = .F.
                  CASE MPRT_LN2
                     @ MLINE,1 SAY MLINE2
                     MPRT_LN2 = .F.
                  CASE MPRT_LN3
                     @ MLINE,1 SAY MLINE3
                     MPRT_LN3 = .F.
                  ENDCASE
                  SELECT B
                  SEEK A->CUSTBILL&MI
                  @ MLINE,38 SAY NAME
                  @ MLINE,75 SAY 'BILLBACK'
                  MLINE = MLINE + 1
               ENDIF
            CASE I = 3
               IF A->CUSTBILL&MI <> SPACE(2)
                  DO CASE
                  CASE MPRT_LN1
                     @ MLINE,1 SAY MLINE1
                     MPRT_LN1 = .F.
                  CASE MPRT_LN2
                     @ MLINE,1 SAY MLINE2
                     MPRT_LN2 = .F.
                  CASE MPRT_LN3
                     @ MLINE,1 SAY MLINE3
                     MPRT_LN3 = .F.
                  ENDCASE
                  SELECT B
                  SEEK A->CUSTBILL&MI
                  @ MLINE,38 SAY NAME
                  @ MLINE,75 SAY 'BILLBACK'
                  MLINE = MLINE + 1
               ENDIF
            ENDCASE
            I = I + 1
         ENDDO
      ENDIF
      IF MPRT_LN1
         @ MLINE,1 SAY MLINE1
         MLINE = MLINE + 1
      ENDIF
      IF MPRT_LN2
         @ MLINE,1 SAY MLINE2
         MLINE = MLINE + 1
      ENDIF
      IF MPRT_LN3
         @ MLINE,1 SAY MLINE3
         MLINE = MLINE + 1
      ENDIF
      
      MLINE = MLINE + 1
      SELECT A
      SKIP
   ENDDO
OTHERWISE
   CLOSE DATA
   
   SELECT A
   DO FOX_USE WITH "TEMPFILE", .T.
   DELETE ALL
   PACK
   INDEX ON BBUYCODE + COM_CODE + PROD_CODE TO TEMPFILE
   DO FOX_USE WITH "TEMPFILE INDEX TEMPFILE", .T.
   
   SELECT D
   DO FOX_USE WITH "&MDBFLOC.COMPAYEE INDEX &MDBFLOC.COM_CODE", .F.
   
   SELECT C
   DO FOX_USE WITH "&MMASTDBF.BROK_FEE INDEX &MMASTDBF.BROK_FEE", .F.
   
   SELECT B
   DO FOX_USE WITH "&MDBFLOC.CUSTCOMM", .F.
   
   DO WHILE .NOT. EOF()
      
      MDOIT = .F.
      IF MCOM_CODE <> SPACE(2)
         IF MCOM_CODE = CUSTCOMM1 .OR. MCOM_CODE = CUSTCOMM2 .OR. MCOM_CODE = CUSTCOMM3
            MDOIT = .T.
         ENDIF
         IF MCOM_CODE = CUSTBILL1 .OR. MCOM_CODE = CUSTBILL2 .OR. MCOM_CODE = CUSTBILL3
            MDOIT = .T.
         ENDIF
      ELSE
         MDOIT = .T.
      ENDIF
      
      IF .NOT. MDOIT
         SKIP
         LOOP
      ENDIF
      
      IF B->CUSTCOMM1 <> SPACE(2)
         SELECT D
         SEEK B->CUSTCOMM1
         
         SELECT C
         SEEK B->CUSTCOMM1
         
         DO WHILE .NOT. EOF() .AND. COM_CODE = B->CUSTCOMM1
            SELECT A
            SEEK B->BBUYCODE + B->CUSTCOMM1 + C->PROD_CODE
            IF EOF()
               APPEND BLANK
               REPLACE BBUYCODE WITH B->BBUYCODE
               REPLACE BBUYNAME WITH B->BBUYNAME
               REPLACE COM_CODE WITH B->CUSTCOMM1
               REPLACE COM_NAME WITH D->NAME
               REPLACE PROD_CODE WITH C->PROD_CODE
               REPLACE BROK_FEE WITH C->BROK_FEE
            ENDIF
            SELECT C
            SKIP
         ENDDO
      ENDIF
      
      IF B->CUSTCOMM2 <> SPACE(2)
         SELECT D
         SEEK B->CUSTCOMM2
         SELECT C
         SEEK B->CUSTCOMM2
         
         DO WHILE .NOT. EOF() .AND. COM_CODE = B->CUSTCOMM2
            SELECT A
            SEEK B->BBUYCODE + B->CUSTCOMM2 + C->PROD_CODE
            IF EOF()
               APPEND BLANK
               REPLACE BBUYCODE WITH B->BBUYCODE
               REPLACE BBUYNAME WITH B->BBUYNAME
               REPLACE COM_CODE WITH B->CUSTCOMM2
               REPLACE COM_NAME WITH D->NAME
               REPLACE PROD_CODE WITH C->PROD_CODE
               REPLACE BROK_FEE WITH C->BROK_FEE
            ENDIF
            SELECT C
            SKIP
         ENDDO
      ENDIF
      
      IF B->CUSTCOMM3 <> SPACE(2)
         SELECT D
         SEEK B->CUSTCOMM3
         SELECT C
         SEEK B->CUSTCOMM3
         DO WHILE .NOT. EOF() .AND. COM_CODE = B->CUSTCOMM3
            SELECT A
            SEEK B->BBUYCODE + B->CUSTCOMM3 + C->PROD_CODE
            IF EOF()
               APPEND BLANK
               REPLACE BBUYCODE WITH B->BBUYCODE
               REPLACE BBUYNAME WITH B->BBUYNAME
               REPLACE COM_CODE WITH B->CUSTCOMM3
               REPLACE COM_NAME WITH D->NAME
               REPLACE PROD_CODE WITH C->PROD_CODE
               REPLACE BROK_FEE WITH C->BROK_FEE
            ENDIF
            SELECT C
            SKIP
         ENDDO
      ENDIF
      
      IF B->CUSTBILL1 <> SPACE(2)
         SELECT D
         SEEK B->CUSTBILL1
         SELECT C
         SEEK B->CUSTBILL1
         DO WHILE .NOT. EOF() .AND. COM_CODE = B->CUSTBILL1
            SELECT A
            SEEK B->BBUYCODE + B->CUSTBILL1 + C->PROD_CODE
            IF EOF()
               APPEND BLANK
               REPLACE BBUYCODE WITH B->BBUYCODE
               REPLACE BBUYNAME WITH B->BBUYNAME
               REPLACE COM_CODE WITH B->CUSTBILL1
               REPLACE COM_NAME WITH D->NAME
               REPLACE PROD_CODE WITH C->PROD_CODE
               REPLACE BROK_FEE WITH C->BROK_FEE
               REPLACE BILLBACK WITH 'Y'
            ENDIF
            SELECT C
            SKIP
         ENDDO
      ENDIF
      
      IF B->CUSTBILL2 <> SPACE(2)
         SELECT D
         SEEK B->CUSTBILL2
         SELECT C
         SEEK B->CUSTBILL2
         DO WHILE .NOT. EOF() .AND. COM_CODE = B->CUSTBILL2
            SELECT A
            SEEK B->BBUYCODE + B->CUSTBILL2 + C->PROD_CODE
            IF EOF()
               APPEND BLANK
               REPLACE BBUYCODE WITH B->BBUYCODE
               REPLACE BBUYNAME WITH B->BBUYNAME
               REPLACE COM_CODE WITH B->CUSTBILL2
               REPLACE COM_NAME WITH D->NAME
               REPLACE PROD_CODE WITH C->PROD_CODE
               REPLACE BROK_FEE WITH C->BROK_FEE
               REPLACE BILLBACK WITH 'Y'
            ENDIF
            SELECT C
            SKIP
         ENDDO
      ENDIF
      
      IF B->CUSTBILL3 <> SPACE(2)
         SELECT D
         SEEK B->CUSTBILL3
         SELECT C
         SEEK B->CUSTBILL3
         DO WHILE .NOT. EOF() .AND. COM_CODE = B->CUSTBILL3
            SELECT A
            SEEK B->BBUYCODE + B->CUSTBILL3 + C->PROD_CODE
            IF EOF()
               APPEND BLANK
               REPLACE BBUYCODE WITH B->BBUYCODE
               REPLACE BBUYNAME WITH B->BBUYNAME
               REPLACE COM_CODE WITH B->CUSTBILL3
               REPLACE COM_NAME WITH D->NAME
               REPLACE PROD_CODE WITH C->PROD_CODE
               REPLACE BROK_FEE WITH C->BROK_FEE
               REPLACE BILLBACK WITH 'Y'
            ENDIF
            SELECT C
            SKIP
         ENDDO
      ENDIF
      
      SELECT B
      SKIP
   ENDDO
   
   SELECT A
   **** START THE REPORT
   INDEX ON BBUYNAME + COM_NAME + PROD_CODE TO TEMPFILE
   DO FOX_USE WITH "TEMPFILE INDEX TEMPFILE", .T.
   
   MLINE = 99
   MPAGE_NO = 0
   MFIRST_TM = .T.
   STORE SPACE(32) TO MBBUYNAME, MCOM_NAME
   
   DO WHILE .NOT. EOF()
      IF MLINE > 59
         IF MFIRST_TM
            MFIRST_TM = .F.
         ELSE
            EJECT
         ENDIF
         MLINE = 2
         MPAGE_NO = MPAGE_NO + 1
         @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
         @ MLINE,28 say 'AMERICHICKEN CUSTOMER BROKERS/BILLBACKS'
         @ MLINE,80 SAY DTOC(DATE())
         MLINE = MLINE + 2
         @ MLINE,1  SAY 'Customer/Broker/Billback                   PRODUCT     COMM/FEE'
         MLINE = MLINE + 2
         @ MLINE,1 SAY BBUYNAME
         MBBUYNAME = BBUYNAME
         MLINE = MLINE + 1
         @ MLINE,5 SAY COM_NAME
         MCOM_NAME = COM_NAME
      ENDIF
      
      IF COM_NAME <> MCOM_NAME
         MLINE = MLINE + 1
         @ MLINE,1 SAY BBUYNAME
         MLINE = MLINE + 1
         @ MLINE,5 SAY COM_NAME
         MCOM_NAME = COM_NAME
      ENDIF
      
      @ MLINE,44 SAY PROD_CODE
      @ MLINE,57 SAY BROK_FEE PICTURE '99.9999'
      IF BILLBACK = 'Y'
         @ MLINE,68 SAY 'BILLBACK'
      ENDIF
      MLINE = MLINE + 1
      SKIP
   ENDDO
ENDCASE

@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
CLOSE DATA

RETURN




PROCEDURE NATLLIST
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     
MTITLE = ' - NATIONAL PRICING MASTER LISTING'
CLEAR
@ 01,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@  2,0 SAY MPROGRAM + MTITLE
@ 3,0 TO 22,79

STORE ' ' TO MPRT_ACT
DO PRT_SET
IF MPRT_ACT <> 'C'
   RETURN
ENDIF 
SET CONSOLE OFF
IF FILE("C:\COMPINFO\PRINTERS.DBF")
   SET PRINT TO C:\COMPINFO\PRT_FILE.TXT
ELSE
   SET PRINT TO LPT3
ENDIF
SET DEVICE TO PRINT
SET PRINT ON

*** PRINT IN 10 CPI
?? chr(27) + '&k0S'

*** LETTER GOTHIC AND BOLDED PRINT
?? chr(27) + '(s4102T' + chr(27) + '(s3B' + chr(27) + '(s3B'

*** LETTER SIZE PAPER
?? CHR(27) + '&l2A'

*** PORTRAIT MODE
?? CHR(27) + '&l0O'

SELECT B
DO FOX_USE WITH "&MDBFLOC.PRODUCTS INDEX &MDBFLOC.PRODUCTS", .F.

SELECT A
DO FOX_USE WITH "&MDBFLOC.NATLMAST INDEX &MDBFLOC.NATLMAST", .F.

MLINE = 99
MPAGE_NO = 0
MFIRST_TM = .T.

DO WHILE .NOT. EOF()
   IF MLINE > 59
      IF MFIRST_TM
         MFIRST_TM = .F.
      ELSE
         EJECT
      ENDIF
      MLINE = 2
      MPAGE_NO = MPAGE_NO + 1
      @ MLINE,5 SAY 'PAGE  ' + str(mpage_no,3)
      @ MLINE,28 say 'AMERICHICKEN NATIONAL PRICING MASTER'
      @ MLINE,80 SAY DTOC(DATE())
      MLINE = MLINE + 2
      @ MLINE,1  SAY '     Prod Code     Description                 Natl Price'
      MLINE = MLINE + 2
   ENDIF
   
   @ MLINE,6 SAY PROD_DESC             
   SELECT B
   SEEK 'R' + A->PROD_DESC
   IF .NOT. EOF()
      @ MLINE,20 SAY DESC
   ENDIF
   
   SELECT A
   @ MLINE,50 SAY PRICE PICTURE '99.9999'
   MLINE = MLINE + 1
   SKIP
ENDDO
@ MLINE,1 SAY ' '
EJECT

SET DEVICE TO SCREEN
SET PRINT OFF
SET PRINT TO
SET CONSOLE ON
IF MPRINTER3 <> 'DONOTPRINT'
   RUN &MPRINTIT3
ENDIF
CLOSE DATA
RETURN

*Formatted by: ToolBox Ver. 1.2  on 12/10/15 at 11:27 AM.
