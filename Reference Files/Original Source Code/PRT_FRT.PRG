************  
* Program.: PRT_FRT.PRG
* Author..: Grace Keller
* Date....: 01/21/97
* Notice..: Copyright 1987, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: PRINT FREIGHT COPY OF ORDER
*
* ---OPEN FILES
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     

SELECT A
USE
SELECT D
USE
SELECT E
USE
SELECT F
USE

STORE 'C' TO MPRT_ACT
DO PRT_12A
IF MPRT_ACT <> 'C'
   RETURN
ENDIF

**** DO ALL THE NAME/ADDRESS SEARCHING HERE
SELECT B
STORE SALESMAN TO MSALESMAN
STORE PO_NBR TO MPO_NBR
STORE PO_SUFFIX TO MPO_SUFFIX
STORE BUY_CODE TO MBUY_CODE
STORE SUP_CODE TO MSUP_CODE
STORE FRT_CODE1 TO MFRT_CODE1


***************************
** GET CUSTOMER INFORMATION
***************************
SELECT E
DO FOX_USE WITH "&MDBFLOC.BUYER INDEX &MDBFLOC.BUY_CODE", .F.
SEEK MBUY_CODE
IF .NOT. EOF()
   STORE NAME TO MCUS_NAME       
   STORE STREET TO MCUS_STRT  
   IF ZIP4 = SPACE(4)
      STORE ZIP + SPACE(5) TO MCUS_ZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MCUS_ZIP 
   ENDIF
   STORE TRIM(CITY) + ', ' + STATE  + '  ' + MCUS_ZIP TO MCUS_CITYST
ELSE
   IF MBUY_CODE = 'NONE'
      STORE 'NONE               '+ SPACE(13) TO MCUS_NAME
      STORE 'NONE' TO MCUS_CITYST
   ELSE
      STORE 'SHIP TO NOT ON FILE'+ SPACE(13) TO MCUS_NAME
      STORE SPACE(22) TO MCUS_CITYST
   ENDIF
   STORE SPACE(28) TO MCUS_STRT           
   STORE SPACE(11) TO MCUS_ZIP
ENDIF
MCUS_CITYST = TRIM(MCUS_CITYST)


***************************
** GET SUPPLIER INFORMATION
***************************
DO FOX_USE WITH "&MDBFLOC.SUPPLIER INDEX &MDBFLOC.SUP_CODE", .F.
SEEK MSUP_CODE
IF .NOT. EOF()
   STORE NAME TO MSUP_NAME       
   STORE STREET TO MSUP_STRT  
   IF ZIP4 = SPACE(4)
      STORE ZIP + SPACE(5) TO MSUP_ZIP
   ELSE
      STORE ZIP + '-' + ZIP4 TO MSUP_ZIP 
   ENDIF
   STORE TRIM(CITY) + ', ' + STATE  + '  ' + MSUP_ZIP TO MSUP_CITYST
ELSE
   IF MSUP_CODE = 'NONE'
      STORE 'NONE                    '+ SPACE(8) TO MSUP_NAME
      STORE 'NONE' TO MSUP_CITYST    
   ELSE
      STORE 'SHIPPED FROM NOT ON FILE'+ SPACE(8) TO MSUP_NAME
      STORE SPACE(22) TO MSUP_CITYST
   ENDIF
   STORE SPACE(28) TO MSUP_STRT           
   STORE SPACE(11) TO MSUP_ZIP
ENDIF
MSUP_CITYST = TRIM(MSUP_CITYST)


SELECT F
DO FOX_USE WITH "&MMASTDBF.SALESMAN INDEX &MMASTDBF.SAL_CODE", .F.
SEEK MSALESMAN
IF .NOT. EOF()
   MSAL_NAME = NAME
ELSE
   MSAL_NAME = 'SALESPERSON NAME NOT ON FILE' + SPACE(4)
ENDIF

DO FOX_USE WITH "&MDBFLOC.FREIGHT INDEX &MDBFLOC.FRT_CODE", .F.
IF MFRT_CODE1 = 'CUST'
   STORE 'CUSTOMER PICK UP' TO MFRT_NAME1
ELSE 
   IF MFRT_CODE1 = 'NONE'
      STORE 'DELIVERED' TO MFRT_NAME1
   ELSE
      SEEK MFRT_CODE1                
      IF .NOT. EOF()
         STORE NAME TO MFRT_NAME1
      ELSE
         STORE 'FREIGHT NOT ON FILE' TO MFRT_NAME1
      ENDIF
   ENDIF
ENDIF

DO PRT_1FRT

SELECT F
DO FOX_USE WITH "&MDBFLOC.FREIGHT INDEX &MDBFLOC.FRT_CODE", .F.
IF MFRT_CODE2 <> SPACE(4) .AND. MFRT_CODE2 <> 'NONE' .AND. MFRT_CODE2 <> 'CUST'
   SEEK MFRT_CODE2                
   IF .NOT. EOF()
      STORE NAME TO MFRT_NAME
   ELSE
      STORE 'FREIGHT NOT ON FILE' TO MFRT_NAME
   ENDIF
   MFRT_AMT = MFRT_AMT2
   DO PRT_2FRT
ENDIF

SELECT F
DO FOX_USE WITH "&MDBFLOC.FREIGHT INDEX &MDBFLOC.FRT_CODE", .F.
IF MFRT_CODE3 <> SPACE(4) .AND. MFRT_CODE3 <> 'NONE' .AND. MFRT_CODE3 <> 'CUST'
   SEEK MFRT_CODE3
   IF .NOT. EOF()
      STORE NAME TO MFRT_NAME
   ELSE
      STORE 'FREIGHT NOT ON FILE' TO MFRT_NAME
   ENDIF
   MFRT_AMT = MFRT_AMT3
   DO PRT_2FRT
ENDIF

RETURN

* EOF: PRT_FRT.PRG
*Formatted by: ToolBox Ver. 1.2  on 1/22/97 at 3:37 AM.
