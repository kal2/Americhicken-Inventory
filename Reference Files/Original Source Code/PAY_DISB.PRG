**********
* Program.: PAY_DISB.PRG
* Author..: GRACE KELLER
* Date....: 03/11/88
* Notice..: Copyright 1988, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: PAYROLL DISBURSEMENTS
*


* ---PROCESSING LOOP
CLEAR
@ 1,00 SAY MCOMPANY
@ 01,68 SAY DATE()
@ 02,00 SAY MPROGRAM + ' - PAYROLL DISBURSEMENT'
@ 03,00 TO 24,79 
STORE CTOD(' ') TO MCK_DATE
SELECT A
DO FOX_USE WITH "MAN_CK INDEX MAN_CK", .F.

@ 4,5 SAY ' PAYEE: ' 
@ 5,5 SAY 'STREET: '
@ 6,5 SAY '  CITY: ' 
@ 6,45 SAY 'STATE: ' 
@ 6,58 SAY 'ZIP: '

@ 8,1 SAY  '      CHECK DATE: '
@ 9,1 SAY  'SALESPERSON CODE: '
@ 11,1 SAY '   GROSS PAYROLL:'
@ 13,1 SAY '            FICA:'
@ 14,1 SAY '     FEDERAL TAX:'
@ 15,1 SAY '       STATE TAX:'
@ 15,34 SAY 'STATE ACCRUED ACCOUNT CODE:'
@ 16,1 SAY '       STATE TAX:'
@ 16,34 SAY 'STATE ACCRUED ACCOUNT CODE:'

@ 18,1 SAY 'PAYMNT/DEDUCT #1:'
@ 18,34 SAY 'PAYMNT/DEDUCT ACCT CODE #1:'
@ 19,1 SAY 'PAYMNT/DEDUCT #2:'
@ 19,34 SAY 'PAYMNT/DEDUCT ACCT CODE #2:'
@ 21,1 SAY '(NOTE: CAN ENTER ABOVE AMOUNTS AS POSITIVE OR NEGATIVE NUMBERS)'
MMORE = .T.
STORE SPACE(32) TO MNAME 
STORE SPACE(25) TO MSTREET 
STORE SPACE(20) TO MCITY
STORE SPACE(2) TO MSTATE
STORE SPACE(5) TO MZIP
MSALESMAN = '  '
STORE 0 TO MPAYROLL, MFICA, MFED, MMO_TAX, MSERV_CHG, MAMOUNT06, MAMOUNT07
MACCOUNT05 = SPACE(4)
MACCOUNT06 = SPACE(4)
MACCOUNT07 = SPACE(4)
MST_ACCT = SPACE(4)

STORE 2 TO MACTION
DO WHILE MACTION = 2
   @ 4,13 GET MNAME PICTURE '@!'
   @ 5,13 GET MSTREET PICTURE '@!'
   @ 6,13 GET MCITY PICTURE '@!'
   @ 6,52 GET MSTATE PICTURE '@!'
   @ 6,63 GET MZIP PICTURE '#####'
   @ 8,19 GET MCK_DATE
   @ 9,19 GET MSALESMAN PICTURE '@!'
   @ 11,19 GET MPAYROLL PICTURE '###,###.##'
   @ 13,19 GET MFICA PICTURE '###,###.##'
   @ 14,19 GET MFED PICTURE '###,###.##'
   @ 15,19 GET MMO_TAX PICTURE '###,###.##'
   @ 15,63 GET MST_ACCT PICTURE '@!'
   @ 16,19 GET MAMOUNT07 PICTURE '###,###.##'
   @ 16,63 GET MACCOUNT07 PICTURE '@!'
   @ 18,19 GET MSERV_CHG PICTURE '###,###.##'
   @ 18,63 GET MACCOUNT05 PICTURE '####'
   @ 19,19 GET MAMOUNT06 PICTURE '###,###.##'
   @ 19,63 GET MACCOUNT06 PICTURE '####'
   CLEAR GETS
   @ 4,13 GET MNAME PICTURE '@!'
   READ
   IF MNAME = SPACE(32)
      MACTION = 4
      LOOP
   ENDIF
   SEEK TRIM(MNAME)
   IF .NOT. EOF()
      STORE NAME TO MNAME
      STORE STREET TO MSTREET
      STORE CITY TO MCITY
      STORE STATE TO MSTATE
      STORE ZIP TO MZIP
      STORE CK_DATE TO MCK_DATE
      MSALESMAN = SALESMAN
      STORE AMOUNT01 TO MPAYROLL
      STORE AMOUNT02 * -1 TO MFICA   
      STORE AMOUNT03 * -1 TO MFED
      STORE AMOUNT04 * -1 TO MMO_TAX  
      STORE AMOUNT07 * -1 TO MAMOUNT07
      
      STORE AMOUNT05 TO MSERV_CHG
      STORE AMOUNT06  TO MAMOUNT06
      STORE ACCOUNT01 TO MACCOUNT01
      STORE ACCOUNT02 TO MACCOUNT02
      STORE ACCOUNT03 TO MACCOUNT03
      STORE ACCOUNT04 TO MST_ACCT 
      STORE ACCOUNT05 TO MACCOUNT05
      STORE ACCOUNT06 TO MACCOUNT06
      STORE ACCOUNT07 TO MACCOUNT07
      MNEW_RCD = .F.
   ELSE
      MNEW_RCD = .T.
   ENDIF
   
   @ 5,13 GET MSTREET PICTURE '@!'
   @ 6,13 GET MCITY PICTURE '@!'
   @ 6,52 GET MSTATE PICTURE '@!'
   @ 6,63 GET MZIP PICTURE '#####'
   @ 8,19 GET MCK_DATE
   @ 9,19 GET MSALESMAN PICTURE '@!'
   @ 11,19 GET MPAYROLL PICTURE '###,###.##'
   @ 13,19 GET MFICA PICTURE '###,###.##'
   @ 14,19 GET MFED PICTURE '###,###.##'
   @ 15,19 GET MMO_TAX PICTURE '###,###.##'
   @ 15,63 GET MST_ACCT PICTURE '@!'
   @ 16,19 GET MAMOUNT07 PICTURE '###,###.##'
   @ 16,63 GET MACCOUNT07 PICTURE '@!'
   
   @ 18,19 GET MSERV_CHG PICTURE '###,###.##'
   @ 18,63 GET MACCOUNT05 PICTURE '####'
   @ 19,19 GET MAMOUNT06 PICTURE '###,###.##'
   @ 19,63 GET MACCOUNT06 PICTURE '####'
   
   STORE 1 TO MACTION
   @ 24,01 SAY 'Action: ' + STR(MACTION,1)
   @ 24,13 SAY '1. Save     2. Edit     3. Cancel'
   READ
   MTOT = MPAYROLL - MFICA - MFED - MMO_TAX + MSERV_CHG + MAMOUNT06 - MAMOUNT07
   @ 22,1 SAY '     CHECK TOTAL:'
   @ 22,19 SAY MTOT PICTURE '###,###.##'
   
   @ 24,9 GET MACTION PICTURE '#' RANGE 1,3
   READ
   IF MACTION = 1
      IF MST_ACCT = SPACE(4)
         @ 24,0 CLEAR
         MWAIT = ' '
         @ 24,1 SAY 'STATE ACCRUED ACCOUNT CODE NOT ENTERED - PRESS RETURN TO REENTER ' GET MWAIT
         READ
         @ 24,0 CLEAR
         MACTION = 2
      ENDIF
      IF MSALESMAN = SPACE(2)
         @ 24,0 CLEAR
         STORE '  ' TO MOK
         @ 24,0 SAY 'WARNING !!!  NO SALESPERSON CODE ENTERED - ENTER "OK" IF THAT IS CORRECT ' GET MOK PICTURE '@!'
         READ
         @ 24,0 CLEAR
         IF MOK <> 'OK'
            MACTION = 2
            LOOP
         ENDIF
      ENDIF
   ENDIF
ENDDO
IF MACTION = 3
   RETURN
ENDIF
IF MNAME = SPACE(32)
   RETURN
ENDIF

IF MNEW_RCD       
   IF MTOT = 0
      RETURN
   ENDIF
   DO FILELOCK
   APPEND BLANK
   REPLACE NAME WITH MNAME
   UNLOCK
ELSE
   IF MTOT = 0
      DELETE
      RETURN
   ENDIF
ENDIF
DO RECLOCK
REPLACE STREET WITH MSTREET
REPLACE CITY WITH MCITY
REPLACE STATE WITH MSTATE
REPLACE ZIP WITH MZIP
REPLACE SALESMAN WITH MSALESMAN
REPLACE AMOUNT01 WITH MPAYROLL
IF MFICA > 0
   REPLACE AMOUNT02 WITH -1 * MFICA   
ELSE
   REPLACE AMOUNT02 WITH MFICA   
ENDIF
IF MFED > 0
   REPLACE AMOUNT03 WITH -1 * MFED    
ELSE
   REPLACE AMOUNT03 WITH MFED
ENDIF
IF MMO_TAX > 0
   REPLACE AMOUNT04 WITH -1 * MMO_TAX 
ELSE
   REPLACE AMOUNT04 WITH MMO_TAX
ENDIF
IF MAMOUNT07 > 0
   REPLACE AMOUNT07 WITH -1 * MAMOUNT07 
ELSE
   REPLACE AMOUNT07 WITH MAMOUNT07
ENDIF
REPLACE AMOUNT05 WITH MSERV_CHG
REPLACE AMOUNT06 WITH MAMOUNT06
REPLACE ACCOUNT01 WITH '8020'
REPLACE ACCOUNT02 WITH '3301'
REPLACE ACCOUNT03 WITH '3302'
**REPLACE ACCOUNT04 WITH '3310'
REPLACE ACCOUNT04 WITH MST_ACCT
IF AMOUNT05 <> 0
   REPLACE ACCOUNT05 WITH MACCOUNT05
ENDIF
IF AMOUNT06 <> 0
   REPLACE ACCOUNT06 WITH MACCOUNT06
ENDIF
IF AMOUNT07 <> 0
   REPLACE ACCOUNT07 WITH MACCOUNT07
ENDIF
REPLACE CK_DATE WITH MCK_DATE
UNLOCK

CLOSE DATA
RETURN

* EOF: PAY_DISB.PRG

*Formatted by: ToolBox Ver. 1.2  on 8/25/14 at 9:22 AM.
