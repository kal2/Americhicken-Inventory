**********
* Program.: MISC_PAY.PRG
* Author..: Grace Keller
* Date....: 03/01/88
* Notice..: Copyright 1986, Solid Software, Inc., All Rights Reserved
* Version.: FOXPRO
* Notes...: MANUALLY UPDATE MISC PAYMENTS
*
STORE DATE() TO MDATE     
SELECT B
DO FOX_USE WITH "&MMASTDBF.ACCOUNTS INDEX &MMASTDBF.ACCOUNTS", .F.
SELECT A
DO FOX_USE WITH "PAYMENTS INDEX PAY_DATE, PAY_CUST, PAY_PO", .F.
MTITLE = ' - ENTER MISCELLANEOUS PAYMENTS'
CLEAR
@  1, 0 SAY MCOMPANY
@  1,68 SAY DATE()
@  2, 0 SAY MPROGRAM + MTITLE
@ 3,0 to 24,79
MMORE = .T.
DO WHILE  MMORE
   STORE 2 TO MACTION
   STORE SPACE(4) TO MACCOUNT 
   DO WHILE MACTION = 2
      
      @ 8,5  SAY 'PAYMENT DATE: '
      @ 10,5 SAY '      AMOUNT: '
      @ 12,5 SAY ' ACCOUNT NBR: '
      @ 8,19 GET MDATE
      @ 10,19 GET MAMOUNT PICTURE '99999.99'
      @ 12,19 get MACCOUNT PICTURE '####'
      
      STORE 1 TO MACTION
      @ 24,0 CLEAR
      @ 24,01 SAY 'Action: ' + STR(MACTION,1)
      @ 24,12 SAY '1.Save/Return    2. Edit   3. Save/Add Another    4. Cancel'
      READ
      @24,09 GET MACTION PICTURE '9' RANGE 1,4
      READ
   ENDDO
   
   IF MACTION = 4
      MMORE = .F.
      LOOP
   ENDIF
     
   IF MAMOUNT <> 0
    SELECT B
    SEEK MACCOUNT
    IF EOF()
      @ 24,0 CLEAR
      STORE ' ' TO MWAIT
      @ 24,1 SAY 'ACCOUNT NUMBER NOT ON FILE - PLEASE CHECK AND REENTER ' GET MWAIT
      READ
      LOOP
    ENDIF
   SELECT A
   DO FILELOCK
   APPEND BLANK
   REPLACE PAID_DATE WITH MDATE
   REPLACE AMT_OVER WITH MAMOUNT
   REPLACE ACCOUNT WITH ACCOUNT
   UNLOCK
   ELSE
     MMORE = .F.
   ENDIF
   IF MACTION = 1
      MMORE = .F.
   ENDIF
   
ENDDO
CLOSE DATA

RETURN
* EOF: MISC_PAY.PRG
*Formatted by: dANALYST Ver. 7.3a on March 1, 1988 at 3:12 PM.
