*  FILE NAME: DISBPROC.PRG
*  BY: 
*  DATE: October 12, 1987
*  DESC:
*  CALLED BY:
*  DATA FILES:
*  MULTI-USER RECORD/FILE LOCKING  +(M1)  FoxPro   Multi-User Code Insertion     

PROCEDURE DSUP_SF 
CLEAR 
@  1, 0 SAY MCOMPANY
@  1,68 SAY DATE()
@  2, 0 SAY MPROGRAM + MTITLE
@ 3,0 to 24,79
@ 4,1 SAY 'SUPPLIER NAME:'
@ 5,1 SAY '      ADDRESS:'
@ 7,1 SAY 'CHECK DATE:               CHECK NBR:             CHECK AMOUNT:           '
@ 8,1 TO 8,78
@ 09,1 SAY 'INVOICE NBR           PURCHASE             FREIGHT'
RETURN 


PROCEDURE CK_GET  
@ 7,13 GET MCK_DATE
@ 7,39 GET MCK_NBR PICTURE '@!'
@ 7,65 GET MCK_AMT PICTURE '999999.99'
RETURN


PROCEDURE SDIS_GET
@ MLINE,2 GET MSALEPERS(I)
@ MLINE,5 GET MNBR(I) PICTURE '####'
@ MLINE,21 GET MPURCH_PD PICTURE '######.##'



RETURN

PROCEDURE DSUP_REP
RETURN

PROCEDURE REPLSUPP
IF NAME <> MNAME .OR. SUP_CODE <> MSUP_CODE
   DO FILELOCK
   REPLACE name       WITH mname      
   REPLACE sup_CODE   WITH Msup_CODE
ELSE
   DO RECLOCK
ENDIF
REPLACE street     WITH mstreet    
REPLACE city       WITH mcity      
REPLACE state      WITH mstate     
REPLACE zip        WITH mzip       
REPLACE zip4       WITH mzip4      
REPLACE note       WITH mnote      
REPLACE AREA_CODE  WITH MAREA_CODE
REPLACE PHONE      WITH MPHONE
REPLACE RSUPCODE   WITH MRSUPCODE
UNLOCK
RETURN

PROCEDURE PUBLSUPP
PUBLIC mname, mstreet, mcity, mstate, mzip
PUBLIC mzip4
PUBLIC MZIP4, MNOTE, MSUP_CODE, MREM_NAME
PUBLIC MPHONE, MAREA_CODE, MRSUPCODE
RETURN


***** REMIT TO SUPPLIER INFO

PROCEDURE TEXTRSUP
CLEAR 
@  1, 0 SAY MCOMPANY
@  1,68 SAY DATE()
@  2, 0 SAY MPROGRAM + MTITLE
@ 3,0 to 24,79
@ 5,07  SAY 'SUPPLIER REMIT TO:'
@ 7,12 SAY 'PHONE NUMBER:'
@ 9,26  SAY 'REMIT TO ADDRESS'
@ 10,26  SAY '----------------'
@ 11,18 SAY 'STREET:'
@ 12,20 SAY 'CITY:'
@ 12,50 SAY 'STATE:'
@ 12,62 SAY 'ZIP:'
@ 12,72 SAY '-'
@ 14,2 SAY '      PAYMENT NET DAYS:'

@ 17,2 SAY "MIDWEST'S CREDIT LIMIT:"
@ 18,2 SAY '  LETTER OF CREDIT AMT:'
@ 19,02 SAY '            BEGIN DATE:'
@ 19,40 SAY 'EXPIRE DATE:'
@ 20,02 SAY '             GUARANTOR:'
@ 22,3 SAY '   NOTE:'
RETURN


PROCEDURE INITRSUP
IF MINIT_NM
   mname       = SPACE(32)
ENDIF
mstreet     = SPACE(28)
mcity       = SPACE(20)
mstate      = SPACE(2)
mzip        = SPACE(5)
mzip4       = SPACE(4)
mcred_lim   = 0
mnote       = SPACE(60)
MRSUPCODE   = SPACE(4)
MAREA_CODE   = SPACE(3)
MPHONE       = SPACE(7)
MNET_DAYS    = 0
MBEG_DATE    = CTOD(' ')
MEND_DATE    = CTOD(' ')
MLET_CRD     = 0
MGUARAN      = SPACE(20)
RETURN


PROCEDURE GETRSUP
@ 05,26 GET mname PICTURE '@!'
@ 07,26 GET MAREA_CODE PICTURE '@R (###'
@ 07,30 GET MPHONE PICTURE '@R )###-####'
@ 11,26 GET mstreet PICTURE '@!'
@ 12,26 GET mcity PICTURE '@!'
@ 12,57 GET mstate PICTURE '@!'
@ 12,67 GET mzip PICTURE '#####'
@ 12,73 GET mzip4 PICTURE '####'
@ 14,26 GET MNET_DAYS  PICTURE '###'

@ 17,26 GET mcred_lim   PICTURE '#######'
@ 18,26 GET MLET_CRD PICTURE '#######'
@ 19,26 GET MBEG_DATE
@ 19,52 GET MEND_DATE
@ 20,26 GET MGUARAN PICTURE '@!'
@ 22,12 GET mnote PICTURE '@!'
RETURN


PROCEDURE STORRSUP 
STORE name       TO mname      
STORE street     TO mstreet    
STORE city       TO mcity      
STORE state      TO mstate     
STORE zip        TO mzip       
STORE zip4       TO mzip4      
STORE cred_lim   TO mcred_lim  
STORE note       TO mnote      
STORE RSUPCODE   TO MRSUPCODE
STORE AREA_CODE  TO MAREA_CODE
STORE PHONE      TO MPHONE
STORE NET_DAYS   TO MNET_DAYS
STORE BEG_DATE   TO MBEG_DATE
STORE END_DATE   TO MEND_DATE
STORE LET_CRD    TO MLET_CRD
STORE GUARAN     TO MGUARAN
RETURN

PROCEDURE REPLRSUP
IF NAME <> MNAME .OR. RSUPCODE <> MRSUPCODE
   DO FILELOCK
   REPLACE name       WITH mname      
   REPLACE RSUPCODE   WITH MRSUPCODE
ELSE
   DO RECLOCK
ENDIF
REPLACE street     WITH mstreet    
REPLACE city       WITH mcity      
REPLACE state      WITH mstate     
REPLACE zip        WITH mzip       
REPLACE zip4       WITH mzip4      
REPLACE cred_lim   WITH mcred_lim  
REPLACE note       WITH mnote      
REPLACE AREA_CODE  WITH MAREA_CODE
REPLACE PHONE      WITH MPHONE
REPLACE NET_DAYS   WITH MNET_DAYS
REPLACE BEG_DATE   WITH MBEG_DATE
REPLACE END_DATE   WITH MEND_DATE
REPLACE LET_CRD    WITH MLET_CRD
REPLACE GUARAN     WITH MGUARAN
UNLOCK
RETURN

PROCEDURE PUBLRSUP
PUBLIC mname, mstreet, mcity, mstate, mzip
PUBLIC mzip4
PUBLIC MZIP4, mcred_lim, mnote, MRSUPCODE
PUBLIC MAREA_CODE, MPHONE, MNET_DAYS, MBEG_DATE, MEND_DATE
PUBLIC MLET_CRD, MGUARAN
RETURN


*Formatted by: FoxToolBox Ver. 0.8c on October 28, 1987 at 1:59 PM.
